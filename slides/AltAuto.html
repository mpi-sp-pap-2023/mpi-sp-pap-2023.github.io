<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="common/css/sf.css" rel="stylesheet" type="text/css" />
<title>AltAuto: A Streamlined Treatment of Automation</title>
<link href="common/jquery-ui/jquery-ui.css" rel="stylesheet">
<script src="common/jquery-ui/external/jquery/jquery.js"></script>
<script src="common/jquery-ui/jquery-ui.js"></script>
<script src="common/toggleproofs.js"></script>
<link href="common/css/lf.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="common/slides.js"></script>
<link href="common/css/slides.css" rel="stylesheet" type="text/css"/>
</head>

<body>

<div id="page">

<div id="header">
<div id='logoinheader'><a href='https://softwarefoundations.cis.upenn.edu'>
<img src='common/media/image/sf_logo_sm.png' alt='Software Foundations Logo'></a></div>
<div class='booktitleinheader'><a href='index.html'>Volume 1: Logical Foundations</a></div>
<ul id='menu'>
   <li class='section_name'><a href='toc.html'>Table of Contents</a></li>
   <li class='section_name'><a href='coqindex.html'>Index</a></li>
   <li class='section_name'><a href='deps.html'>Roadmap</a></li>
</ul>
</div>

<div id="main">

<h1 class="libtitle">AltAuto<span class="subtitle">A Streamlined Treatment of Automation</span></h1>


<div class="doc">

<div class="paragraph"> </div>

 It's time to shorten our proofs through automation
    features:

<div class="paragraph"> </div>

<ul class="doclist">
<li> Tacticals

<div class="paragraph"> </div>


</li>
<li> Tactics that obviate hardcoded names

<div class="paragraph"> </div>


</li>
<li> Automatic solvers

<div class="paragraph"> </div>


</li>
<li> Proof search with <span class="inlinecode"><span class="id" title="tactic">auto</span></span>

<div class="paragraph"> </div>


</li>
<li> Ltac 

</li>
</ul>
</div>

<div class="doc">
<a id="lab490"></a><h3 class="section"> </h3>

<div class="paragraph"> </div>

 Here's a function that rewrites regular expressions into
    potentially simpler forms without changing their matching
    behavior. 
</div>
<div class="code">

<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">re_opt_e</span> {<span class="id" title="var">T</span>:<span class="id" title="keyword">Type</span>} (<span class="id" title="var">re</span>: <span class="id" title="var">reg_exp</span> <span class="id" title="var">T</span>) : <span class="id" title="var">reg_exp</span> <span class="id" title="var">T</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">re</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">App</span> <span class="id" title="var">EmptyStr</span> <span class="id" title="var">re<sub>2</sub></span> ⇒ <span class="id" title="var">re_opt_e</span> <span class="id" title="var">re<sub>2</sub></span><br/>
&nbsp;&nbsp;| <span class="id" title="var">App</span> <span class="id" title="var">re<sub>1</sub></span> <span class="id" title="var">re<sub>2</sub></span> ⇒ <span class="id" title="var">App</span> (<span class="id" title="var">re_opt_e</span> <span class="id" title="var">re<sub>1</sub></span>) (<span class="id" title="var">re_opt_e</span> <span class="id" title="var">re<sub>2</sub></span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">Union</span> <span class="id" title="var">re<sub>1</sub></span> <span class="id" title="var">re<sub>2</sub></span> ⇒ <span class="id" title="var">Union</span> (<span class="id" title="var">re_opt_e</span> <span class="id" title="var">re<sub>1</sub></span>) (<span class="id" title="var">re_opt_e</span> <span class="id" title="var">re<sub>2</sub></span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">Star</span> <span class="id" title="var">re</span> ⇒ <span class="id" title="var">Star</span> (<span class="id" title="var">re_opt_e</span> <span class="id" title="var">re</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <span class="id" title="var">re</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
</div>

<div class="doc">
We would like to show the equivalence of re's with their
    "optimized" form.  One direction of this equivalence looks like
    this (the other is similar).  
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <span class="id" title="var">re_opt_e_match</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">T</span> (<span class="id" title="var">re</span>: <span class="id" title="var">reg_exp</span> <span class="id" title="var">T</span>) <span class="id" title="var">s</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">s</span> =~ <span class="id" title="var">re</span> → <span class="id" title="var">s</span> =~ <span class="id" title="var">re_opt_e</span> <span class="id" title="var">re</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">T</span> <span class="id" title="var">re</span> <span class="id" title="var">s</span> <span class="id" title="var">M</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">M</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> [| <span class="id" title="var">x'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">re<sub>1</sub></span> <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">re<sub>2</sub></span> <span class="id" title="var">Hmatch1</span> <span class="id" title="var">IH<sub>1</sub></span> <span class="id" title="var">Hmatch2</span> <span class="id" title="var">IH<sub>2</sub></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">re<sub>1</sub></span> <span class="id" title="var">re<sub>2</sub></span> <span class="id" title="var">Hmatch</span> <span class="id" title="var">IH</span> | <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">re<sub>1</sub></span> <span class="id" title="var">re<sub>2</sub></span> <span class="id" title="var">Hmatch</span> <span class="id" title="var">IH</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">re</span> | <span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">re</span> <span class="id" title="var">Hmatch1</span> <span class="id" title="var">IH<sub>1</sub></span> <span class="id" title="var">Hmatch2</span> <span class="id" title="var">IH<sub>2</sub></span>].<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MEmpty&nbsp;*)</span> <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">MEmpty</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MChar&nbsp;*)</span> <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">MChar</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MApp&nbsp;*)</span> <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">re<sub>1</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">MApp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">apply</span> <span class="id" title="var">IH<sub>1</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">apply</span> <span class="id" title="var">IH<sub>2</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hmatch1</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IH<sub>2</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">MApp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">apply</span> <span class="id" title="var">IH<sub>1</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">apply</span> <span class="id" title="var">IH<sub>2</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">MApp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">apply</span> <span class="id" title="var">IH<sub>1</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">apply</span> <span class="id" title="var">IH<sub>2</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">MApp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">apply</span> <span class="id" title="var">IH<sub>1</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">apply</span> <span class="id" title="var">IH<sub>2</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">MApp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">apply</span> <span class="id" title="var">IH<sub>1</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">apply</span> <span class="id" title="var">IH<sub>2</sub></span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MUnionL&nbsp;*)</span> <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">MUnionL</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MUnionR&nbsp;*)</span> <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">MUnionR</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MStar0&nbsp;*)</span> <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">MStar0</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MStarApp&nbsp;*)</span> <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">MStarApp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">apply</span> <span class="id" title="var">IH<sub>1</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">apply</span> <span class="id" title="var">IH<sub>2</sub></span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
That last proof was getting a little repetitive.  Time to
    learn a few more Coq tricks... 
</div>

<div class="doc">
<a id="lab491"></a><h1 class="section">Tacticals</h1>

<div class="paragraph"> </div>

 <i>Tacticals</i> are tactics that take other tactics as arguments --
    "higher-order tactics," if you will.  
</div>

<div class="doc">
<a id="lab492"></a><h2 class="section">The <span class="inlinecode"><span class="id" title="tactic">try</span></span> Tactical</h2>

<div class="paragraph"> </div>

 If <span class="inlinecode"><span class="id" title="var">T</span></span> is a tactic, then <span class="inlinecode"><span class="id" title="tactic">try</span></span> <span class="inlinecode"><span class="id" title="var">T</span></span> is a tactic that is just like <span class="inlinecode"><span class="id" title="var">T</span></span>
    except that, if <span class="inlinecode"><span class="id" title="var">T</span></span> fails, <span class="inlinecode"><span class="id" title="tactic">try</span></span> <span class="inlinecode"><span class="id" title="var">T</span></span> <i>successfully</i> does nothing at
    all instead of failing. 
</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <span class="id" title="var">silly1</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">n</span>, 1 + <span class="id" title="var">n</span> = <span class="id" title="var">S</span> <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>. <span class="comment">(*&nbsp;this&nbsp;just&nbsp;does&nbsp;<span class="inlinecode"><span class="id" title="tactic">reflexivity</span></span>&nbsp;*)</span> <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">silly2</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">P</span> : <span class="id" title="keyword">Prop</span>), <span class="id" title="var">P</span> → <span class="id" title="var">P</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">HP</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Fail</span> <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>. <span class="comment">(*&nbsp;proof&nbsp;state&nbsp;is&nbsp;unchanged&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">HP</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab493"></a><h2 class="section">The Sequence Tactical <span class="inlinecode">;</span> (Simple Form)</h2>

<div class="paragraph"> </div>

 In its most common form, the sequence tactical, written with
    semicolon <span class="inlinecode">;</span>, takes two tactics as arguments.  The compound
    tactic <span class="inlinecode"><span class="id" title="var">T</span>;</span> <span class="inlinecode"><span class="id" title="var">T'</span></span> first performs <span class="inlinecode"><span class="id" title="var">T</span></span> and then performs <span class="inlinecode"><span class="id" title="var">T'</span></span> on <i>each
    subgoal</i> generated by <span class="inlinecode"><span class="id" title="var">T</span></span>. 
<div class="paragraph"> </div>

 For example: 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <span class="id" title="var">simple_semi</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">n</span>, (<span class="id" title="var">n</span> + 1 =? 0) = <span class="id" title="var">false</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Leaves&nbsp;two&nbsp;subgoals,&nbsp;which&nbsp;are&nbsp;discharged&nbsp;identically...&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;n=0&nbsp;*)</span> <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;n=Sn'&nbsp;*)</span> <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab494"></a><h3 class="section"> </h3>
 We can simplify this proof using the <span class="inlinecode">;</span> tactical: 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <span class="id" title="var">simple_semi'</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">n</span>, (<span class="id" title="var">n</span> + 1 =? 0) = <span class="id" title="var">false</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;<span class="inlinecode"><span class="id" title="tactic">destruct</span></span>&nbsp;the&nbsp;current&nbsp;goal&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>;<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;then&nbsp;<span class="inlinecode"><span class="id" title="tactic">simpl</span></span>&nbsp;each&nbsp;resulting&nbsp;subgoal&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>;<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;and&nbsp;do&nbsp;<span class="inlinecode"><span class="id" title="tactic">reflexivity</span></span>&nbsp;on&nbsp;each&nbsp;resulting&nbsp;subgoal&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab495"></a><h3 class="section"> </h3>
 Or even more tersely, <span class="inlinecode"><span class="id" title="tactic">destruct</span></span> can do the <span class="inlinecode"><span class="id" title="tactic">intro</span></span>, and <span class="inlinecode"><span class="id" title="tactic">simpl</span></span>
    can be omitted: 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <span class="id" title="var">simple_semi''</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">n</span>, (<span class="id" title="var">n</span> + 1 =? 0) = <span class="id" title="var">false</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab496"></a><h3 class="section"> </h3>
 Using <span class="inlinecode"><span class="id" title="tactic">try</span></span> and <span class="inlinecode">;</span> together, we can improve the proof about
    regular expression optimization. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <span class="id" title="var">re_opt_e_match'</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">T</span> (<span class="id" title="var">re</span>: <span class="id" title="var">reg_exp</span> <span class="id" title="var">T</span>) <span class="id" title="var">s</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">s</span> =~ <span class="id" title="var">re</span> → <span class="id" title="var">s</span> =~ <span class="id" title="var">re_opt_e</span> <span class="id" title="var">re</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">T</span> <span class="id" title="var">re</span> <span class="id" title="var">s</span> <span class="id" title="var">M</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">M</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> [| <span class="id" title="var">x'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">re<sub>1</sub></span> <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">re<sub>2</sub></span> <span class="id" title="var">Hmatch1</span> <span class="id" title="var">IH<sub>1</sub></span> <span class="id" title="var">Hmatch2</span> <span class="id" title="var">IH<sub>2</sub></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">re<sub>1</sub></span> <span class="id" title="var">re<sub>2</sub></span> <span class="id" title="var">Hmatch</span> <span class="id" title="var">IH</span> | <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">re<sub>1</sub></span> <span class="id" title="var">re<sub>2</sub></span> <span class="id" title="var">Hmatch</span> <span class="id" title="var">IH</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">re</span> | <span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">re</span> <span class="id" title="var">Hmatch1</span> <span class="id" title="var">IH<sub>1</sub></span> <span class="id" title="var">Hmatch2</span> <span class="id" title="var">IH<sub>2</sub></span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Do&nbsp;the&nbsp;<span class="inlinecode"><span class="id" title="tactic">simpl</span></span>&nbsp;for&nbsp;every&nbsp;case&nbsp;here:&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MEmpty&nbsp;*)</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">MEmpty</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MChar&nbsp;*)</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">MChar</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MApp&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">re<sub>1</sub></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Most&nbsp;cases&nbsp;follow&nbsp;by&nbsp;the&nbsp;same&nbsp;formula.&nbsp;&nbsp;Notice&nbsp;that&nbsp;<span class="inlinecode"><span class="id" title="tactic">apply</span></span>
       <span class="inlinecode"><span class="id" title="var">MApp</span></span>&nbsp;gives&nbsp;two&nbsp;subgoals:&nbsp;<span class="inlinecode"><span class="id" title="tactic">try</span></span> <span class="inlinecode"><span class="id" title="tactic">apply</span></span> <span class="inlinecode"><span class="id" title="var">IH<sub>1</sub></span></span>&nbsp;is&nbsp;run&nbsp;on&nbsp;_both_&nbsp;of<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;them&nbsp;and&nbsp;succeeds&nbsp;on&nbsp;the&nbsp;first&nbsp;but&nbsp;not&nbsp;the&nbsp;second;&nbsp;<span class="inlinecode"><span class="id" title="tactic">apply</span></span> <span class="inlinecode"><span class="id" title="var">IH<sub>2</sub></span></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;then&nbsp;run&nbsp;on&nbsp;this&nbsp;remaining&nbsp;goal.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">apply</span> <span class="id" title="var">MApp</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IH<sub>1</sub></span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">IH<sub>2</sub></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;The&nbsp;interesting&nbsp;case,&nbsp;on&nbsp;which&nbsp;<span class="inlinecode"><span class="id" title="tactic">try</span>...</span>&nbsp;does&nbsp;nothing,&nbsp;is&nbsp;when<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="inlinecode"><span class="id" title="var">re<sub>1</sub></span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">EmptyStr</span></span>.&nbsp;In&nbsp;this&nbsp;case,&nbsp;we&nbsp;have&nbsp;to&nbsp;appeal&nbsp;to&nbsp;the&nbsp;fact<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;<span class="inlinecode"><span class="id" title="var">re<sub>1</sub></span></span>&nbsp;matches&nbsp;only&nbsp;the&nbsp;empty&nbsp;string:&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hmatch1</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IH<sub>2</sub></span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MUnionL&nbsp;*)</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">MUnionL</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MUnionR&nbsp;*)</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">MUnionR</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MStar0&nbsp;*)</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">MStar0</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MStarApp&nbsp;*)</span>  <span class="id" title="tactic">apply</span> <span class="id" title="var">MStarApp</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IH<sub>1</sub></span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IH<sub>2</sub></span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab497"></a><h2 class="section">The <span class="inlinecode"><span class="id" title="tactic">repeat</span></span> Tactical</h2>

<div class="paragraph"> </div>

 <span class="inlinecode"><span class="id" title="tactic">repeat</span></span> repeats until failure or non-progress. 
</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <span class="id" title="var">In<sub>10</sub></span> : <span class="id" title="var">In</span> 10 [1;2;3;4;5;6;7;8;9;10].<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">try</span> (<span class="id" title="tactic">left</span>; <span class="id" title="tactic">reflexivity</span>); <span class="id" title="tactic">right</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab498"></a><h1 class="section">Tactics that Make Mentioning Names Unnecessary</h1>

<div class="paragraph"> </div>

 Hardcoding of hypothesis names isn't great. 
</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <span class="id" title="var">hyp_name</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">P</span> : <span class="id" title="keyword">Prop</span>), <span class="id" title="var">P</span> → <span class="id" title="var">P</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">HP</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">HP</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab499"></a><h2 class="section">The <span class="inlinecode"><span class="id" title="tactic">assumption</span></span> tactic</h2>

<div class="paragraph"> </div>

 Nameless is better. 
</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <span class="id" title="var">no_hyp_name</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">P</span> : <span class="id" title="keyword">Prop</span>), <span class="id" title="var">P</span> → <span class="id" title="var">P</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
There's a tradeoff between ease of reading and ease of
    writing/maintaining. Eliminating hardcoded names can help with
    both. 
</div>

<div class="doc">
<a id="lab500"></a><h2 class="section">The <span class="inlinecode"><span class="id" title="var">contradiction</span></span> tactic</h2>

<div class="paragraph"> </div>

 The <span class="inlinecode"><span class="id" title="var">contradiction</span></span> tactic handles some ad hoc situations where a
    hypothesis contains <span class="inlinecode"><span class="id" title="var">False</span></span>, or two hypotheses derive <span class="inlinecode"><span class="id" title="var">False</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <span class="id" title="var">false_assumed</span> : <span class="id" title="var">False</span> → 0 = 1.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">false_assumed'</span> : <span class="id" title="var">False</span> → 0 = 1.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">contradiction</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">contras</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">P</span> : <span class="id" title="keyword">Prop</span>), <span class="id" title="var">P</span> → ¬<span class="id" title="var">P</span> → 0 = 1.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">HP</span> <span class="id" title="var">HNP</span>. <span class="id" title="var">exfalso</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">HNP</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">HP</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">contras'</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">P</span> : <span class="id" title="keyword">Prop</span>), <span class="id" title="var">P</span> → ¬<span class="id" title="var">P</span> → 0 = 1.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">contradiction</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab501"></a><h2 class="section">The <span class="inlinecode"><span class="id" title="tactic">subst</span></span> tactic</h2>

<div class="paragraph"> </div>

 The <span class="inlinecode"><span class="id" title="tactic">subst</span></span> tactic substitutes away an identifier, replacing
    it everywhere and eliminating it from the context. That helps
    us to avoid naming hypotheses in <span class="inlinecode"><span class="id" title="tactic">rewrite</span></span>s. 
</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <span class="id" title="var">many_eq</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">o</span> <span class="id" title="var">p</span> : <span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;<span class="id" title="var">n</span> = <span class="id" title="var">m</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">o</span> = <span class="id" title="var">p</span> →<br/>
&nbsp;&nbsp;[<span class="id" title="var">n</span>; <span class="id" title="var">o</span>] = [<span class="id" title="var">m</span>; <span class="id" title="var">p</span>].<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">o</span> <span class="id" title="var">p</span> <span class="id" title="var">Hnm</span> <span class="id" title="var">Hop</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hnm</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hop</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">many_eq'</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">o</span> <span class="id" title="var">p</span> : <span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;<span class="id" title="var">n</span> = <span class="id" title="var">m</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">o</span> = <span class="id" title="var">p</span> →<br/>
&nbsp;&nbsp;[<span class="id" title="var">n</span>; <span class="id" title="var">o</span>] = [<span class="id" title="var">m</span>; <span class="id" title="var">p</span>].<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab502"></a><h2 class="section">The <span class="inlinecode"><span class="id" title="tactic">constructor</span></span> tactic</h2>

<div class="paragraph"> </div>

 The <span class="inlinecode"><span class="id" title="tactic">constructor</span></span> tactic searches for an applicable
    constructor. 
</div>
<div class="code">

<span class="id" title="keyword">Example</span> <span class="id" title="var">constructor_example</span>: <span class="id" title="keyword">∀</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ev</span> (<span class="id" title="var">n</span> + <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">constructor</span>. <span class="comment">(*&nbsp;applies&nbsp;ev_0&nbsp;*)</span><br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">add_comm</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">constructor</span>. <span class="comment">(*&nbsp;applies&nbsp;ev_SS&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab503"></a><h1 class="section">Automatic Solvers</h1>

<div class="paragraph"> </div>

 Coq has several special-purpose tactics that can solve
    certain kinds of goals in a completely automated way. These
    tactics are based on sophisticated algorithms developed for
    verification in specific mathematical or logical domains.

<div class="paragraph"> </div>

    Some automatic solvers are <i>decision procedures</i>, which are
    algorithms that always terminate, and always give a correct
    answer. Here, that means that they always find a correct proof, or
    correctly determine that the goal is invalid.  Other automatic
    solvers are <i>incomplete</i>: they might fail to find a proof of a
    valid goal. 
</div>

<div class="doc">
<a id="lab504"></a><h2 class="section">Linear Integer Arithmetic: The <span class="inlinecode"><span class="id" title="var">lia</span></span> Tactic</h2>

<div class="paragraph"> </div>

 <span class="inlinecode"><span class="id" title="var">lia</span></span> is a decision procedure for integer linear
    arithmetic. 
</div>
<div class="code">

<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Lia</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">lia_succeed1</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;<span class="id" title="var">n</span> &gt; 0 → <span class="id" title="var">n</span> × 2 &gt; <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">lia</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">lia_succeed2</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">n</span> × <span class="id" title="var">m</span> = <span class="id" title="var">m</span> × <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lia</span>. <span class="comment">(*&nbsp;solvable&nbsp;though&nbsp;non-linear&nbsp;*)</span><br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">lia_fail1</span> : 0 = 1.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Fail</span> <span class="id" title="var">lia</span>. <span class="comment">(*&nbsp;goal&nbsp;is&nbsp;invalid&nbsp;*)</span><br/>
<span class="id" title="keyword">Abort</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">lia_fail2</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">n</span> ≥ 1 → 2 ^ <span class="id" title="var">n</span> = 2 × 2 ^ (<span class="id" title="var">n</span> - 1).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Fail</span> <span class="id" title="var">lia</span>. <span class="comment">(*goal&nbsp;is&nbsp;non-linear,&nbsp;valid,&nbsp;but&nbsp;unsolvable&nbsp;by&nbsp;lia&nbsp;*)</span><br/>
<span class="id" title="keyword">Abort</span>.<br/>
</div>

<div class="doc">
<a id="lab505"></a><h2 class="section">Equalities: The <span class="inlinecode"><span class="id" title="tactic">congruence</span></span> Tactic</h2>

<div class="paragraph"> </div>

 We don't need to know what a function does to prove
    some equalities. 
</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <span class="id" title="var">eq_example1</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> → <span class="id" title="var">B</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">B</span> → <span class="id" title="var">C</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">y</span> : <span class="id" title="var">B</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">y</span> = <span class="id" title="var">f</span> <span class="id" title="var">x</span> → <span class="id" title="var">g</span> <span class="id" title="var">y</span> = <span class="id" title="var">g</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
The essential properties of equality are that it is:

<div class="paragraph"> </div>

<ul class="doclist">
<li> reflexive

<div class="paragraph"> </div>


</li>
<li> symmetric

<div class="paragraph"> </div>


</li>
<li> transitive

<div class="paragraph"> </div>


</li>
<li> a <i>congruence</i>: it respects function and predicate
      application. 
</li>
</ul>

<div class="paragraph"> </div>

<a id="lab506"></a><h3 class="section"> </h3>
 The <span class="inlinecode"><span class="id" title="tactic">congruence</span></span> tactic is a decision procedure for equality with
    uninterpreted functions and other symbols.  
</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <span class="id" title="var">eq_example1'</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> → <span class="id" title="var">B</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">B</span> → <span class="id" title="var">C</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">y</span> : <span class="id" title="var">B</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">y</span> = <span class="id" title="var">f</span> <span class="id" title="var">x</span> → <span class="id" title="var">g</span> <span class="id" title="var">y</span> = <span class="id" title="var">g</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">eq_example2</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">o</span> <span class="id" title="var">p</span> : <span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">n</span> = <span class="id" title="var">m</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">o</span> = <span class="id" title="var">p</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">n</span>, <span class="id" title="var">o</span>) = (<span class="id" title="var">m</span>, <span class="id" title="var">p</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">eq_example3</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">h</span> : <span class="id" title="var">X</span>) (<span class="id" title="var">t</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[] ≠ <span class="id" title="var">h</span> :: <span class="id" title="var">t</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab507"></a><h2 class="section">Propositions: The <span class="inlinecode"><span class="id" title="tactic">intuition</span></span> Tactic</h2>

<div class="paragraph"> </div>

 <span class="inlinecode"><span class="id" title="tactic">intuition</span></span> implements a decision procedure for
    propositional logic, and simplifies what it cannot prove. 
</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <span class="id" title="var">intuition_succeed1</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">P</span> : <span class="id" title="keyword">Prop</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">P</span> → <span class="id" title="var">P</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intuition</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">intuition_succeed2</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <span class="id" title="keyword">Prop</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;¬(<span class="id" title="var">P</span> ∨ <span class="id" title="var">Q</span>) → ¬<span class="id" title="var">P</span> ∧ ¬<span class="id" title="var">Q</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intuition</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">intuition_simplify1</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">P</span> : <span class="id" title="keyword">Prop</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;~~<span class="id" title="var">P</span> → <span class="id" title="var">P</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intuition</span>. <span class="comment">(*&nbsp;not&nbsp;a&nbsp;constructively&nbsp;valid&nbsp;formula&nbsp;*)</span><br/>
<span class="id" title="keyword">Abort</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">intuition_simplify2</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <span class="id" title="var">nat</span> → <span class="id" title="keyword">Prop</span>),<br/>
&nbsp;&nbsp;<span class="id" title="var">x</span> = <span class="id" title="var">y</span> ∧ (<span class="id" title="var">P</span> <span class="id" title="var">x</span> → <span class="id" title="var">Q</span> <span class="id" title="var">x</span>) ∧ <span class="id" title="var">P</span> <span class="id" title="var">x</span> → <span class="id" title="var">Q</span> <span class="id" title="var">y</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Fail</span> <span class="id" title="tactic">congruence</span>. <span class="comment">(*&nbsp;the&nbsp;propositions&nbsp;stump&nbsp;it&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">intuition</span>. <span class="comment">(*&nbsp;the&nbsp;<span class="inlinecode">=</span>&nbsp;stumps&nbsp;it,&nbsp;but&nbsp;it&nbsp;simplifies&nbsp;the&nbsp;propositions&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="tactic">intuition</span></span> takes an optional argument. 
</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <span class="id" title="var">intuition_simplify2'</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <span class="id" title="var">nat</span> → <span class="id" title="keyword">Prop</span>),<br/>
&nbsp;&nbsp;<span class="id" title="var">x</span> = <span class="id" title="var">y</span> ∧ (<span class="id" title="var">P</span> <span class="id" title="var">x</span> → <span class="id" title="var">Q</span> <span class="id" title="var">x</span>) ∧ <span class="id" title="var">P</span> <span class="id" title="var">x</span> → <span class="id" title="var">Q</span> <span class="id" title="var">y</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intuition</span> <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab508"></a><h1 class="section">Search Tactics</h1>

<div class="paragraph"> </div>

 The automated solvers we just discussed are capable of finding
    proofs in specific domains. Some of them might pay attention to
    local hypotheses, but overall they don't make use of any custom
    lemmas we've proved, or that are provided by libraries that we
    load.

<div class="paragraph"> </div>

    Another kind of automation that Coq provides does just that: the
    <span class="inlinecode"><span class="id" title="tactic">auto</span></span> tactic and its variants search for proofs that can be
    assembled out of hypotheses and lemmas. 
</div>

<div class="doc">
<a id="lab509"></a><h2 class="section">The <span class="inlinecode"><span class="id" title="tactic">auto</span></span> Tactic</h2>

<div class="paragraph"> </div>

 Until this chapter, our proof scripts mostly applied relevant
    hypotheses or lemmas by name, and one at a time. 
</div>
<div class="code">

<span class="id" title="keyword">Example</span> <span class="id" title="var">auto_example_1</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">P</span> <span class="id" title="var">Q</span> <span class="id" title="var">R</span>: <span class="id" title="keyword">Prop</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="var">P</span> → <span class="id" title="var">Q</span>) → (<span class="id" title="var">Q</span> → <span class="id" title="var">R</span>) → <span class="id" title="var">P</span> → <span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> <span class="id" title="var">R</span> <span class="id" title="var">H<sub>1</sub></span> <span class="id" title="var">H<sub>2</sub></span> <span class="id" title="var">H<sub>3</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H<sub>2</sub></span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H<sub>1</sub></span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H<sub>3</sub></span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
The <span class="inlinecode"><span class="id" title="tactic">auto</span></span> tactic frees us from this drudgery by <i>searching</i> for a
    sequence of applications that will prove the goal: 
</div>
<div class="code">

<span class="id" title="keyword">Example</span> <span class="id" title="var">auto_example_1'</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">P</span> <span class="id" title="var">Q</span> <span class="id" title="var">R</span>: <span class="id" title="keyword">Prop</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="var">P</span> → <span class="id" title="var">Q</span>) → (<span class="id" title="var">Q</span> → <span class="id" title="var">R</span>) → <span class="id" title="var">P</span> → <span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab510"></a><h3 class="section"> </h3>
 The <span class="inlinecode"><span class="id" title="tactic">auto</span></span> tactic solves goals that are solvable by any combination of
<ul class="doclist">
<li> <span class="inlinecode"><span class="id" title="tactic">intros</span></span> and

</li>
<li> <span class="inlinecode"><span class="id" title="tactic">apply</span></span> (of hypotheses from the local context, by default). 
</li>
</ul>

<div class="paragraph"> </div>

 Here is a more interesting example showing <span class="inlinecode"><span class="id" title="tactic">auto</span></span>'s power: 
</div>
<div class="code">

<span class="id" title="keyword">Example</span> <span class="id" title="var">auto_example_2</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> <span class="id" title="var">R</span> <span class="id" title="var">S</span> <span class="id" title="var">T</span> <span class="id" title="var">U</span> : <span class="id" title="keyword">Prop</span>,<br/>
&nbsp;&nbsp;(<span class="id" title="var">P</span> → <span class="id" title="var">Q</span>) →<br/>
&nbsp;&nbsp;(<span class="id" title="var">P</span> → <span class="id" title="var">R</span>) →<br/>
&nbsp;&nbsp;(<span class="id" title="var">T</span> → <span class="id" title="var">R</span>) →<br/>
&nbsp;&nbsp;(<span class="id" title="var">S</span> → <span class="id" title="var">T</span> → <span class="id" title="var">U</span>) →<br/>
&nbsp;&nbsp;((<span class="id" title="var">P</span> → <span class="id" title="var">Q</span>) → (<span class="id" title="var">P</span> → <span class="id" title="var">S</span>)) →<br/>
&nbsp;&nbsp;<span class="id" title="var">T</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">P</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">U</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab511"></a><h3 class="section"> </h3>
 Proof search could, in principle, take an arbitrarily long time,
    so there are limits to how far <span class="inlinecode"><span class="id" title="tactic">auto</span></span> will search by default. 
</div>
<div class="code">

<span class="id" title="keyword">Example</span> <span class="id" title="var">auto_example_3</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">P</span> <span class="id" title="var">Q</span> <span class="id" title="var">R</span> <span class="id" title="var">S</span> <span class="id" title="var">T</span> <span class="id" title="var">U</span>: <span class="id" title="keyword">Prop</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="var">P</span> → <span class="id" title="var">Q</span>) →<br/>
&nbsp;&nbsp;(<span class="id" title="var">Q</span> → <span class="id" title="var">R</span>) →<br/>
&nbsp;&nbsp;(<span class="id" title="var">R</span> → <span class="id" title="var">S</span>) →<br/>
&nbsp;&nbsp;(<span class="id" title="var">S</span> → <span class="id" title="var">T</span>) →<br/>
&nbsp;&nbsp;(<span class="id" title="var">T</span> → <span class="id" title="var">U</span>) →<br/>
&nbsp;&nbsp;<span class="id" title="var">P</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">U</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;When&nbsp;it&nbsp;cannot&nbsp;solve&nbsp;the&nbsp;goal,&nbsp;<span class="inlinecode"><span class="id" title="tactic">auto</span></span>&nbsp;does&nbsp;nothing&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Optional&nbsp;argument&nbsp;says&nbsp;how&nbsp;deep&nbsp;to&nbsp;search&nbsp;(default&nbsp;is&nbsp;5)&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span> 6.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab512"></a><h3 class="section"> </h3>

<div class="paragraph"> </div>

 The <span class="inlinecode"><span class="id" title="tactic">auto</span></span> tactic considers the hypotheses in the current context
    together with a <i>hint database</i> of other lemmas and constructors.
    Some common facts about equality and logical operators are
    installed in the hint database by default. 
</div>
<div class="code">

<span class="id" title="keyword">Example</span> <span class="id" title="var">auto_example_4</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> <span class="id" title="var">R</span> : <span class="id" title="keyword">Prop</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">Q</span> →<br/>
&nbsp;&nbsp;(<span class="id" title="var">Q</span> → <span class="id" title="var">R</span>) →<br/>
&nbsp;&nbsp;<span class="id" title="var">P</span> ∨ (<span class="id" title="var">Q</span> ∧ <span class="id" title="var">R</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
If we want to see which facts <span class="inlinecode"><span class="id" title="tactic">auto</span></span> is using, we can use
    <span class="inlinecode"><span class="id" title="tactic">info_auto</span></span> instead. 
</div>
<div class="code">

<span class="id" title="keyword">Example</span> <span class="id" title="var">auto_example_5</span> : 2 = 2.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;<span class="inlinecode"><span class="id" title="tactic">auto</span></span>&nbsp;subsumes&nbsp;<span class="inlinecode"><span class="id" title="tactic">reflexivity</span></span>&nbsp;because&nbsp;<span class="inlinecode"><span class="id" title="var">eq_refl</span></span>&nbsp;is&nbsp;in&nbsp;the&nbsp;hint<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;database.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">info_auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab513"></a><h3 class="section"> </h3>
 We can extend the hint database with theorem <span class="inlinecode"><span class="id" title="var">t</span></span> just for the
    purposes of one application of <span class="inlinecode"><span class="id" title="tactic">auto</span></span> by writing <span class="inlinecode"><span class="id" title="tactic">auto</span></span> <span class="inlinecode"><span class="id" title="keyword">using</span></span>
    <span class="inlinecode"><span class="id" title="var">t</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <span class="id" title="var">le_antisym</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>: <span class="id" title="var">nat</span>, (<span class="id" title="var">n</span> ≤ <span class="id" title="var">m</span> ∧ <span class="id" title="var">m</span> ≤ <span class="id" title="var">n</span>) → <span class="id" title="var">n</span> = <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="var">lia</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Example</span> <span class="id" title="var">auto_example_6</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">p</span> : <span class="id" title="var">nat</span>,<br/>
&nbsp;&nbsp;(<span class="id" title="var">n</span> ≤ <span class="id" title="var">p</span> → (<span class="id" title="var">n</span> ≤ <span class="id" title="var">m</span> ∧ <span class="id" title="var">m</span> ≤ <span class="id" title="var">n</span>)) →<br/>
&nbsp;&nbsp;<span class="id" title="var">n</span> ≤ <span class="id" title="var">p</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">n</span> = <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span> <span class="id" title="keyword">using</span> <span class="id" title="var">le_antisym</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab514"></a><h3 class="section"> </h3>

<div class="paragraph"> </div>

 We can also extend hint databases for future uses:

<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><span class="id" title="keyword">Hint</span></span> <span class="inlinecode"><span class="id" title="keyword">Resolve</span></span> <span class="inlinecode"><span class="id" title="var">T</span></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" title="var">db</span>.</span>

<div class="paragraph"> </div>

          Add theorem or constructor <span class="inlinecode"><span class="id" title="var">T</span></span> to <span class="inlinecode"><span class="id" title="var">db</span></span>.

<div class="paragraph"> </div>


</li>
<li> <span class="inlinecode"><span class="id" title="keyword">Hint</span></span> <span class="inlinecode"><span class="id" title="keyword">Constructors</span></span> <span class="inlinecode"><span class="id" title="var">c</span></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" title="var">db</span>.</span>

<div class="paragraph"> </div>

          Add <i>all</i> constructors of <span class="inlinecode"><span class="id" title="var">c</span></span> to <span class="inlinecode"><span class="id" title="var">db</span></span>.

<div class="paragraph"> </div>


</li>
<li> <span class="inlinecode"><span class="id" title="keyword">Hint</span></span> <span class="inlinecode"><span class="id" title="keyword">Unfold</span></span> <span class="inlinecode"><span class="id" title="var">d</span></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" title="var">db</span>.</span>

<div class="paragraph"> </div>

          Automatically expand defined symbol <span class="inlinecode"><span class="id" title="var">d</span></span> when using <span class="inlinecode"><span class="id" title="var">db</span></span>.

</li>
</ul>

<div class="paragraph"> </div>

<a id="lab515"></a><h3 class="section"> </h3>

</div>
<div class="code">
<span class="id" title="keyword">Create HintDb</span> <span class="id" title="var">le_db</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">le_antisym</span> : <span class="id" title="var">le_db</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Example</span> <span class="id" title="var">auto_example_6'</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">p</span> : <span class="id" title="var">nat</span>,<br/>
&nbsp;&nbsp;(<span class="id" title="var">n</span> ≤ <span class="id" title="var">p</span> → (<span class="id" title="var">n</span> ≤ <span class="id" title="var">m</span> ∧ <span class="id" title="var">m</span> ≤ <span class="id" title="var">n</span>)) →<br/>
&nbsp;&nbsp;<span class="id" title="var">n</span> ≤ <span class="id" title="var">p</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">n</span> = <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">le_db</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab516"></a><h2 class="section">The <span class="inlinecode"><span class="id" title="tactic">eauto</span></span> variant</h2>

<div class="paragraph"> </div>

 Consider this example: 
</div>
<div class="code">

<span class="id" title="keyword">Example</span> <span class="id" title="var">trans_example1</span>:  <span class="id" title="keyword">∀</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span> ≤ <span class="id" title="var">b</span> + <span class="id" title="var">b</span> × <span class="id" title="var">c</span>  →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(1 + <span class="id" title="var">c</span>) × <span class="id" title="var">b</span> ≤ <span class="id" title="var">d</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span> ≤ <span class="id" title="var">d</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> <span class="id" title="var">H<sub>1</sub></span> <span class="id" title="var">H<sub>2</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">le_trans</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">b</span> + <span class="id" title="var">b</span> × <span class="id" title="var">c</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;^&nbsp;We&nbsp;must&nbsp;supply&nbsp;the&nbsp;intermediate&nbsp;value&nbsp;*)</span><br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">H<sub>1</sub></span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>2</sub></span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">mul_comm</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H<sub>2</sub></span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="tactic">apply</span></span> fails if we leave out the <span class="inlinecode"><span class="id" title="keyword">with</span></span>, even though the
    appropriate value for <span class="inlinecode"><span class="id" title="var">n</span></span> will become obvious in the very next
    step. 
<div class="paragraph"> </div>

<a id="lab517"></a><h3 class="section"> </h3>
 With <span class="inlinecode"><span class="id" title="tactic">eapply</span></span>, we can eliminate this silliness: 
</div>
<div class="code">

<span class="id" title="keyword">Example</span> <span class="id" title="var">trans_example1'</span>:  <span class="id" title="keyword">∀</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span> ≤ <span class="id" title="var">b</span> + <span class="id" title="var">b</span> × <span class="id" title="var">c</span>  →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(1 + <span class="id" title="var">c</span>) × <span class="id" title="var">b</span> ≤ <span class="id" title="var">d</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span> ≤ <span class="id" title="var">d</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> <span class="id" title="var">H<sub>1</sub></span> <span class="id" title="var">H<sub>2</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">le_trans</span>. <span class="comment">(*&nbsp;1&nbsp;*)</span><br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">H<sub>1</sub></span>. <span class="comment">(*&nbsp;2&nbsp;*)</span><br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>2</sub></span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">mul_comm</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H<sub>2</sub></span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab518"></a><h3 class="section"> </h3>
 Again, using <span class="inlinecode"><span class="id" title="tactic">eauto</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Example</span> <span class="id" title="var">trans_example2</span>:  <span class="id" title="keyword">∀</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span> ≤ <span class="id" title="var">b</span> + <span class="id" title="var">b</span> × <span class="id" title="var">c</span>  →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">b</span> + <span class="id" title="var">b</span> × <span class="id" title="var">c</span> ≤ <span class="id" title="var">d</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span> ≤ <span class="id" title="var">d</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> <span class="id" title="var">H<sub>1</sub></span> <span class="id" title="var">H<sub>2</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">info_eauto</span> <span class="id" title="keyword">using</span> <span class="id" title="var">le_trans</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="tactic">eauto</span></span> is significantly slower than <span class="inlinecode"><span class="id" title="tactic">auto</span></span>. Use only as
    needed. 
</div>

<div class="doc">
<a id="lab519"></a><h1 class="section">Ltac: The Tactic Language</h1>

<div class="paragraph"> </div>

 New tactics can be defined in two ways:

<div class="paragraph"> </div>

<ul class="doclist">
<li> OCaml: low-level implementation (for wizards)

<div class="paragraph"> </div>


</li>
<li> Ltac: in-Coq language (for everyone) 
</li>
</ul>

<div class="paragraph"> </div>

<a id="lab520"></a><h2 class="section">Ltac Functions</h2>

<div class="paragraph"> </div>

 Here is a simple <span class="inlinecode"><span class="id" title="keyword">Ltac</span></span> example: 
</div>
<div class="code">

<span class="id" title="keyword">Ltac</span> <span class="id" title="var">simpl_and_try</span> <span class="id" title="var">tac</span> := <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">tac</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Example</span> <span class="id" title="var">sat_ex<sub>1</sub></span> : 1 + 1 = 2.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">simpl_and_try</span> <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Example</span> <span class="id" title="var">sat_ex<sub>2</sub></span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>), 1 - 1 + <span class="id" title="var">n</span> + 1 = 1 + <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">simpl_and_try</span> <span class="id" title="tactic">reflexivity</span>. <span class="id" title="var">lia</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab521"></a><h3 class="section"> </h3>

<div class="paragraph"> </div>

 For a more useful tactic, consider these three proofs from
    <a href="Basics.html"><span class="inlineref">Basics</span></a>, and how structurally similar they all are: 
</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <span class="id" title="var">plus_1_neq_0</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>,<br/>
&nbsp;&nbsp;(<span class="id" title="var">n</span> + 1) =? 0 = <span class="id" title="var">false</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">negb_involutive</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">b</span> : <span class="id" title="var">bool</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">negb</span> (<span class="id" title="var">negb</span> <span class="id" title="var">b</span>) = <span class="id" title="var">b</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">b</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">andb_commutative</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>, <span class="id" title="var">andb</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> = <span class="id" title="var">andb</span> <span class="id" title="var">c</span> <span class="id" title="var">b</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab522"></a><h3 class="section"> </h3>
 We can factor out the common structure:

<div class="paragraph"> </div>

<ul class="doclist">
<li> Do a destruct.

<div class="paragraph"> </div>


</li>
<li> For each branch, finish with <span class="inlinecode"><span class="id" title="tactic">reflexivity</span></span> -- if possible. 

</li>
</ul>
</div>
<div class="code">

<span class="id" title="keyword">Ltac</span> <span class="id" title="var">destructpf</span> <span class="id" title="var">x</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">plus_1_neq_0'</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">n</span> : <span class="id" title="var">nat</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">n</span> + 1) =? 0 = <span class="id" title="var">false</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">n</span>; <span class="id" title="var">destructpf</span> <span class="id" title="var">n</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">negb_involutive'</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">b</span> : <span class="id" title="var">bool</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">negb</span> (<span class="id" title="var">negb</span> <span class="id" title="var">b</span>) = <span class="id" title="var">b</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">b</span>; <span class="id" title="var">destructpf</span> <span class="id" title="var">b</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">andb_commutative'</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>, <span class="id" title="var">andb</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> = <span class="id" title="var">andb</span> <span class="id" title="var">c</span> <span class="id" title="var">b</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>; <span class="id" title="var">destructpf</span> <span class="id" title="var">b</span>; <span class="id" title="var">destructpf</span> <span class="id" title="var">c</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab523"></a><h2 class="section">Ltac Pattern Matching</h2>

<div class="paragraph"> </div>

<a id="lab524"></a><h3 class="section"> </h3>
 Here is another common proof pattern that we have seen in
    many simple proofs by induction: 
</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <span class="id" title="var">app_nil_r</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">lst</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lst</span> ++ [] = <span class="id" title="var">lst</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">X</span> <span class="id" title="var">lst</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">lst</span> <span class="id" title="keyword">as</span> [ | <span class="id" title="var">h</span> <span class="id" title="var">t</span> <span class="id" title="var">IHt</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
How can we automate that pattern? Ltac has a <span class="inlinecode"><span class="id" title="keyword">match</span></span> <span class="inlinecode"><span class="id" title="keyword">goal</span></span>
    tactic. 
<div class="paragraph"> </div>

<a id="lab525"></a><h3 class="section"> </h3>

</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <span class="id" title="var">match_ex<sub>1</sub></span> : <span class="id" title="var">True</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [ &#x22A2; <span class="id" title="var">True</span> ] ⇒ <span class="id" title="tactic">apply</span> <span class="id" title="var">I</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
That says: if the conclusion is <span class="inlinecode"><span class="id" title="var">True</span></span> (regardless of the
    hypotheses), run <span class="inlinecode"><span class="id" title="tactic">apply</span></span> <span class="inlinecode"><span class="id" title="var">I</span></span>. 
<div class="paragraph"> </div>

<a id="lab526"></a><h3 class="section"> </h3>
 There may be multiple branches, which are tried in order. 
</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <span class="id" title="var">match_ex<sub>2</sub></span> : <span class="id" title="var">True</span> ∧ <span class="id" title="var">True</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [ &#x22A2; <span class="id" title="var">True</span> ] ⇒ <span class="id" title="tactic">apply</span> <span class="id" title="var">I</span><br/>
&nbsp;&nbsp;| [ &#x22A2; <span class="id" title="var">True</span> ∧ <span class="id" title="var">True</span> ] ⇒ <span class="id" title="tactic">split</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">I</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
To see what branches are being tried, it can help to insert calls
    to the identity tactic <span class="inlinecode"><span class="id" title="tactic">idtac</span></span>. It optionally accepts an argument
    to print out as debugging information. 
</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <span class="id" title="var">match_ex<sub>2</sub>'</span> : <span class="id" title="var">True</span> ∧ <span class="id" title="var">True</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [ &#x22A2; <span class="id" title="var">True</span> ] ⇒ <span class="id" title="tactic">idtac</span> "branch 1"; <span class="id" title="tactic">apply</span> <span class="id" title="var">I</span><br/>
&nbsp;&nbsp;| [ &#x22A2; <span class="id" title="var">True</span> ∧ <span class="id" title="var">True</span> ] ⇒ <span class="id" title="tactic">idtac</span> "branch 2"; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">I</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Only the second branch was tried. The first one did not match the
    goal. 
<div class="paragraph"> </div>

<a id="lab527"></a><h3 class="section"> </h3>
 Ordinary <span class="inlinecode"><span class="id" title="keyword">match</span></span> doesn't allow redundant branches. 
</div>
<div class="code">

<span class="id" title="var">Fail</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">redundant_match</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">nat</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">x</span> ⇒ <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;| 0 ⇒ 1<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
</div>

<div class="doc">
But <span class="inlinecode"><span class="id" title="keyword">match</span></span> <span class="inlinecode"><span class="id" title="keyword">goal</span></span> keeps trying until success. 
</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <span class="id" title="var">match_ex<sub>2</sub>''</span> : <span class="id" title="var">True</span> ∧ <span class="id" title="var">True</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [ &#x22A2; <span class="id" title="var">_</span> ] ⇒ <span class="id" title="tactic">idtac</span> "branch 1"; <span class="id" title="tactic">apply</span> <span class="id" title="var">I</span><br/>
&nbsp;&nbsp;| [ &#x22A2; <span class="id" title="var">True</span> ∧ <span class="id" title="var">True</span> ] ⇒ <span class="id" title="tactic">idtac</span> "branch 2"; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">I</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">match_ex<sub>2</sub>'''</span> : <span class="id" title="var">True</span> ∧ <span class="id" title="var">True</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Fail</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [ &#x22A2; <span class="id" title="var">_</span> ] ⇒ <span class="id" title="tactic">idtac</span> "branch 1"; <span class="id" title="tactic">apply</span> <span class="id" title="var">I</span><br/>
&nbsp;&nbsp;| [ &#x22A2; <span class="id" title="var">_</span> ] ⇒ <span class="id" title="tactic">idtac</span> "branch 2"; <span class="id" title="tactic">apply</span> <span class="id" title="var">I</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Abort</span>.<br/>
</div>

<div class="doc">
<a id="lab528"></a><h3 class="section"> </h3>
 A match against a hypothesis: 
</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <span class="id" title="var">match_ex<sub>3</sub></span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">P</span> : <span class="id" title="keyword">Prop</span>), <span class="id" title="var">P</span> → <span class="id" title="var">P</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">HP</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : <span class="id" title="var">_</span> &#x22A2; <span class="id" title="var">_</span> ] ⇒ <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">H</span></span> is bound to <span class="inlinecode"><span class="id" title="var">HP</span></span>, as shown by printout from <span class="inlinecode"><span class="id" title="tactic">idtac</span></span>
    <span class="inlinecode"><span class="id" title="var">H</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <span class="id" title="var">match_ex<sub>3</sub>'</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">P</span> : <span class="id" title="keyword">Prop</span>), <span class="id" title="var">P</span> → <span class="id" title="var">P</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">HP</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : <span class="id" title="var">_</span> &#x22A2; <span class="id" title="var">_</span> ] ⇒ <span class="id" title="tactic">idtac</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab529"></a><h3 class="section"> </h3>
 Matching will <i>backtrack</i> and retry with other
    hypotheses as necessary. 
</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <span class="id" title="var">match_ex<sub>4</sub></span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <span class="id" title="keyword">Prop</span>), <span class="id" title="var">P</span> → <span class="id" title="var">Q</span> → <span class="id" title="var">P</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> <span class="id" title="var">HP</span> <span class="id" title="var">HQ</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : <span class="id" title="var">_</span> &#x22A2; <span class="id" title="var">_</span> ] ⇒ <span class="id" title="tactic">idtac</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab530"></a><h3 class="section"> </h3>
 But if there were no successful hypotheses, the entire match
    would fail: 
</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <span class="id" title="var">match_ex<sub>5</sub></span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">P</span> <span class="id" title="var">Q</span> <span class="id" title="var">R</span> : <span class="id" title="keyword">Prop</span>), <span class="id" title="var">P</span> → <span class="id" title="var">Q</span> → <span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> <span class="id" title="var">R</span> <span class="id" title="var">HP</span> <span class="id" title="var">HQ</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Fail</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : <span class="id" title="var">_</span> &#x22A2; <span class="id" title="var">_</span> ] ⇒ <span class="id" title="tactic">idtac</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Abort</span>.<br/>
</div>

<div class="doc">
<a id="lab531"></a><h3 class="section"> </h3>
 <i>Metavariables</i> are pattern variables for the goal: 
</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <span class="id" title="var">match_ex<sub>5</sub></span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <span class="id" title="keyword">Prop</span>), <span class="id" title="var">P</span> → <span class="id" title="var">Q</span> → <span class="id" title="var">P</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> <span class="id" title="var">HP</span> <span class="id" title="var">HQ</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| [ <span class="id" title="var">H</span> : ?<span class="id" title="var">X</span> &#x22A2; ?<span class="id" title="var">X</span> ] ⇒ <span class="id" title="tactic">idtac</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
That applies only <span class="inlinecode"><span class="id" title="var">HP</span></span>, because <span class="inlinecode"><span class="id" title="var">HQ</span></span> doesn't match. 
<div class="paragraph"> </div>

<a id="lab532"></a><h3 class="section"> </h3>
 With <span class="inlinecode"><span class="id" title="keyword">match</span></span> against terms, pattern variables can't be
    repeated: 
</div>
<div class="code">

<span class="id" title="var">Fail</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">dup_first_two_elts</span> (<span class="id" title="var">lst</span> : <span class="id" title="var">list</span> <span class="id" title="var">nat</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">lst</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">x</span> :: <span class="id" title="var">x</span> :: <span class="id" title="var">_</span> ⇒ <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
</div>

<div class="doc">
The technical term for this is <i>linearity</i>: regular <span class="inlinecode"><span class="id" title="keyword">match</span></span>
    requires pattern variables to be <i>linear</i>, meaning that they are
    used only once. Tactic <span class="inlinecode"><span class="id" title="keyword">match</span></span> <span class="inlinecode"><span class="id" title="keyword">goal</span></span> permits <i>non-linear</i>
    metavariables, meaning that they can be used multiple times in a
    pattern and must bind the same term each time. 
<div class="paragraph"> </div>

<a id="lab533"></a><h3 class="section"> </h3>
 Now that we've learned a bit about <span class="inlinecode"><span class="id" title="keyword">match</span></span> <span class="inlinecode"><span class="id" title="keyword">goal</span></span>, let's return
    to the proof pattern of some simple inductions: 
</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <span class="id" title="var">app_nil_r'</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">lst</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lst</span> ++ [] = <span class="id" title="var">lst</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">X</span> <span class="id" title="var">lst</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">lst</span> <span class="id" title="keyword">as</span> [ | <span class="id" title="var">h</span> <span class="id" title="var">t</span> <span class="id" title="var">IHt</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHt</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
With <span class="inlinecode"><span class="id" title="keyword">match</span></span> <span class="inlinecode"><span class="id" title="keyword">goal</span></span>, we can automate that proof pattern: 
</div>
<div class="code">

<span class="id" title="keyword">Ltac</span> <span class="id" title="var">simple_induction</span> <span class="id" title="var">t</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span>; <span class="id" title="tactic">simpl</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <span class="id" title="var">_</span> = <span class="id" title="var">_</span> &#x22A2; <span class="id" title="var">_</span>] ⇒ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">app_nil_r''</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">lst</span> : <span class="id" title="var">list</span> <span class="id" title="var">X</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lst</span> ++ [] = <span class="id" title="var">lst</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">X</span> <span class="id" title="var">lst</span>. <span class="id" title="var">simple_induction</span> <span class="id" title="var">lst</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab534"></a><h3 class="section"> </h3>
 That works great! Here are two other proofs that follow the same
    pattern. 
</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <span class="id" title="var">add_assoc''</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">p</span> : <span class="id" title="var">nat</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">n</span> + (<span class="id" title="var">m</span> + <span class="id" title="var">p</span>) = (<span class="id" title="var">n</span> + <span class="id" title="var">m</span>) + <span class="id" title="var">p</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHn</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">add_assoc'''</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">p</span> : <span class="id" title="var">nat</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">n</span> + (<span class="id" title="var">m</span> + <span class="id" title="var">p</span>) = (<span class="id" title="var">n</span> + <span class="id" title="var">m</span>) + <span class="id" title="var">p</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">p</span>. <span class="id" title="var">simple_induction</span> <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">plus_n_Sm</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">S</span> (<span class="id" title="var">n</span> + <span class="id" title="var">m</span>) = <span class="id" title="var">n</span> + (<span class="id" title="var">S</span> <span class="id" title="var">m</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHn</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">plus_n_Sm'</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">S</span> (<span class="id" title="var">n</span> + <span class="id" title="var">m</span>) = <span class="id" title="var">n</span> + (<span class="id" title="var">S</span> <span class="id" title="var">m</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>. <span class="id" title="var">simple_induction</span> <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab535"></a><h1 class="section">Review</h1>

<div class="paragraph"> </div>

 We've learned a lot of new features and tactics in this chapter:

<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><span class="id" title="tactic">try</span></span>, <span class="inlinecode">;</span>, <span class="inlinecode"><span class="id" title="tactic">repeat</span></span>

<div class="paragraph"> </div>


</li>
<li> <span class="inlinecode"><span class="id" title="tactic">assumption</span></span>, <span class="inlinecode"><span class="id" title="var">contradiction</span></span>, <span class="inlinecode"><span class="id" title="tactic">subst</span></span>, <span class="inlinecode"><span class="id" title="tactic">constructor</span></span>

<div class="paragraph"> </div>


</li>
<li> <span class="inlinecode"><span class="id" title="var">lia</span></span>, <span class="inlinecode"><span class="id" title="tactic">congruence</span></span>, <span class="inlinecode"><span class="id" title="tactic">intuition</span></span>

<div class="paragraph"> </div>


</li>
<li> <span class="inlinecode"><span class="id" title="tactic">auto</span></span>, <span class="inlinecode"><span class="id" title="tactic">eauto</span></span>, <span class="inlinecode"><span class="id" title="tactic">eapply</span></span>

<div class="paragraph"> </div>


</li>
<li> Ltac functions and <span class="inlinecode"><span class="id" title="keyword">match</span></span> <span class="inlinecode"><span class="id" title="keyword">goal</span></span> 

</li>
</ul>
</div>
</div>

<div id="footer">
<hr/><a href="coqindex.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>