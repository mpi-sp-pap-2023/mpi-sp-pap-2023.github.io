<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="common/css/sf.css" rel="stylesheet" type="text/css" />
<title>IndProp: Inductively Defined Propositions: part 2</title>
<link href="common/jquery-ui/jquery-ui.css" rel="stylesheet">
<script src="common/jquery-ui/external/jquery/jquery.js"></script>
<script src="common/jquery-ui/jquery-ui.js"></script>
<script src="common/toggleproofs.js"></script>
<link href="common/css/lf.css" rel="stylesheet" type="text/css"/>
</head>

<body>

<div id="page">

<div id="header">
<div id='logoinheader'><a href='https://softwarefoundations.cis.upenn.edu'>
<img src='common/media/image/sf_logo_sm.png' alt='Software Foundations Logo'></a></div>
<div class='booktitleinheader'><a href='index.html'>Volume 1: Logical Foundations</a></div>
<ul id='menu'>
   <li class='section_name'><a href='toc.html'>Table of Contents</a></li>
   <li class='section_name'><a href='coqindex.html'>Index</a></li>
   <li class='section_name'><a href='deps.html'>Roadmap</a></li>
</ul>
</div>

<div id="main">

<h1 class="libtitle">IndProp: Inductively Defined Propositions<span class="subtitle">part 2</span></h1>



<div class="doc">
<a id="lab264"></a><h1 class="section">Case Study: Regular Expressions</h1>

<div class="paragraph"> </div>

 Many of the examples above were simple and the <span class="inlinecode"><span class="id" title="var">ev</span></span> property
    even a bit artificial. To give a better sense of the power of
    inductively defined propositions, we now show how to use them to
    model a classic concept in computer science: <i>regular expressions</i>. 
<div class="paragraph"> </div>

 Regular expressions are a natural language for describing sets of
    strings.  Their syntax is defined as follows: 
</div>
<div class="code">

<span class="id" title="keyword">Inductive</span> <a id="reg_exp" class="idref" href="#reg_exp"><span class="id" title="inductive">reg_exp</span></a> (<a id="T:1" class="idref" href="#T:1"><span class="id" title="binder">T</span></a> : <span class="id" title="keyword">Type</span>) : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a id="EmptySet" class="idref" href="#EmptySet"><span class="id" title="constructor">EmptySet</span></a><br/>
&nbsp;&nbsp;| <a id="EmptyStr" class="idref" href="#EmptyStr"><span class="id" title="constructor">EmptyStr</span></a><br/>
&nbsp;&nbsp;| <a id="Char" class="idref" href="#Char"><span class="id" title="constructor">Char</span></a> (<a id="t:4" class="idref" href="#t:4"><span class="id" title="binder">t</span></a> : <a class="idref" href="IndProp.html#T:1"><span class="id" title="variable">T</span></a>)<br/>
&nbsp;&nbsp;| <a id="App" class="idref" href="#App"><span class="id" title="constructor">App</span></a> (<a id="r<sub>1</sub>:5" class="idref" href="#r<sub>1</sub>:5"><span class="id" title="binder">r<sub>1</sub></span></a> <a id="r<sub>2</sub>:6" class="idref" href="#r<sub>2</sub>:6"><span class="id" title="binder">r<sub>2</sub></span></a> : <a class="idref" href="IndProp.html#reg_exp:2"><span class="id" title="inductive">reg_exp</span></a> <a class="idref" href="IndProp.html#T:1"><span class="id" title="variable">T</span></a>)<br/>
&nbsp;&nbsp;| <a id="Union" class="idref" href="#Union"><span class="id" title="constructor">Union</span></a> (<a id="r<sub>1</sub>:7" class="idref" href="#r<sub>1</sub>:7"><span class="id" title="binder">r<sub>1</sub></span></a> <a id="r<sub>2</sub>:8" class="idref" href="#r<sub>2</sub>:8"><span class="id" title="binder">r<sub>2</sub></span></a> : <a class="idref" href="IndProp.html#reg_exp:2"><span class="id" title="inductive">reg_exp</span></a> <a class="idref" href="IndProp.html#T:1"><span class="id" title="variable">T</span></a>)<br/>
&nbsp;&nbsp;| <a id="Star" class="idref" href="#Star"><span class="id" title="constructor">Star</span></a> (<a id="r:9" class="idref" href="#r:9"><span class="id" title="binder">r</span></a> : <a class="idref" href="IndProp.html#reg_exp:2"><span class="id" title="inductive">reg_exp</span></a> <a class="idref" href="IndProp.html#T:1"><span class="id" title="variable">T</span></a>).<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Arguments</span> <a class="idref" href="IndProp.html#EmptySet"><span class="id" title="constructor">EmptySet</span></a> {<span class="id" title="var">T</span>}.<br/>
<span class="id" title="keyword">Arguments</span> <a class="idref" href="IndProp.html#EmptyStr"><span class="id" title="constructor">EmptyStr</span></a> {<span class="id" title="var">T</span>}.<br/>
<span class="id" title="keyword">Arguments</span> <a class="idref" href="IndProp.html#Char"><span class="id" title="constructor">Char</span></a> {<span class="id" title="var">T</span>} <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Arguments</span> <a class="idref" href="IndProp.html#App"><span class="id" title="constructor">App</span></a> {<span class="id" title="var">T</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Arguments</span> <a class="idref" href="IndProp.html#Union"><span class="id" title="constructor">Union</span></a> {<span class="id" title="var">T</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Arguments</span> <a class="idref" href="IndProp.html#Star"><span class="id" title="constructor">Star</span></a> {<span class="id" title="var">T</span>} <span class="id" title="var">_</span>.<br/>
</div>

<div class="doc">
Note that this definition is <i>polymorphic</i>: Regular
    expressions in <span class="inlinecode"><span class="id" title="var">reg_exp</span></span> <span class="inlinecode"><span class="id" title="var">T</span></span> describe strings with characters drawn
    from <span class="inlinecode"><span class="id" title="var">T</span></span> -- which in this exercise we represent as <i>lists</i> with
    elements from <span class="inlinecode"><span class="id" title="var">T</span></span>. 
</div>
<div class="code">

<span class="comment">(*(Technical&nbsp;aside:&nbsp;We&nbsp;depart&nbsp;slightly&nbsp;from&nbsp;standard&nbsp;practice&nbsp;in<br/>
&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;we&nbsp;do&nbsp;not&nbsp;require&nbsp;the&nbsp;type&nbsp;<span class="inlinecode"><span class="id" title="var">T</span></span>&nbsp;to&nbsp;be&nbsp;finite.&nbsp;&nbsp;This&nbsp;results&nbsp;in<br/>
&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;somewhat&nbsp;different&nbsp;theory&nbsp;of&nbsp;regular&nbsp;expressions,&nbsp;but&nbsp;the<br/>
&nbsp;&nbsp;&nbsp;&nbsp;difference&nbsp;is&nbsp;not&nbsp;significant&nbsp;for&nbsp;present&nbsp;purposes.)&nbsp;*)</span><br/>
</div>

<div class="doc">
We connect regular expressions and strings by defining when a
    regular expression <i>matches</i> some string.
    Informally this looks as follows:

<div class="paragraph"> </div>

<ul class="doclist">
<li> The expression <span class="inlinecode"><span class="id" title="var">EmptySet</span></span> does not match any string.

<div class="paragraph"> </div>


</li>
<li> The expression <span class="inlinecode"><span class="id" title="var">EmptyStr</span></span> matches the empty string <span class="inlinecode">[]</span>.

<div class="paragraph"> </div>


</li>
<li> The expression <span class="inlinecode"><span class="id" title="var">Char</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> matches the one-character string <span class="inlinecode">[<span class="id" title="var">x</span>]</span>.

<div class="paragraph"> </div>


</li>
<li> If <span class="inlinecode"><span class="id" title="var">re<sub>1</sub></span></span> matches <span class="inlinecode"><span class="id" title="var">s<sub>1</sub></span></span>, and <span class="inlinecode"><span class="id" title="var">re<sub>2</sub></span></span> matches <span class="inlinecode"><span class="id" title="var">s<sub>2</sub></span></span>,
        then <span class="inlinecode"><span class="id" title="var">App</span></span> <span class="inlinecode"><span class="id" title="var">re<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">re<sub>2</sub></span></span> matches <span class="inlinecode"><span class="id" title="var">s<sub>1</sub></span></span> <span class="inlinecode">++</span> <span class="inlinecode"><span class="id" title="var">s<sub>2</sub></span></span>.

<div class="paragraph"> </div>


</li>
<li> If at least one of <span class="inlinecode"><span class="id" title="var">re<sub>1</sub></span></span> and <span class="inlinecode"><span class="id" title="var">re<sub>2</sub></span></span> matches <span class="inlinecode"><span class="id" title="var">s</span></span>,
        then <span class="inlinecode"><span class="id" title="var">Union</span></span> <span class="inlinecode"><span class="id" title="var">re<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">re<sub>2</sub></span></span> matches <span class="inlinecode"><span class="id" title="var">s</span></span>.

<div class="paragraph"> </div>


</li>
<li> Finally, if we can write some string <span class="inlinecode"><span class="id" title="var">s</span></span> as the concatenation
        of a sequence of strings <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">s_1</span></span> <span class="inlinecode">++</span> <span class="inlinecode">...</span> <span class="inlinecode">++</span> <span class="inlinecode"><span class="id" title="var">s_k</span></span>, and the
        expression <span class="inlinecode"><span class="id" title="var">re</span></span> matches each one of the strings <span class="inlinecode"><span class="id" title="var">s_i</span></span>,
        then <span class="inlinecode"><span class="id" title="var">Star</span></span> <span class="inlinecode"><span class="id" title="var">re</span></span> matches <span class="inlinecode"><span class="id" title="var">s</span></span>.

<div class="paragraph"> </div>

        In particular, the sequence of strings may be empty, so
        <span class="inlinecode"><span class="id" title="var">Star</span></span> <span class="inlinecode"><span class="id" title="var">re</span></span> always matches the empty string <span class="inlinecode">[]</span> no matter what
        <span class="inlinecode"><span class="id" title="var">re</span></span> is. 
</li>
</ul>

<div class="paragraph"> </div>

 We can easily translate this intuition into a set of rules,
    where we write <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode">=~</span> <span class="inlinecode"><span class="id" title="var">re</span></span> for <span class="inlinecode"><span class="id" title="var">s</span></span> matches regular expression <span class="inlinecode"><span class="id" title="var">re</span></span>: 
<div class="paragraph"> </div>

<center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">&nbsp;&nbsp;</td>
  <td class="infrulenamecol" rowspan="3">
    (MEmpty) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">[] =~ EmptyStr</td>
  <td></td>
</tr>
</table></center><center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">&nbsp;&nbsp;</td>
  <td class="infrulenamecol" rowspan="3">
    (MChar) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">[x] =~ (Char x)</td>
  <td></td>
</tr>
</table></center><center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">s<sub>1</sub> =~ re<sub>1</sub>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s<sub>2</sub> =~ re<sub>2</sub></td>
  <td class="infrulenamecol" rowspan="3">
    (MApp) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">(s<sub>1</sub> ++ s<sub>2</sub>) =~ (App re<sub>1</sub> re<sub>2</sub>)</td>
  <td></td>
</tr>
</table></center><center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">s<sub>1</sub> =~ re<sub>1</sub></td>
  <td class="infrulenamecol" rowspan="3">
    (MUnionL) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">s<sub>1</sub> =~ (Union re<sub>1</sub> re<sub>2</sub>)</td>
  <td></td>
</tr>
</table></center><center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">s<sub>2</sub> =~ re<sub>2</sub></td>
  <td class="infrulenamecol" rowspan="3">
    (MUnionR) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">s<sub>2</sub> =~ (Union re<sub>1</sub> re<sub>2</sub>)</td>
  <td></td>
</tr>
</table></center><center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">&nbsp;&nbsp;</td>
  <td class="infrulenamecol" rowspan="3">
    (MStar0) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">[] =~ (Star re)</td>
  <td></td>
</tr>
</table></center><center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">s<sub>1</sub> =~ re</td>
  <td></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">s<sub>2</sub> =~ (Star re)</td>
  <td class="infrulenamecol" rowspan="3">
    (MStarApp) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">(s<sub>1</sub> ++ s<sub>2</sub>) =~ (Star re)</td>
  <td></td>
</tr>
</table></center>
<div class="paragraph"> </div>

 This directly corresponds to the following <span class="inlinecode"><span class="id" title="keyword">Inductive</span></span> definition.
    We use the notation <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode">=~</span> <span class="inlinecode"><span class="id" title="var">re</span></span> in  place of <span class="inlinecode"><span class="id" title="var">exp_match</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">re</span></span>.
    (By "reserving" the notation before defining the <span class="inlinecode"><span class="id" title="keyword">Inductive</span></span>,
    we can use it in the definition.) 
</div>
<div class="code">

<span class="id" title="keyword">Reserved Notation</span> &quot;s =~ re" (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 80).<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Inductive</span> <a id="exp_match" class="idref" href="#exp_match"><span class="id" title="inductive">exp_match</span></a> {<a id="T:10" class="idref" href="#T:10"><span class="id" title="binder">T</span></a>} : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <span class="id" title="var">T</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="IndProp.html#reg_exp"><span class="id" title="inductive">reg_exp</span></a> <span class="id" title="var">T</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a id="MEmpty" class="idref" href="#MEmpty"><span class="id" title="constructor">MEmpty</span></a> : <a class="idref" href="Poly.html#2c60282cbb04e070c60ae01e76f3865a"><span class="id" title="notation">[]</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#EmptyStr"><span class="id" title="constructor">EmptyStr</span></a><br/>
&nbsp;&nbsp;| <a id="MChar" class="idref" href="#MChar"><span class="id" title="constructor">MChar</span></a> <a id="x:13" class="idref" href="#x:13"><span class="id" title="binder">x</span></a> : <a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">[</span></a><a class="idref" href="IndProp.html#x:13"><span class="id" title="variable">x</span></a><a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">(</span></a><a class="idref" href="IndProp.html#Char"><span class="id" title="constructor">Char</span></a> <a class="idref" href="IndProp.html#x:13"><span class="id" title="variable">x</span></a><a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a id="MApp" class="idref" href="#MApp"><span class="id" title="constructor">MApp</span></a> <a id="s<sub>1</sub>:14" class="idref" href="#s<sub>1</sub>:14"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="re<sub>1</sub>:15" class="idref" href="#re<sub>1</sub>:15"><span class="id" title="binder">re<sub>1</sub></span></a> <a id="s<sub>2</sub>:16" class="idref" href="#s<sub>2</sub>:16"><span class="id" title="binder">s<sub>2</sub></span></a> <a id="re<sub>2</sub>:17" class="idref" href="#re<sub>2</sub>:17"><span class="id" title="binder">re<sub>2</sub></span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="H<sub>1</sub>:18" class="idref" href="#H<sub>1</sub>:18"><span class="id" title="binder">H<sub>1</sub></span></a> : <a class="idref" href="IndProp.html#s<sub>1</sub>:14"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#re<sub>1</sub>:15"><span class="id" title="variable">re<sub>1</sub></span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="H<sub>2</sub>:19" class="idref" href="#H<sub>2</sub>:19"><span class="id" title="binder">H<sub>2</sub></span></a> : <a class="idref" href="IndProp.html#s<sub>2</sub>:16"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#re<sub>2</sub>:17"><span class="id" title="variable">re<sub>2</sub></span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">(</span></a><a class="idref" href="IndProp.html#s<sub>1</sub>:14"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="Poly.html#f03f7a04ef75ff3ac66ca5c23554e52e"><span class="id" title="notation">++</span></a> <a class="idref" href="IndProp.html#s<sub>2</sub>:16"><span class="id" title="variable">s<sub>2</sub></span></a><a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">)</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">(</span></a><a class="idref" href="IndProp.html#App"><span class="id" title="constructor">App</span></a> <a class="idref" href="IndProp.html#re<sub>1</sub>:15"><span class="id" title="variable">re<sub>1</sub></span></a> <a class="idref" href="IndProp.html#re<sub>2</sub>:17"><span class="id" title="variable">re<sub>2</sub></span></a><a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a id="MUnionL" class="idref" href="#MUnionL"><span class="id" title="constructor">MUnionL</span></a> <a id="s<sub>1</sub>:20" class="idref" href="#s<sub>1</sub>:20"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="re<sub>1</sub>:21" class="idref" href="#re<sub>1</sub>:21"><span class="id" title="binder">re<sub>1</sub></span></a> <a id="re<sub>2</sub>:22" class="idref" href="#re<sub>2</sub>:22"><span class="id" title="binder">re<sub>2</sub></span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="H<sub>1</sub>:23" class="idref" href="#H<sub>1</sub>:23"><span class="id" title="binder">H<sub>1</sub></span></a> : <a class="idref" href="IndProp.html#s<sub>1</sub>:20"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#re<sub>1</sub>:21"><span class="id" title="variable">re<sub>1</sub></span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="IndProp.html#s<sub>1</sub>:20"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">(</span></a><a class="idref" href="IndProp.html#Union"><span class="id" title="constructor">Union</span></a> <a class="idref" href="IndProp.html#re<sub>1</sub>:21"><span class="id" title="variable">re<sub>1</sub></span></a> <a class="idref" href="IndProp.html#re<sub>2</sub>:22"><span class="id" title="variable">re<sub>2</sub></span></a><a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a id="MUnionR" class="idref" href="#MUnionR"><span class="id" title="constructor">MUnionR</span></a> <a id="s<sub>2</sub>:24" class="idref" href="#s<sub>2</sub>:24"><span class="id" title="binder">s<sub>2</sub></span></a> <a id="re<sub>1</sub>:25" class="idref" href="#re<sub>1</sub>:25"><span class="id" title="binder">re<sub>1</sub></span></a> <a id="re<sub>2</sub>:26" class="idref" href="#re<sub>2</sub>:26"><span class="id" title="binder">re<sub>2</sub></span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="H<sub>2</sub>:27" class="idref" href="#H<sub>2</sub>:27"><span class="id" title="binder">H<sub>2</sub></span></a> : <a class="idref" href="IndProp.html#s<sub>2</sub>:24"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#re<sub>2</sub>:26"><span class="id" title="variable">re<sub>2</sub></span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="IndProp.html#s<sub>2</sub>:24"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">(</span></a><a class="idref" href="IndProp.html#Union"><span class="id" title="constructor">Union</span></a> <a class="idref" href="IndProp.html#re<sub>1</sub>:25"><span class="id" title="variable">re<sub>1</sub></span></a> <a class="idref" href="IndProp.html#re<sub>2</sub>:26"><span class="id" title="variable">re<sub>2</sub></span></a><a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a id="MStar0" class="idref" href="#MStar0"><span class="id" title="constructor">MStar0</span></a> <a id="re:28" class="idref" href="#re:28"><span class="id" title="binder">re</span></a> : <a class="idref" href="Poly.html#2c60282cbb04e070c60ae01e76f3865a"><span class="id" title="notation">[]</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">(</span></a><a class="idref" href="IndProp.html#Star"><span class="id" title="constructor">Star</span></a> <a class="idref" href="IndProp.html#re:28"><span class="id" title="variable">re</span></a><a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a id="MStarApp" class="idref" href="#MStarApp"><span class="id" title="constructor">MStarApp</span></a> <a id="s<sub>1</sub>:29" class="idref" href="#s<sub>1</sub>:29"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="s<sub>2</sub>:30" class="idref" href="#s<sub>2</sub>:30"><span class="id" title="binder">s<sub>2</sub></span></a> <a id="re:31" class="idref" href="#re:31"><span class="id" title="binder">re</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="H<sub>1</sub>:32" class="idref" href="#H<sub>1</sub>:32"><span class="id" title="binder">H<sub>1</sub></span></a> : <a class="idref" href="IndProp.html#s<sub>1</sub>:29"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#re:31"><span class="id" title="variable">re</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="H<sub>2</sub>:33" class="idref" href="#H<sub>2</sub>:33"><span class="id" title="binder">H<sub>2</sub></span></a> : <a class="idref" href="IndProp.html#s<sub>2</sub>:30"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">(</span></a><a class="idref" href="IndProp.html#Star"><span class="id" title="constructor">Star</span></a> <a class="idref" href="IndProp.html#re:31"><span class="id" title="variable">re</span></a><a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">)</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">(</span></a><a class="idref" href="IndProp.html#s<sub>1</sub>:29"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="Poly.html#f03f7a04ef75ff3ac66ca5c23554e52e"><span class="id" title="notation">++</span></a> <a class="idref" href="IndProp.html#s<sub>2</sub>:30"><span class="id" title="variable">s<sub>2</sub></span></a><a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">)</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">(</span></a><a class="idref" href="IndProp.html#Star"><span class="id" title="constructor">Star</span></a> <a class="idref" href="IndProp.html#re:31"><span class="id" title="variable">re</span></a><a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">)</span></a><br/>
<br/>
&nbsp;&nbsp;<span class="id" title="keyword">where</span> <a id="70ea788eca33f3ac1bb7ed2e8169c791" class="idref" href="#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">&quot;</span></a>s =~ re" := (<a class="idref" href="IndProp.html#exp_match:12"><span class="id" title="inductive">exp_match</span></a> <span class="id" title="var">s</span> <span class="id" title="var">re</span>).<br/>
</div>

<div class="doc">
Notice that these rules are not <i>quite</i> the same as the
    intuition that we gave at the beginning of the section.
    First, we don't need to include a rule explicitly stating that no
    string matches <span class="inlinecode"><span class="id" title="var">EmptySet</span></span>; we just don't happen to include any
    rule that would have the effect of some string matching
    <span class="inlinecode"><span class="id" title="var">EmptySet</span></span>.  (Indeed, the syntax of inductive definitions doesn't
    even <i>allow</i> us to give such a "negative rule.")

<div class="paragraph"> </div>

    Second, the intuition we gave for <span class="inlinecode"><span class="id" title="var">Union</span></span> and <span class="inlinecode"><span class="id" title="var">Star</span></span> correspond
    to two constructors each: <span class="inlinecode"><span class="id" title="var">MUnionL</span></span> / <span class="inlinecode"><span class="id" title="var">MUnionR</span></span>, and <span class="inlinecode"><span class="id" title="var">MStar0</span></span> /
    <span class="inlinecode"><span class="id" title="var">MStarApp</span></span>.  The result is logically equivalent to the original
    intuition but more convenient to use in Coq, since the recursive
    occurrences of <span class="inlinecode"><span class="id" title="var">exp_match</span></span> are given as direct arguments to the
    constructors, making it easier to perform induction on evidence.
    (The <span class="inlinecode"><span class="id" title="var">exp_match_ex<sub>1</sub></span></span> and <span class="inlinecode"><span class="id" title="var">exp_match_ex<sub>2</sub></span></span> exercises below ask you
    to prove that the constructors given in the inductive declaration
    and the ones that would arise from a more literal transcription of
    the intuition is indeed equivalent.)

<div class="paragraph"> </div>

    Let's illustrate these rules with a few examples. 
</div>
<div class="code">

<span class="id" title="keyword">Example</span> <a id="reg_exp_ex<sub>1</sub>" class="idref" href="#reg_exp_ex<sub>1</sub>"><span class="id" title="definition">reg_exp_ex<sub>1</sub></span></a> : <a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">[</span></a>1<a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#Char"><span class="id" title="constructor">Char</span></a> 1.<br/>
<div class="togglescript" id="proofcontrol1" onclick="toggleDisplay('proof1');toggleDisplay('proofcontrol1')"><span class="show"></span></div>
<div class="proofscript" id="proof1" onclick="toggleDisplay('proof1');toggleDisplay('proofcontrol1')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="IndProp.html#MChar"><span class="id" title="constructor">MChar</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Example</span> <a id="reg_exp_ex<sub>2</sub>" class="idref" href="#reg_exp_ex<sub>2</sub>"><span class="id" title="definition">reg_exp_ex<sub>2</sub></span></a> : <a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">[</span></a>1<a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">;</span></a> 2<a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#App"><span class="id" title="constructor">App</span></a> (<a class="idref" href="IndProp.html#Char"><span class="id" title="constructor">Char</span></a> 1) (<a class="idref" href="IndProp.html#Char"><span class="id" title="constructor">Char</span></a> 2).<br/>
<div class="togglescript" id="proofcontrol2" onclick="toggleDisplay('proof2');toggleDisplay('proofcontrol2')"><span class="show"></span></div>
<div class="proofscript" id="proof2" onclick="toggleDisplay('proof2');toggleDisplay('proofcontrol2')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="IndProp.html#MApp"><span class="id" title="constructor">MApp</span></a> <a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">[</span></a>1<a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">]</span></a>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="IndProp.html#MChar"><span class="id" title="constructor">MChar</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="IndProp.html#MChar"><span class="id" title="constructor">MChar</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>

<div class="doc">
(Notice how the last example applies <span class="inlinecode"><span class="id" title="var">MApp</span></span> to the string
    <span class="inlinecode">[1]</span> directly.  Since the goal mentions <span class="inlinecode">[1;</span> <span class="inlinecode">2]</span> instead of
    <span class="inlinecode">[1]</span> <span class="inlinecode">++</span> <span class="inlinecode">[2]</span>, Coq wouldn't be able to figure out how to split
    the string on its own.)

<div class="paragraph"> </div>

    Using <span class="inlinecode"><span class="id" title="tactic">inversion</span></span>, we can also show that certain strings do <i>not</i>
    match a regular expression: 
</div>
<div class="code">

<span class="id" title="keyword">Example</span> <a id="reg_exp_ex<sub>3</sub>" class="idref" href="#reg_exp_ex<sub>3</sub>"><span class="id" title="definition">reg_exp_ex<sub>3</sub></span></a> : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">(</span></a><a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">[</span></a>1<a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">;</span></a> 2<a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#Char"><span class="id" title="constructor">Char</span></a> 1<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">)</span></a>.<br/>
<div class="togglescript" id="proofcontrol3" onclick="toggleDisplay('proof3');toggleDisplay('proofcontrol3')"><span class="show"></span></div>
<div class="proofscript" id="proof3" onclick="toggleDisplay('proof3');toggleDisplay('proofcontrol3')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>

<div class="doc">
We can define helper functions for writing down regular
    expressions. The <span class="inlinecode"><span class="id" title="var">reg_exp_of_list</span></span> function constructs a regular
    expression that matches exactly the string that it receives as an
    argument: 
</div>
<div class="code">

<span class="id" title="keyword">Fixpoint</span> <a id="reg_exp_of_list" class="idref" href="#reg_exp_of_list"><span class="id" title="definition">reg_exp_of_list</span></a> {<a id="T:34" class="idref" href="#T:34"><span class="id" title="binder">T</span></a>} (<a id="l:35" class="idref" href="#l:35"><span class="id" title="binder">l</span></a> : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="IndProp.html#T:34"><span class="id" title="variable">T</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="IndProp.html#l:35"><span class="id" title="variable">l</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Poly.html#2c60282cbb04e070c60ae01e76f3865a"><span class="id" title="notation">[]</span></a> ⇒ <a class="idref" href="IndProp.html#EmptyStr"><span class="id" title="constructor">EmptyStr</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">x</span> <a class="idref" href="Poly.html#:::x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">l'</span> ⇒ <a class="idref" href="IndProp.html#App"><span class="id" title="constructor">App</span></a> (<a class="idref" href="IndProp.html#Char"><span class="id" title="constructor">Char</span></a> <span class="id" title="var">x</span>) (<a class="idref" href="IndProp.html#reg_exp_of_list:36"><span class="id" title="definition">reg_exp_of_list</span></a> <span class="id" title="var">l'</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Example</span> <a id="reg_exp_ex<sub>4</sub>" class="idref" href="#reg_exp_ex<sub>4</sub>"><span class="id" title="definition">reg_exp_ex<sub>4</sub></span></a> : <a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">[</span></a>1<a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">;</span></a> 2<a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">;</span></a> 3<a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#reg_exp_of_list"><span class="id" title="definition">reg_exp_of_list</span></a> <a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">[</span></a>1<a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">;</span></a> 2<a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">;</span></a> 3<a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">]</span></a>.<br/>
<div class="togglescript" id="proofcontrol4" onclick="toggleDisplay('proof4');toggleDisplay('proofcontrol4')"><span class="show"></span></div>
<div class="proofscript" id="proof4" onclick="toggleDisplay('proof4');toggleDisplay('proofcontrol4')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> (<a class="idref" href="IndProp.html#MApp"><span class="id" title="constructor">MApp</span></a> <a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">[</span></a>1<a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">]</span></a>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <a class="idref" href="IndProp.html#MChar"><span class="id" title="constructor">MChar</span></a>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="IndProp.html#MApp"><span class="id" title="constructor">MApp</span></a> <a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">[</span></a>2<a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">]</span></a>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <a class="idref" href="IndProp.html#MChar"><span class="id" title="constructor">MChar</span></a>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="IndProp.html#MApp"><span class="id" title="constructor">MApp</span></a> <a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">[</span></a>3<a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">]</span></a>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <a class="idref" href="IndProp.html#MChar"><span class="id" title="constructor">MChar</span></a>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="IndProp.html#MEmpty"><span class="id" title="constructor">MEmpty</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>

<div class="doc">
We can also prove general facts about <span class="inlinecode"><span class="id" title="var">exp_match</span></span>.  For instance,
    the following lemma shows that every string <span class="inlinecode"><span class="id" title="var">s</span></span> that matches <span class="inlinecode"><span class="id" title="var">re</span></span>
    also matches <span class="inlinecode"><span class="id" title="var">Star</span></span> <span class="inlinecode"><span class="id" title="var">re</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="MStar1" class="idref" href="#MStar1"><span class="id" title="lemma">MStar1</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="T:38" class="idref" href="#T:38"><span class="id" title="binder">T</span></a> <a id="s:39" class="idref" href="#s:39"><span class="id" title="binder">s</span></a> (<a id="re:40" class="idref" href="#re:40"><span class="id" title="binder">re</span></a> : <a class="idref" href="IndProp.html#reg_exp"><span class="id" title="inductive">reg_exp</span></a> <a class="idref" href="IndProp.html#T:38"><span class="id" title="variable">T</span></a>) ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="IndProp.html#s:39"><span class="id" title="variable">s</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#re:40"><span class="id" title="variable">re</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="IndProp.html#s:39"><span class="id" title="variable">s</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#Star"><span class="id" title="constructor">Star</span></a> <a class="idref" href="IndProp.html#re:40"><span class="id" title="variable">re</span></a>.<br/>
<div class="togglescript" id="proofcontrol5" onclick="toggleDisplay('proof5');toggleDisplay('proofcontrol5')"><span class="show"></span></div>
<div class="proofscript" id="proof5" onclick="toggleDisplay('proof5');toggleDisplay('proofcontrol5')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">T</span> <span class="id" title="var">s</span> <span class="id" title="var">re</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<a class="idref" href="Poly.html#app_nil_r"><span class="id" title="axiom">app_nil_r</span></a> <span class="id" title="var">_</span> <span class="id" title="var">s</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="IndProp.html#MStarApp"><span class="id" title="constructor">MStarApp</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="IndProp.html#MStar0"><span class="id" title="constructor">MStar0</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>

<div class="doc">
(Note the use of <span class="inlinecode"><span class="id" title="var">app_nil_r</span></span> to change the goal of the theorem to
    exactly the same shape expected by <span class="inlinecode"><span class="id" title="var">MStarApp</span></span>.) 
<div class="paragraph"> </div>

<a id="lab265"></a><h4 class="section">Exercise: 3 stars, standard (exp_match_ex<sub>1</sub>)</h4>
 The following lemmas show that the intuition about matching given
    at the beginning of the chapter can be obtained from the formal
    inductive definition. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="EmptySet_is_empty" class="idref" href="#EmptySet_is_empty"><span class="id" title="lemma">EmptySet_is_empty</span></a> : <span class="id" title="keyword">∀</span> <a id="T:41" class="idref" href="#T:41"><span class="id" title="binder">T</span></a> (<a id="s:42" class="idref" href="#s:42"><span class="id" title="binder">s</span></a> : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="IndProp.html#T:41"><span class="id" title="variable">T</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">(</span></a><a class="idref" href="IndProp.html#s:42"><span class="id" title="variable">s</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#EmptySet"><span class="id" title="constructor">EmptySet</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="MUnion'" class="idref" href="#MUnion'"><span class="id" title="lemma">MUnion'</span></a> : <span class="id" title="keyword">∀</span> <a id="T:43" class="idref" href="#T:43"><span class="id" title="binder">T</span></a> (<a id="s:44" class="idref" href="#s:44"><span class="id" title="binder">s</span></a> : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="IndProp.html#T:43"><span class="id" title="variable">T</span></a>) (<a id="re<sub>1</sub>:45" class="idref" href="#re<sub>1</sub>:45"><span class="id" title="binder">re<sub>1</sub></span></a> <a id="re<sub>2</sub>:46" class="idref" href="#re<sub>2</sub>:46"><span class="id" title="binder">re<sub>2</sub></span></a> : <a class="idref" href="IndProp.html#reg_exp"><span class="id" title="inductive">reg_exp</span></a> <a class="idref" href="IndProp.html#T:43"><span class="id" title="variable">T</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="IndProp.html#s:44"><span class="id" title="variable">s</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#re<sub>1</sub>:45"><span class="id" title="variable">re<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e<sub>25</sub>"><span class="id" title="notation">∨</span></a> <a class="idref" href="IndProp.html#s:44"><span class="id" title="variable">s</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#re<sub>2</sub>:46"><span class="id" title="variable">re<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="IndProp.html#s:44"><span class="id" title="variable">s</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#Union"><span class="id" title="constructor">Union</span></a> <a class="idref" href="IndProp.html#re<sub>1</sub>:45"><span class="id" title="variable">re<sub>1</sub></span></a> <a class="idref" href="IndProp.html#re<sub>2</sub>:46"><span class="id" title="variable">re<sub>2</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
The next lemma is stated in terms of the <span class="inlinecode"><span class="id" title="tactic">fold</span></span> function from the
    <a href="Poly.html"><span class="inlineref">Poly</span></a> chapter: If <span class="inlinecode"><span class="id" title="var">ss</span></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" title="var">list</span></span> <span class="inlinecode">(<span class="id" title="var">list</span></span> <span class="inlinecode"><span class="id" title="var">T</span>)</span> represents a sequence of
    strings <span class="inlinecode"><span class="id" title="var">s<sub>1</sub></span>,</span> <span class="inlinecode">...,</span> <span class="inlinecode"><span class="id" title="var">sn</span></span>, then <span class="inlinecode"><span class="id" title="tactic">fold</span></span> <span class="inlinecode"><span class="id" title="var">app</span></span> <span class="inlinecode"><span class="id" title="var">ss</span></span> <span class="inlinecode">[]</span> is the result of
    concatenating them all together. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="MStar'" class="idref" href="#MStar'"><span class="id" title="lemma">MStar'</span></a> : <span class="id" title="keyword">∀</span> <a id="T:47" class="idref" href="#T:47"><span class="id" title="binder">T</span></a> (<a id="ss:48" class="idref" href="#ss:48"><span class="id" title="binder">ss</span></a> : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="IndProp.html#T:47"><span class="id" title="variable">T</span></a>)) (<a id="re:49" class="idref" href="#re:49"><span class="id" title="binder">re</span></a> : <a class="idref" href="IndProp.html#reg_exp"><span class="id" title="inductive">reg_exp</span></a> <a class="idref" href="IndProp.html#T:47"><span class="id" title="variable">T</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="s:50" class="idref" href="#s:50"><span class="id" title="binder">s</span></a>, <a class="idref" href="Logic.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="IndProp.html#s:50"><span class="id" title="variable">s</span></a> <a class="idref" href="IndProp.html#ss:48"><span class="id" title="variable">ss</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="IndProp.html#s:50"><span class="id" title="variable">s</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#re:49"><span class="id" title="variable">re</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Poly.html#fold"><span class="id" title="definition">fold</span></a> <a class="idref" href="Poly.html#app"><span class="id" title="definition">app</span></a> <a class="idref" href="IndProp.html#ss:48"><span class="id" title="variable">ss</span></a> <a class="idref" href="Poly.html#2c60282cbb04e070c60ae01e76f3865a"><span class="id" title="notation">[]</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#Star"><span class="id" title="constructor">Star</span></a> <a class="idref" href="IndProp.html#re:49"><span class="id" title="variable">re</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a id="lab266"></a><h4 class="section">Exercise: 2 stars, standard, optional (EmptyStr_not_needed)</h4>

</div>
<div class="code">
<span class="comment">(*&nbsp;It&nbsp;turns&nbsp;out&nbsp;that&nbsp;the&nbsp;<span class="inlinecode"><span class="id" title="var">EmptyStr</span></span>&nbsp;constructor&nbsp;is&nbsp;actually&nbsp;not<br/>
&nbsp;&nbsp;&nbsp;needed,&nbsp;since&nbsp;the&nbsp;regular&nbsp;expression&nbsp;matching&nbsp;the&nbsp;empty&nbsp;string&nbsp;can<br/>
&nbsp;&nbsp;&nbsp;also&nbsp;be&nbsp;defined&nbsp;from&nbsp;<span class="inlinecode"><span class="id" title="var">Star</span></span>&nbsp;and&nbsp;<span class="inlinecode"><span class="id" title="var">EmptySet</span></span>:&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a id="EmptyStr'" class="idref" href="#EmptyStr'"><span class="id" title="definition">EmptyStr'</span></a> {<a id="T:51" class="idref" href="#T:51"><span class="id" title="binder">T</span></a>:<span class="id" title="keyword">Type</span>} := @<a class="idref" href="IndProp.html#Star"><span class="id" title="constructor">Star</span></a> <a class="idref" href="IndProp.html#T:51"><span class="id" title="variable">T</span></a> (<a class="idref" href="IndProp.html#EmptySet"><span class="id" title="constructor">EmptySet</span></a>).<br/><hr class='doublespaceincode'/>
<span class="comment">(*&nbsp;State&nbsp;and&nbsp;prove&nbsp;that&nbsp;this&nbsp;<span class="inlinecode"><span class="id" title="var">EmptyStr'</span></span>&nbsp;definition&nbsp;matches&nbsp;exactly<br/>
&nbsp;&nbsp;&nbsp;the&nbsp;same&nbsp;strings&nbsp;as&nbsp;the&nbsp;<span class="inlinecode"><span class="id" title="var">EmptyStr</span></span>&nbsp;constructor.&nbsp;*)</span><br/><hr class='doublespaceincode'/>
<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span><br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

 Since the definition of <span class="inlinecode"><span class="id" title="var">exp_match</span></span> has a recursive
    structure, we might expect that proofs involving regular
    expressions will often require induction on evidence. 
<div class="paragraph"> </div>

 For example, suppose we want to prove the following intuitive
    result: If a regular expression <span class="inlinecode"><span class="id" title="var">re</span></span> matches some string <span class="inlinecode"><span class="id" title="var">s</span></span>, then
    all elements of <span class="inlinecode"><span class="id" title="var">s</span></span> must occur as character literals somewhere in
    <span class="inlinecode"><span class="id" title="var">re</span></span>.

<div class="paragraph"> </div>

    To state this as a theorem, we first define a function <span class="inlinecode"><span class="id" title="var">re_chars</span></span>
    that lists all characters that occur in a regular expression: 
</div>
<div class="code">

<span class="id" title="keyword">Fixpoint</span> <a id="re_chars" class="idref" href="#re_chars"><span class="id" title="definition">re_chars</span></a> {<a id="T:52" class="idref" href="#T:52"><span class="id" title="binder">T</span></a>} (<a id="re:53" class="idref" href="#re:53"><span class="id" title="binder">re</span></a> : <a class="idref" href="IndProp.html#reg_exp"><span class="id" title="inductive">reg_exp</span></a> <a class="idref" href="IndProp.html#T:52"><span class="id" title="variable">T</span></a>) : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="IndProp.html#T:52"><span class="id" title="variable">T</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="IndProp.html#re:53"><span class="id" title="variable">re</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="IndProp.html#EmptySet"><span class="id" title="constructor">EmptySet</span></a> ⇒ <a class="idref" href="Poly.html#2c60282cbb04e070c60ae01e76f3865a"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="IndProp.html#EmptyStr"><span class="id" title="constructor">EmptyStr</span></a> ⇒ <a class="idref" href="Poly.html#2c60282cbb04e070c60ae01e76f3865a"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="IndProp.html#Char"><span class="id" title="constructor">Char</span></a> <span class="id" title="var">x</span> ⇒ <a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">[</span></a><span class="id" title="var">x</span><a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="IndProp.html#App"><span class="id" title="constructor">App</span></a> <span class="id" title="var">re<sub>1</sub></span> <span class="id" title="var">re<sub>2</sub></span> ⇒ <a class="idref" href="IndProp.html#re_chars:54"><span class="id" title="definition">re_chars</span></a> <span class="id" title="var">re<sub>1</sub></span> <a class="idref" href="Poly.html#f03f7a04ef75ff3ac66ca5c23554e52e"><span class="id" title="notation">++</span></a> <a class="idref" href="IndProp.html#re_chars:54"><span class="id" title="definition">re_chars</span></a> <span class="id" title="var">re<sub>2</sub></span><br/>
&nbsp;&nbsp;| <a class="idref" href="IndProp.html#Union"><span class="id" title="constructor">Union</span></a> <span class="id" title="var">re<sub>1</sub></span> <span class="id" title="var">re<sub>2</sub></span> ⇒ <a class="idref" href="IndProp.html#re_chars:54"><span class="id" title="definition">re_chars</span></a> <span class="id" title="var">re<sub>1</sub></span> <a class="idref" href="Poly.html#f03f7a04ef75ff3ac66ca5c23554e52e"><span class="id" title="notation">++</span></a> <a class="idref" href="IndProp.html#re_chars:54"><span class="id" title="definition">re_chars</span></a> <span class="id" title="var">re<sub>2</sub></span><br/>
&nbsp;&nbsp;| <a class="idref" href="IndProp.html#Star"><span class="id" title="constructor">Star</span></a> <span class="id" title="var">re</span> ⇒ <a class="idref" href="IndProp.html#re_chars:54"><span class="id" title="definition">re_chars</span></a> <a class="idref" href="IndProp.html#re:53"><span class="id" title="variable">re</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
</div>

<div class="doc">
The main theorem: 
</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <a id="in_re_match" class="idref" href="#in_re_match"><span class="id" title="lemma">in_re_match</span></a> : <span class="id" title="keyword">∀</span> <a id="T:56" class="idref" href="#T:56"><span class="id" title="binder">T</span></a> (<a id="s:57" class="idref" href="#s:57"><span class="id" title="binder">s</span></a> : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="IndProp.html#T:56"><span class="id" title="variable">T</span></a>) (<a id="re:58" class="idref" href="#re:58"><span class="id" title="binder">re</span></a> : <a class="idref" href="IndProp.html#reg_exp"><span class="id" title="inductive">reg_exp</span></a> <a class="idref" href="IndProp.html#T:56"><span class="id" title="variable">T</span></a>) (<a id="x:59" class="idref" href="#x:59"><span class="id" title="binder">x</span></a> : <a class="idref" href="IndProp.html#T:56"><span class="id" title="variable">T</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="IndProp.html#s:57"><span class="id" title="variable">s</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#re:58"><span class="id" title="variable">re</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Logic.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="IndProp.html#x:59"><span class="id" title="variable">x</span></a> <a class="idref" href="IndProp.html#s:57"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Logic.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="IndProp.html#x:59"><span class="id" title="variable">x</span></a> (<a class="idref" href="IndProp.html#re_chars"><span class="id" title="definition">re_chars</span></a> <a class="idref" href="IndProp.html#re:58"><span class="id" title="variable">re</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">T</span> <span class="id" title="var">s</span> <span class="id" title="var">re</span> <span class="id" title="var">x</span> <span class="id" title="var">Hmatch</span> <span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Hmatch</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> [| <span class="id" title="var">x'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">re<sub>1</sub></span> <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">re<sub>2</sub></span> <span class="id" title="var">Hmatch1</span> <span class="id" title="var">IH<sub>1</sub></span> <span class="id" title="var">Hmatch2</span> <span class="id" title="var">IH<sub>2</sub></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">re<sub>1</sub></span> <span class="id" title="var">re<sub>2</sub></span> <span class="id" title="var">Hmatch</span> <span class="id" title="var">IH</span> | <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">re<sub>1</sub></span> <span class="id" title="var">re<sub>2</sub></span> <span class="id" title="var">Hmatch</span> <span class="id" title="var">IH</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">re</span> | <span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">re</span> <span class="id" title="var">Hmatch1</span> <span class="id" title="var">IH<sub>1</sub></span> <span class="id" title="var">Hmatch2</span> <span class="id" title="var">IH<sub>2</sub></span>].<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;WORKED&nbsp;IN&nbsp;CLASS&nbsp;*)</span><br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MEmpty&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="keyword">in</span> <span class="id" title="var">Hin</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MChar&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="keyword">in</span> <span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MApp&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
</div>

<div class="doc">
Something interesting happens in the <span class="inlinecode"><span class="id" title="var">MApp</span></span> case.  We obtain
    <i>two</i> induction hypotheses: One that applies when <span class="inlinecode"><span class="id" title="var">x</span></span> occurs in
    <span class="inlinecode"><span class="id" title="var">s<sub>1</sub></span></span> (which matches <span class="inlinecode"><span class="id" title="var">re<sub>1</sub></span></span>), and a second one that applies when <span class="inlinecode"><span class="id" title="var">x</span></span>
    occurs in <span class="inlinecode"><span class="id" title="var">s<sub>2</sub></span></span> (which matches <span class="inlinecode"><span class="id" title="var">re<sub>2</sub></span></span>). 
</div>
<div class="code">

&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="Logic.html#In_app_iff"><span class="id" title="axiom">In_app_iff</span></a> <span class="id" title="keyword">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hin</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hin</span> | <span class="id" title="var">Hin</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;In&nbsp;x&nbsp;s<sub>1</sub>&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">left</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">IH<sub>1</sub></span> <span class="id" title="var">Hin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;In&nbsp;x&nbsp;s<sub>2</sub>&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">right</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">IH<sub>2</sub></span> <span class="id" title="var">Hin</span>).<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MUnionL&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="Logic.html#In_app_iff"><span class="id" title="axiom">In_app_iff</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">left</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">IH</span> <span class="id" title="var">Hin</span>).<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MUnionR&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="Logic.html#In_app_iff"><span class="id" title="axiom">In_app_iff</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">right</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">IH</span> <span class="id" title="var">Hin</span>).<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MStar0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MStarApp&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
</div>

<div class="doc">
Here again we get two induction hypotheses, and they illustrate
    why we need induction on evidence for <span class="inlinecode"><span class="id" title="var">exp_match</span></span>, rather than
    induction on the regular expression <span class="inlinecode"><span class="id" title="var">re</span></span>: The latter would only
    provide an induction hypothesis for strings that match <span class="inlinecode"><span class="id" title="var">re</span></span>, which
    would not allow us to reason about the case <span class="inlinecode"><span class="id" title="var">In</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">s<sub>2</sub></span></span>. 
</div>
<div class="code">

&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="Logic.html#In_app_iff"><span class="id" title="axiom">In_app_iff</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hin</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hin</span> | <span class="id" title="var">Hin</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;In&nbsp;x&nbsp;s<sub>1</sub>&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">IH<sub>1</sub></span> <span class="id" title="var">Hin</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;In&nbsp;x&nbsp;s<sub>2</sub>&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">IH<sub>2</sub></span> <span class="id" title="var">Hin</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab267"></a><h4 class="section">Exercise: 4 stars, standard, optional (re_not_empty)</h4>
 Write a recursive function <span class="inlinecode"><span class="id" title="var">re_not_empty</span></span> that tests whether a
    regular expression matches some string. Prove that your function
    is correct. 
</div>
<div class="code">

<span class="id" title="keyword">Fixpoint</span> <a id="re_not_empty" class="idref" href="#re_not_empty"><span class="id" title="definition">re_not_empty</span></a> {<a id="T:60" class="idref" href="#T:60"><span class="id" title="binder">T</span></a> : <span class="id" title="keyword">Type</span>} (<a id="re:61" class="idref" href="#re:61"><span class="id" title="binder">re</span></a> : <a class="idref" href="IndProp.html#reg_exp"><span class="id" title="inductive">reg_exp</span></a> <a class="idref" href="IndProp.html#T:60"><span class="id" title="variable">T</span></a>) : <a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;REPLACE&nbsp;THIS&nbsp;LINE&nbsp;WITH&nbsp;":=&nbsp;_your_definition_&nbsp;."&nbsp;*)</span>. <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="re_not_empty_correct" class="idref" href="#re_not_empty_correct"><span class="id" title="lemma">re_not_empty_correct</span></a> : <span class="id" title="keyword">∀</span> <a id="T:63" class="idref" href="#T:63"><span class="id" title="binder">T</span></a> (<a id="re:64" class="idref" href="#re:64"><span class="id" title="binder">re</span></a> : <a class="idref" href="IndProp.html#reg_exp"><span class="id" title="inductive">reg_exp</span></a> <a class="idref" href="IndProp.html#T:63"><span class="id" title="variable">T</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="s:65" class="idref" href="#s:65"><span class="id" title="binder">s</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="IndProp.html#s:65"><span class="id" title="variable">s</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#re:64"><span class="id" title="variable">re</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">↔</span></a> <a class="idref" href="IndProp.html#re_not_empty"><span class="id" title="axiom">re_not_empty</span></a> <a class="idref" href="IndProp.html#re:64"><span class="id" title="variable">re</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a id="lab268"></a><h2 class="section">The <span class="inlinecode"><span class="id" title="var">remember</span></span> Tactic</h2>

<div class="paragraph"> </div>

 One potentially confusing feature of the <span class="inlinecode"><span class="id" title="tactic">induction</span></span> tactic is
    that it will let you try to perform an induction over a term that
    isn't sufficiently general.  The effect of this is to lose
    information (much as <span class="inlinecode"><span class="id" title="tactic">destruct</span></span> without an <span class="inlinecode"><span class="id" title="var">eqn</span>:</span> clause can do),
    and leave you unable to complete the proof.  Here's an example: 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="star_app" class="idref" href="#star_app"><span class="id" title="lemma">star_app</span></a>: <span class="id" title="keyword">∀</span> <a id="T:66" class="idref" href="#T:66"><span class="id" title="binder">T</span></a> (<a id="s<sub>1</sub>:67" class="idref" href="#s<sub>1</sub>:67"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="s<sub>2</sub>:68" class="idref" href="#s<sub>2</sub>:68"><span class="id" title="binder">s<sub>2</sub></span></a> : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="IndProp.html#T:66"><span class="id" title="variable">T</span></a>) (<a id="re:69" class="idref" href="#re:69"><span class="id" title="binder">re</span></a> : <a class="idref" href="IndProp.html#reg_exp"><span class="id" title="inductive">reg_exp</span></a> <a class="idref" href="IndProp.html#T:66"><span class="id" title="variable">T</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="IndProp.html#s<sub>1</sub>:67"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#Star"><span class="id" title="constructor">Star</span></a> <a class="idref" href="IndProp.html#re:69"><span class="id" title="variable">re</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="IndProp.html#s<sub>2</sub>:68"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#Star"><span class="id" title="constructor">Star</span></a> <a class="idref" href="IndProp.html#re:69"><span class="id" title="variable">re</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="IndProp.html#s<sub>1</sub>:67"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="Poly.html#f03f7a04ef75ff3ac66ca5c23554e52e"><span class="id" title="notation">++</span></a> <a class="idref" href="IndProp.html#s<sub>2</sub>:68"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#Star"><span class="id" title="constructor">Star</span></a> <a class="idref" href="IndProp.html#re:69"><span class="id" title="variable">re</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">T</span> <span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">re</span> <span class="id" title="var">H<sub>1</sub></span>.<br/>
</div>

<div class="doc">
Now, just doing an <span class="inlinecode"><span class="id" title="tactic">inversion</span></span> on <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> won't get us very far in
    the recursive cases. (Try it!). So we need induction (on
    evidence!). Here is a naive first attempt.  (We can begin by generalizing <span class="inlinecode"><span class="id" title="var">s<sub>2</sub></span></span>, since it's pretty clear that we
    are going to have to walk over both <span class="inlinecode"><span class="id" title="var">s<sub>1</sub></span></span> and <span class="inlinecode"><span class="id" title="var">s<sub>2</sub></span></span> in parallel.) 
</div>
<div class="code">

&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">s<sub>2</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">H<sub>1</sub></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> [|<span class="id" title="var">x'</span>|<span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">re<sub>1</sub></span> <span class="id" title="var">s<sub>2</sub>'</span> <span class="id" title="var">re<sub>2</sub></span> <span class="id" title="var">Hmatch1</span> <span class="id" title="var">IH<sub>1</sub></span> <span class="id" title="var">Hmatch2</span> <span class="id" title="var">IH<sub>2</sub></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">re<sub>1</sub></span> <span class="id" title="var">re<sub>2</sub></span> <span class="id" title="var">Hmatch</span> <span class="id" title="var">IH</span>|<span class="id" title="var">re<sub>1</sub></span> <span class="id" title="var">s<sub>2</sub>'</span> <span class="id" title="var">re<sub>2</sub></span> <span class="id" title="var">Hmatch</span> <span class="id" title="var">IH</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">re''</span>|<span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">s<sub>2</sub>'</span> <span class="id" title="var">re''</span> <span class="id" title="var">Hmatch1</span> <span class="id" title="var">IH<sub>1</sub></span> <span class="id" title="var">Hmatch2</span> <span class="id" title="var">IH<sub>2</sub></span>].<br/>
</div>

<div class="doc">
But now, although we get seven cases (as we would expect
    from the definition of <span class="inlinecode"><span class="id" title="var">exp_match</span></span>), we have lost a very important
    bit of information from <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span>: the fact that <span class="inlinecode"><span class="id" title="var">s<sub>1</sub></span></span> matched something
    of the form <span class="inlinecode"><span class="id" title="var">Star</span></span> <span class="inlinecode"><span class="id" title="var">re</span></span>.  This means that we have to give proofs for
    <i>all</i> seven constructors of this definition, even though all but
    two of them (<span class="inlinecode"><span class="id" title="var">MStar0</span></span> and <span class="inlinecode"><span class="id" title="var">MStarApp</span></span>) are contradictory.  We can
    still get the proof to go through for a few constructors, such as
    <span class="inlinecode"><span class="id" title="var">MEmpty</span></span>... 
</div>
<div class="code">

&nbsp;&nbsp;- <span class="comment">(*&nbsp;MEmpty&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
</div>

<div class="doc">
... but most cases get stuck.  For <span class="inlinecode"><span class="id" title="var">MChar</span></span>, for instance, we
    must show
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">s<sub>2</sub></span>     =~ <span class="id" title="var">Char</span> <span class="id" title="var">x'</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">x'</span>::<span class="id" title="var">s<sub>2</sub></span> =~ <span class="id" title="var">Char</span> <span class="id" title="var">x'</span>
</span>    which is clearly impossible. 
</div>
<div class="code">

&nbsp;&nbsp;- <span class="comment">(*&nbsp;MChar.&nbsp;*)</span> <span class="id" title="tactic">intros</span> <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">H</span>. <span class="id" title="tactic">simpl</span>. <span class="comment">(*&nbsp;Stuck...&nbsp;*)</span><br/>
<span class="id" title="keyword">Abort</span>.<br/>
</div>

<div class="doc">
The problem here is that <span class="inlinecode"><span class="id" title="tactic">induction</span></span> over a Prop hypothesis
    only works properly with hypotheses that are "completely
    general," i.e., ones in which all the arguments are variables,
    as opposed to more complex expressions like <span class="inlinecode"><span class="id" title="var">Star</span></span> <span class="inlinecode"><span class="id" title="var">re</span></span>.

<div class="paragraph"> </div>

    (In this respect, <span class="inlinecode"><span class="id" title="tactic">induction</span></span> on evidence behaves more like
    <span class="inlinecode"><span class="id" title="tactic">destruct</span></span>-without-<span class="inlinecode"><span class="id" title="var">eqn</span>:</span> than like <span class="inlinecode"><span class="id" title="tactic">inversion</span></span>.)

<div class="paragraph"> </div>

    A possible, but awkward, way to solve this problem is "manually
    generalizing" over the problematic expressions by adding
    explicit equality hypotheses to the lemma: 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="star_app" class="idref" href="#star_app"><span class="id" title="lemma">star_app</span></a>: <span class="id" title="keyword">∀</span> <a id="T:70" class="idref" href="#T:70"><span class="id" title="binder">T</span></a> (<a id="s<sub>1</sub>:71" class="idref" href="#s<sub>1</sub>:71"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="s<sub>2</sub>:72" class="idref" href="#s<sub>2</sub>:72"><span class="id" title="binder">s<sub>2</sub></span></a> : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="IndProp.html#T:70"><span class="id" title="variable">T</span></a>) (<a id="re:73" class="idref" href="#re:73"><span class="id" title="binder">re</span></a> <a id="re':74" class="idref" href="#re':74"><span class="id" title="binder">re'</span></a> : <a class="idref" href="IndProp.html#reg_exp"><span class="id" title="inductive">reg_exp</span></a> <a class="idref" href="IndProp.html#T:70"><span class="id" title="variable">T</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="IndProp.html#re':74"><span class="id" title="variable">re'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="IndProp.html#Star"><span class="id" title="constructor">Star</span></a> <a class="idref" href="IndProp.html#re:73"><span class="id" title="variable">re</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="IndProp.html#s<sub>1</sub>:71"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#re':74"><span class="id" title="variable">re'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="IndProp.html#s<sub>2</sub>:72"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#Star"><span class="id" title="constructor">Star</span></a> <a class="idref" href="IndProp.html#re:73"><span class="id" title="variable">re</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="IndProp.html#s<sub>1</sub>:71"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="Poly.html#f03f7a04ef75ff3ac66ca5c23554e52e"><span class="id" title="notation">++</span></a> <a class="idref" href="IndProp.html#s<sub>2</sub>:72"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#Star"><span class="id" title="constructor">Star</span></a> <a class="idref" href="IndProp.html#re:73"><span class="id" title="variable">re</span></a>.<br/>
</div>

<div class="doc">
We can now proceed by performing induction over evidence
    directly, because the argument to the first hypothesis is
    sufficiently general, which means that we can discharge most cases
    by inverting the <span class="inlinecode"><span class="id" title="var">re'</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">Star</span></span> <span class="inlinecode"><span class="id" title="var">re</span></span> equality in the context.  This works, but it makes the statement of the lemma a bit ugly.
    Fortunately, there is a better way... 
</div>
<div class="code">
<span class="id" title="keyword">Abort</span>.<br/>
</div>

<div class="doc">
The tactic <span class="inlinecode"><span class="id" title="var">remember</span></span> <span class="inlinecode"><span class="id" title="var">e</span></span> <span class="inlinecode"><span class="id" title="keyword">as</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">eqn</span>:<span class="id" title="var">Eq</span></span> causes Coq to (1) replace all
    occurrences of the expression <span class="inlinecode"><span class="id" title="var">e</span></span> by the variable <span class="inlinecode"><span class="id" title="var">x</span></span>, and (2) add
    an equation <span class="inlinecode"><span class="id" title="var">Eq</span></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">e</span></span> to the context.  Here's how we can use it
    to show the above result: 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="star_app" class="idref" href="#star_app"><span class="id" title="lemma">star_app</span></a>: <span class="id" title="keyword">∀</span> <a id="T:75" class="idref" href="#T:75"><span class="id" title="binder">T</span></a> (<a id="s<sub>1</sub>:76" class="idref" href="#s<sub>1</sub>:76"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="s<sub>2</sub>:77" class="idref" href="#s<sub>2</sub>:77"><span class="id" title="binder">s<sub>2</sub></span></a> : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="IndProp.html#T:75"><span class="id" title="variable">T</span></a>) (<a id="re:78" class="idref" href="#re:78"><span class="id" title="binder">re</span></a> : <a class="idref" href="IndProp.html#reg_exp"><span class="id" title="inductive">reg_exp</span></a> <a class="idref" href="IndProp.html#T:75"><span class="id" title="variable">T</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="IndProp.html#s<sub>1</sub>:76"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#Star"><span class="id" title="constructor">Star</span></a> <a class="idref" href="IndProp.html#re:78"><span class="id" title="variable">re</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="IndProp.html#s<sub>2</sub>:77"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#Star"><span class="id" title="constructor">Star</span></a> <a class="idref" href="IndProp.html#re:78"><span class="id" title="variable">re</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="IndProp.html#s<sub>1</sub>:76"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="Poly.html#f03f7a04ef75ff3ac66ca5c23554e52e"><span class="id" title="notation">++</span></a> <a class="idref" href="IndProp.html#s<sub>2</sub>:77"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#Star"><span class="id" title="constructor">Star</span></a> <a class="idref" href="IndProp.html#re:78"><span class="id" title="variable">re</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">T</span> <span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">re</span> <span class="id" title="var">H<sub>1</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="IndProp.html#Star"><span class="id" title="constructor">Star</span></a> <span class="id" title="var">re</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">re'</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Eq</span>.<br/>
</div>

<div class="doc">
We now have <span class="inlinecode"><span class="id" title="var">Eq</span></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" title="var">re'</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">Star</span></span> <span class="inlinecode"><span class="id" title="var">re</span></span>. 
</div>
<div class="code">

&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">s<sub>2</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">H<sub>1</sub></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> [|<span class="id" title="var">x'</span>|<span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">re<sub>1</sub></span> <span class="id" title="var">s<sub>2</sub>'</span> <span class="id" title="var">re<sub>2</sub></span> <span class="id" title="var">Hmatch1</span> <span class="id" title="var">IH<sub>1</sub></span> <span class="id" title="var">Hmatch2</span> <span class="id" title="var">IH<sub>2</sub></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">re<sub>1</sub></span> <span class="id" title="var">re<sub>2</sub></span> <span class="id" title="var">Hmatch</span> <span class="id" title="var">IH</span>|<span class="id" title="var">re<sub>1</sub></span> <span class="id" title="var">s<sub>2</sub>'</span> <span class="id" title="var">re<sub>2</sub></span> <span class="id" title="var">Hmatch</span> <span class="id" title="var">IH</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">re''</span>|<span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">s<sub>2</sub>'</span> <span class="id" title="var">re''</span> <span class="id" title="var">Hmatch1</span> <span class="id" title="var">IH<sub>1</sub></span> <span class="id" title="var">Hmatch2</span> <span class="id" title="var">IH<sub>2</sub></span>].<br/>
</div>

<div class="doc">
The <span class="inlinecode"><span class="id" title="var">Eq</span></span> is contradictory in most cases, allowing us to
    conclude immediately. 
</div>
<div class="code">

&nbsp;&nbsp;- <span class="comment">(*&nbsp;MEmpty&nbsp;*)</span>  <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MChar&nbsp;*)</span>   <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MApp&nbsp;*)</span>    <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MUnionL&nbsp;*)</span> <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MUnionR&nbsp;*)</span> <span class="id" title="tactic">discriminate</span>.<br/>
</div>

<div class="doc">
The interesting cases are those that correspond to <span class="inlinecode"><span class="id" title="var">Star</span></span>. 
</div>
<div class="code">

&nbsp;&nbsp;- <span class="comment">(*&nbsp;MStar0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">s</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MStarApp&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">injection</span> <span class="id" title="var">Eq</span> <span class="id" title="keyword">as</span> <span class="id" title="var">Eq'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">H<sub>1</sub></span>. <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="Poly.html#app_assoc"><span class="id" title="axiom">app_assoc</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="IndProp.html#MStarApp"><span class="id" title="constructor">MStarApp</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">Hmatch1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">IH<sub>2</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Eq'</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">apply</span> <span class="id" title="var">H<sub>1</sub></span>.<br/>
</div>

<div class="doc">
Note that the induction hypothesis <span class="inlinecode"><span class="id" title="var">IH<sub>2</sub></span></span> on the <span class="inlinecode"><span class="id" title="var">MStarApp</span></span> case
    mentions an additional premise <span class="inlinecode"><span class="id" title="var">Star</span></span> <span class="inlinecode"><span class="id" title="var">re''</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">Star</span></span> <span class="inlinecode"><span class="id" title="var">re</span></span>, which
    results from the equality generated by <span class="inlinecode"><span class="id" title="var">remember</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab269"></a><h4 class="section">Exercise: 4 stars, standard (exp_match_ex<sub>2</sub>)</h4>

<div class="paragraph"> </div>

 The <span class="inlinecode"><span class="id" title="var">MStar''</span></span> lemma below (combined with its converse, the
    <span class="inlinecode"><span class="id" title="var">MStar'</span></span> exercise above), shows that our definition of <span class="inlinecode"><span class="id" title="var">exp_match</span></span>
    for <span class="inlinecode"><span class="id" title="var">Star</span></span> is equivalent to the informal one given previously. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="MStar''" class="idref" href="#MStar''"><span class="id" title="lemma">MStar''</span></a> : <span class="id" title="keyword">∀</span> <a id="T:79" class="idref" href="#T:79"><span class="id" title="binder">T</span></a> (<a id="s:80" class="idref" href="#s:80"><span class="id" title="binder">s</span></a> : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="IndProp.html#T:79"><span class="id" title="variable">T</span></a>) (<a id="re:81" class="idref" href="#re:81"><span class="id" title="binder">re</span></a> : <a class="idref" href="IndProp.html#reg_exp"><span class="id" title="inductive">reg_exp</span></a> <a class="idref" href="IndProp.html#T:79"><span class="id" title="variable">T</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="IndProp.html#s:80"><span class="id" title="variable">s</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#Star"><span class="id" title="constructor">Star</span></a> <a class="idref" href="IndProp.html#re:81"><span class="id" title="variable">re</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="ss:82" class="idref" href="#ss:82"><span class="id" title="binder">ss</span></a> : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="IndProp.html#T:79"><span class="id" title="variable">T</span></a>)<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="IndProp.html#s:80"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#fold"><span class="id" title="definition">fold</span></a> <a class="idref" href="Poly.html#app"><span class="id" title="definition">app</span></a> <a class="idref" href="IndProp.html#ss:82"><span class="id" title="variable">ss</span></a> <a class="idref" href="Poly.html#2c60282cbb04e070c60ae01e76f3865a"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <span class="id" title="keyword">∀</span> <a id="s':83" class="idref" href="#s':83"><span class="id" title="binder">s'</span></a>, <a class="idref" href="Logic.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="IndProp.html#s':83"><span class="id" title="variable">s'</span></a> <a class="idref" href="IndProp.html#ss:82"><span class="id" title="variable">ss</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="IndProp.html#s':83"><span class="id" title="variable">s'</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#re:81"><span class="id" title="variable">re</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a id="lab270"></a><h4 class="section">Exercise: 5 stars, advanced, optional (weak_pumping)</h4>
 One of the first really interesting theorems in the theory of
    regular expressions is the so-called <i>pumping lemma</i>, which
    states, informally, that any sufficiently long string <span class="inlinecode"><span class="id" title="var">s</span></span> matching
    a regular expression <span class="inlinecode"><span class="id" title="var">re</span></span> can be "pumped" by repeating some middle
    section of <span class="inlinecode"><span class="id" title="var">s</span></span> an arbitrary number of times to produce a new
    string also matching <span class="inlinecode"><span class="id" title="var">re</span></span>.  (For the sake of simplicity in this
    exercise, we consider a slightly weaker theorem than is usually
    stated in courses on automata theory -- hence the name
    <span class="inlinecode"><span class="id" title="var">weak_pumping</span></span>.)

<div class="paragraph"> </div>

    To get started, we need to define "sufficiently long."  Since we
    are working in a constructive logic, we actually need to be able
    to calculate, for each regular expression <span class="inlinecode"><span class="id" title="var">re</span></span>, the minimum length
    for strings <span class="inlinecode"><span class="id" title="var">s</span></span> to guarantee "pumpability." 
</div>
<div class="code">

<span class="id" title="keyword">Module</span> <a id="Pumping" class="idref" href="#Pumping"><span class="id" title="module">Pumping</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Fixpoint</span> <a id="Pumping.pumping_constant" class="idref" href="#Pumping.pumping_constant"><span class="id" title="definition">pumping_constant</span></a> {<a id="T:84" class="idref" href="#T:84"><span class="id" title="binder">T</span></a>} (<a id="re:85" class="idref" href="#re:85"><span class="id" title="binder">re</span></a> : <a class="idref" href="IndProp.html#reg_exp"><span class="id" title="inductive">reg_exp</span></a> <a class="idref" href="IndProp.html#T:84"><span class="id" title="variable">T</span></a>) : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="IndProp.html#re:85"><span class="id" title="variable">re</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="IndProp.html#EmptySet"><span class="id" title="constructor">EmptySet</span></a> ⇒ 1<br/>
&nbsp;&nbsp;| <a class="idref" href="IndProp.html#EmptyStr"><span class="id" title="constructor">EmptyStr</span></a> ⇒ 1<br/>
&nbsp;&nbsp;| <a class="idref" href="IndProp.html#Char"><span class="id" title="constructor">Char</span></a> <span class="id" title="var">_</span> ⇒ 2<br/>
&nbsp;&nbsp;| <a class="idref" href="IndProp.html#App"><span class="id" title="constructor">App</span></a> <span class="id" title="var">re<sub>1</sub></span> <span class="id" title="var">re<sub>2</sub></span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="IndProp.html#pumping_constant:86"><span class="id" title="definition">pumping_constant</span></a> <span class="id" title="var">re<sub>1</sub></span> <a class="idref" href="Basics.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="IndProp.html#pumping_constant:86"><span class="id" title="definition">pumping_constant</span></a> <span class="id" title="var">re<sub>2</sub></span><br/>
&nbsp;&nbsp;| <a class="idref" href="IndProp.html#Union"><span class="id" title="constructor">Union</span></a> <span class="id" title="var">re<sub>1</sub></span> <span class="id" title="var">re<sub>2</sub></span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="IndProp.html#pumping_constant:86"><span class="id" title="definition">pumping_constant</span></a> <span class="id" title="var">re<sub>1</sub></span> <a class="idref" href="Basics.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="IndProp.html#pumping_constant:86"><span class="id" title="definition">pumping_constant</span></a> <span class="id" title="var">re<sub>2</sub></span><br/>
&nbsp;&nbsp;| <a class="idref" href="IndProp.html#Star"><span class="id" title="constructor">Star</span></a> <span class="id" title="var">r</span> ⇒ <a class="idref" href="IndProp.html#pumping_constant:86"><span class="id" title="definition">pumping_constant</span></a> <span class="id" title="var">r</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
</div>

<div class="doc">
You may find these lemmas about the pumping constant useful when
    proving the pumping lemma below. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Pumping.pumping_constant_ge_1" class="idref" href="#Pumping.pumping_constant_ge_1"><span class="id" title="lemma">pumping_constant_ge_1</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="T:88" class="idref" href="#T:88"><span class="id" title="binder">T</span></a> (<a id="re:89" class="idref" href="#re:89"><span class="id" title="binder">re</span></a> : <a class="idref" href="IndProp.html#reg_exp"><span class="id" title="inductive">reg_exp</span></a> <a class="idref" href="IndProp.html#T:88"><span class="id" title="variable">T</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="IndProp.html#Pumping.pumping_constant"><span class="id" title="definition">pumping_constant</span></a> <a class="idref" href="IndProp.html#re:89"><span class="id" title="variable">re</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#73030c22bc0b1fa771c65aa5414c65f<sub>9</sub>"><span class="id" title="notation">≥</span></a> 1.<br/>
<div class="togglescript" id="proofcontrol6" onclick="toggleDisplay('proof6');toggleDisplay('proofcontrol6')"><span class="show"></span></div>
<div class="proofscript" id="proof6" onclick="toggleDisplay('proof6');toggleDisplay('proofcontrol6')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">T</span> <span class="id" title="var">re</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">re</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;EmptySet&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#le_n"><span class="id" title="constructor">le_n</span></a>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;EmptyStr&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#le_n"><span class="id" title="constructor">le_n</span></a>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Char&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#le_S"><span class="id" title="constructor">le_S</span></a>. <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#le_n"><span class="id" title="constructor">le_n</span></a>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;App&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="IndProp1.html#le_trans"><span class="id" title="axiom">le_trans</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">n</span>:=<a class="idref" href="IndProp.html#Pumping.pumping_constant"><span class="id" title="definition">pumping_constant</span></a> <span class="id" title="var">re<sub>1</sub></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHre1</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="IndProp1.html#le_plus_l"><span class="id" title="axiom">le_plus_l</span></a>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Union&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="IndProp1.html#le_trans"><span class="id" title="axiom">le_trans</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">n</span>:=<a class="idref" href="IndProp.html#Pumping.pumping_constant"><span class="id" title="definition">pumping_constant</span></a> <span class="id" title="var">re<sub>1</sub></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHre1</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="IndProp1.html#le_plus_l"><span class="id" title="axiom">le_plus_l</span></a>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;Star&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHre</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="Pumping.pumping_constant_0_false" class="idref" href="#Pumping.pumping_constant_0_false"><span class="id" title="lemma">pumping_constant_0_false</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="T:90" class="idref" href="#T:90"><span class="id" title="binder">T</span></a> (<a id="re:91" class="idref" href="#re:91"><span class="id" title="binder">re</span></a> : <a class="idref" href="IndProp.html#reg_exp"><span class="id" title="inductive">reg_exp</span></a> <a class="idref" href="IndProp.html#T:90"><span class="id" title="variable">T</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="IndProp.html#Pumping.pumping_constant"><span class="id" title="definition">pumping_constant</span></a> <a class="idref" href="IndProp.html#re:91"><span class="id" title="variable">re</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 0 <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#False"><span class="id" title="inductive">False</span></a>.<br/>
<div class="togglescript" id="proofcontrol7" onclick="toggleDisplay('proof7');toggleDisplay('proofcontrol7')"><span class="show"></span></div>
<div class="proofscript" id="proof7" onclick="toggleDisplay('proof7');toggleDisplay('proofcontrol7')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">T</span> <span class="id" title="var">re</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hp<sub>1</sub></span> : <a class="idref" href="IndProp.html#Pumping.pumping_constant"><span class="id" title="definition">pumping_constant</span></a> <span class="id" title="var">re</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#73030c22bc0b1fa771c65aa5414c65f<sub>9</sub>"><span class="id" title="notation">≥</span></a> 1).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <a class="idref" href="IndProp.html#Pumping.pumping_constant_ge_1"><span class="id" title="lemma">pumping_constant_ge_1</span></a>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Hp<sub>1</sub></span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hp<sub>1</sub>'</span>| <span class="id" title="var">p</span> <span class="id" title="var">Hp<sub>1</sub>'</span> <span class="id" title="var">Hp<sub>1</sub>''</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="keyword">in</span> <span class="id" title="var">Hp<sub>1</sub>'</span>. <span class="id" title="tactic">discriminate</span> <span class="id" title="var">Hp<sub>1</sub>'</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="keyword">in</span> <span class="id" title="var">Hp<sub>1</sub>''</span>. <span class="id" title="tactic">discriminate</span> <span class="id" title="var">Hp<sub>1</sub>''</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>

<div class="doc">
Next, it is useful to define an auxiliary function that repeats a
    string (appends it to itself) some number of times. 
</div>
<div class="code">

<span class="id" title="keyword">Fixpoint</span> <a id="Pumping.napp" class="idref" href="#Pumping.napp"><span class="id" title="definition">napp</span></a> {<a id="T:92" class="idref" href="#T:92"><span class="id" title="binder">T</span></a>} (<a id="n:93" class="idref" href="#n:93"><span class="id" title="binder">n</span></a> : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="l:94" class="idref" href="#l:94"><span class="id" title="binder">l</span></a> : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="IndProp.html#T:92"><span class="id" title="variable">T</span></a>) : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="IndProp.html#T:92"><span class="id" title="variable">T</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="IndProp.html#n:93"><span class="id" title="variable">n</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| 0 ⇒ <a class="idref" href="Poly.html#2c60282cbb04e070c60ae01e76f3865a"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">n'</span> ⇒ <a class="idref" href="IndProp.html#l:94"><span class="id" title="variable">l</span></a> <a class="idref" href="Poly.html#f03f7a04ef75ff3ac66ca5c23554e52e"><span class="id" title="notation">++</span></a> <a class="idref" href="IndProp.html#napp:95"><span class="id" title="definition">napp</span></a> <span class="id" title="var">n'</span> <a class="idref" href="IndProp.html#l:94"><span class="id" title="variable">l</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
</div>

<div class="doc">
This auxiliary lemma might also be useful in your proof of the
    pumping lemma. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Pumping.napp_plus" class="idref" href="#Pumping.napp_plus"><span class="id" title="lemma">napp_plus</span></a>: <span class="id" title="keyword">∀</span> <a id="T:97" class="idref" href="#T:97"><span class="id" title="binder">T</span></a> (<a id="n:98" class="idref" href="#n:98"><span class="id" title="binder">n</span></a> <a id="m:99" class="idref" href="#m:99"><span class="id" title="binder">m</span></a> : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="l:100" class="idref" href="#l:100"><span class="id" title="binder">l</span></a> : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="IndProp.html#T:97"><span class="id" title="variable">T</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="IndProp.html#Pumping.napp"><span class="id" title="definition">napp</span></a> (<a class="idref" href="IndProp.html#n:98"><span class="id" title="variable">n</span></a> <a class="idref" href="Basics.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="IndProp.html#m:99"><span class="id" title="variable">m</span></a>) <a class="idref" href="IndProp.html#l:100"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="IndProp.html#Pumping.napp"><span class="id" title="definition">napp</span></a> <a class="idref" href="IndProp.html#n:98"><span class="id" title="variable">n</span></a> <a class="idref" href="IndProp.html#l:100"><span class="id" title="variable">l</span></a> <a class="idref" href="Poly.html#f03f7a04ef75ff3ac66ca5c23554e52e"><span class="id" title="notation">++</span></a> <a class="idref" href="IndProp.html#Pumping.napp"><span class="id" title="definition">napp</span></a> <a class="idref" href="IndProp.html#m:99"><span class="id" title="variable">m</span></a> <a class="idref" href="IndProp.html#l:100"><span class="id" title="variable">l</span></a>.<br/>
<div class="togglescript" id="proofcontrol8" onclick="toggleDisplay('proof8');toggleDisplay('proofcontrol8')"><span class="show"></span></div>
<div class="proofscript" id="proof8" onclick="toggleDisplay('proof8');toggleDisplay('proofcontrol8')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">T</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">n</span> <span class="id" title="var">IHn</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHn</span>, <a class="idref" href="Poly.html#app_assoc"><span class="id" title="axiom">app_assoc</span></a>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="Pumping.napp_star" class="idref" href="#Pumping.napp_star"><span class="id" title="lemma">napp_star</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="T:101" class="idref" href="#T:101"><span class="id" title="binder">T</span></a> <a id="m:102" class="idref" href="#m:102"><span class="id" title="binder">m</span></a> <a id="s<sub>1</sub>:103" class="idref" href="#s<sub>1</sub>:103"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="s<sub>2</sub>:104" class="idref" href="#s<sub>2</sub>:104"><span class="id" title="binder">s<sub>2</sub></span></a> (<a id="re:105" class="idref" href="#re:105"><span class="id" title="binder">re</span></a> : <a class="idref" href="IndProp.html#reg_exp"><span class="id" title="inductive">reg_exp</span></a> <a class="idref" href="IndProp.html#T:101"><span class="id" title="variable">T</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="IndProp.html#s<sub>1</sub>:103"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#re:105"><span class="id" title="variable">re</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="IndProp.html#s<sub>2</sub>:104"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#Star"><span class="id" title="constructor">Star</span></a> <a class="idref" href="IndProp.html#re:105"><span class="id" title="variable">re</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="IndProp.html#Pumping.napp"><span class="id" title="definition">napp</span></a> <a class="idref" href="IndProp.html#m:102"><span class="id" title="variable">m</span></a> <a class="idref" href="IndProp.html#s<sub>1</sub>:103"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="Poly.html#f03f7a04ef75ff3ac66ca5c23554e52e"><span class="id" title="notation">++</span></a> <a class="idref" href="IndProp.html#s<sub>2</sub>:104"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#Star"><span class="id" title="constructor">Star</span></a> <a class="idref" href="IndProp.html#re:105"><span class="id" title="variable">re</span></a>.<br/>
<div class="togglescript" id="proofcontrol9" onclick="toggleDisplay('proof9');toggleDisplay('proofcontrol9')"><span class="show"></span></div>
<div class="proofscript" id="proof9" onclick="toggleDisplay('proof9');toggleDisplay('proofcontrol9')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">T</span> <span class="id" title="var">m</span> <span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">re</span> <span class="id" title="var">Hs<sub>1</sub></span> <span class="id" title="var">Hs<sub>2</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Hs<sub>2</sub></span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="Poly.html#app_assoc"><span class="id" title="axiom">app_assoc</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="IndProp.html#MStarApp"><span class="id" title="constructor">MStarApp</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">Hs<sub>1</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">IHm</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>

<div class="doc">
The (weak) pumping lemma itself says that, if <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode">=~</span> <span class="inlinecode"><span class="id" title="var">re</span></span> and if the
    length of <span class="inlinecode"><span class="id" title="var">s</span></span> is at least the pumping constant of <span class="inlinecode"><span class="id" title="var">re</span></span>, then <span class="inlinecode"><span class="id" title="var">s</span></span>
    can be split into three substrings <span class="inlinecode"><span class="id" title="var">s<sub>1</sub></span></span> <span class="inlinecode">++</span> <span class="inlinecode"><span class="id" title="var">s<sub>2</sub></span></span> <span class="inlinecode">++</span> <span class="inlinecode"><span class="id" title="var">s<sub>3</sub></span></span> in such a way
    that <span class="inlinecode"><span class="id" title="var">s<sub>2</sub></span></span> can be repeated any number of times and the result, when
    combined with <span class="inlinecode"><span class="id" title="var">s<sub>1</sub></span></span> and <span class="inlinecode"><span class="id" title="var">s<sub>3</sub></span></span>, will still match <span class="inlinecode"><span class="id" title="var">re</span></span>.  Since <span class="inlinecode"><span class="id" title="var">s<sub>2</sub></span></span> is
    also guaranteed not to be the empty string, this gives us
    a (constructive!) way to generate strings matching <span class="inlinecode"><span class="id" title="var">re</span></span> that are
    as long as we like. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Pumping.weak_pumping" class="idref" href="#Pumping.weak_pumping"><span class="id" title="lemma">weak_pumping</span></a> : <span class="id" title="keyword">∀</span> <a id="T:106" class="idref" href="#T:106"><span class="id" title="binder">T</span></a> (<a id="re:107" class="idref" href="#re:107"><span class="id" title="binder">re</span></a> : <a class="idref" href="IndProp.html#reg_exp"><span class="id" title="inductive">reg_exp</span></a> <a class="idref" href="IndProp.html#T:106"><span class="id" title="variable">T</span></a>) <a id="s:108" class="idref" href="#s:108"><span class="id" title="binder">s</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="IndProp.html#s:108"><span class="id" title="variable">s</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#re:107"><span class="id" title="variable">re</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="IndProp.html#Pumping.pumping_constant"><span class="id" title="definition">pumping_constant</span></a> <a class="idref" href="IndProp.html#re:107"><span class="id" title="variable">re</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a<sub>3</sub>"><span class="id" title="notation">≤</span></a> <a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="IndProp.html#s:108"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="s<sub>1</sub>:109" class="idref" href="#s<sub>1</sub>:109"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="s<sub>2</sub>:110" class="idref" href="#s<sub>2</sub>:110"><span class="id" title="binder">s<sub>2</sub></span></a> <a id="s<sub>3</sub>:111" class="idref" href="#s<sub>3</sub>:111"><span class="id" title="binder">s<sub>3</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="IndProp.html#s:108"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="IndProp.html#s<sub>1</sub>:109"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="Poly.html#f03f7a04ef75ff3ac66ca5c23554e52e"><span class="id" title="notation">++</span></a> <a class="idref" href="IndProp.html#s<sub>2</sub>:110"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Poly.html#f03f7a04ef75ff3ac66ca5c23554e52e"><span class="id" title="notation">++</span></a> <a class="idref" href="IndProp.html#s<sub>3</sub>:111"><span class="id" title="variable">s<sub>3</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="IndProp.html#s<sub>2</sub>:110"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">≠</span></a> <a class="idref" href="Poly.html#2c60282cbb04e070c60ae01e76f3865a"><span class="id" title="notation">[]</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="m:112" class="idref" href="#m:112"><span class="id" title="binder">m</span></a>, <a class="idref" href="IndProp.html#s<sub>1</sub>:109"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="Poly.html#f03f7a04ef75ff3ac66ca5c23554e52e"><span class="id" title="notation">++</span></a> <a class="idref" href="IndProp.html#Pumping.napp"><span class="id" title="definition">napp</span></a> <a class="idref" href="IndProp.html#m:112"><span class="id" title="variable">m</span></a> <a class="idref" href="IndProp.html#s<sub>2</sub>:110"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Poly.html#f03f7a04ef75ff3ac66ca5c23554e52e"><span class="id" title="notation">++</span></a> <a class="idref" href="IndProp.html#s<sub>3</sub>:111"><span class="id" title="variable">s<sub>3</sub></span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#re:107"><span class="id" title="variable">re</span></a>.<br/>
</div>

<div class="doc">
Complete the proof below. Several of the lemmas about <span class="inlinecode"><span class="id" title="var">le</span></span> that
    were in an optional exercise earlier in this chapter may also be
    useful. 
</div>
<div class="code">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">T</span> <span class="id" title="var">re</span> <span class="id" title="var">s</span> <span class="id" title="var">Hmatch</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Hmatch</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> [ | <span class="id" title="var">x</span> | <span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">re<sub>1</sub></span> <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">re<sub>2</sub></span> <span class="id" title="var">Hmatch1</span> <span class="id" title="var">IH<sub>1</sub></span> <span class="id" title="var">Hmatch2</span> <span class="id" title="var">IH<sub>2</sub></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">re<sub>1</sub></span> <span class="id" title="var">re<sub>2</sub></span> <span class="id" title="var">Hmatch</span> <span class="id" title="var">IH</span> | <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">re<sub>1</sub></span> <span class="id" title="var">re<sub>2</sub></span> <span class="id" title="var">Hmatch</span> <span class="id" title="var">IH</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">re</span> | <span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">re</span> <span class="id" title="var">Hmatch1</span> <span class="id" title="var">IH<sub>1</sub></span> <span class="id" title="var">Hmatch2</span> <span class="id" title="var">IH<sub>2</sub></span> ].<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MEmpty&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">contra</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">contra</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a id="lab271"></a><h4 class="section">Exercise: 5 stars, advanced, optional (pumping)</h4>
 Now here is the usual version of the pumping lemma. In addition to
    requiring that <span class="inlinecode"><span class="id" title="var">s<sub>2</sub></span></span> <span class="inlinecode">≠</span> <span class="inlinecode">[]</span>, it also requires that <span class="inlinecode"><span class="id" title="var">length</span></span> <span class="inlinecode"><span class="id" title="var">s<sub>1</sub></span></span> <span class="inlinecode">+</span>
    <span class="inlinecode"><span class="id" title="var">length</span></span> <span class="inlinecode"><span class="id" title="var">s<sub>2</sub></span></span> <span class="inlinecode">≤</span> <span class="inlinecode"><span class="id" title="var">pumping_constant</span></span> <span class="inlinecode"><span class="id" title="var">re</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Pumping.pumping" class="idref" href="#Pumping.pumping"><span class="id" title="lemma">pumping</span></a> : <span class="id" title="keyword">∀</span> <a id="T:113" class="idref" href="#T:113"><span class="id" title="binder">T</span></a> (<a id="re:114" class="idref" href="#re:114"><span class="id" title="binder">re</span></a> : <a class="idref" href="IndProp.html#reg_exp"><span class="id" title="inductive">reg_exp</span></a> <a class="idref" href="IndProp.html#T:113"><span class="id" title="variable">T</span></a>) <a id="s:115" class="idref" href="#s:115"><span class="id" title="binder">s</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="IndProp.html#s:115"><span class="id" title="variable">s</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#re:114"><span class="id" title="variable">re</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="IndProp.html#Pumping.pumping_constant"><span class="id" title="definition">pumping_constant</span></a> <a class="idref" href="IndProp.html#re:114"><span class="id" title="variable">re</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a<sub>3</sub>"><span class="id" title="notation">≤</span></a> <a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="IndProp.html#s:115"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="s<sub>1</sub>:116" class="idref" href="#s<sub>1</sub>:116"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="s<sub>2</sub>:117" class="idref" href="#s<sub>2</sub>:117"><span class="id" title="binder">s<sub>2</sub></span></a> <a id="s<sub>3</sub>:118" class="idref" href="#s<sub>3</sub>:118"><span class="id" title="binder">s<sub>3</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="IndProp.html#s:115"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="IndProp.html#s<sub>1</sub>:116"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="Poly.html#f03f7a04ef75ff3ac66ca5c23554e52e"><span class="id" title="notation">++</span></a> <a class="idref" href="IndProp.html#s<sub>2</sub>:117"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Poly.html#f03f7a04ef75ff3ac66ca5c23554e52e"><span class="id" title="notation">++</span></a> <a class="idref" href="IndProp.html#s<sub>3</sub>:118"><span class="id" title="variable">s<sub>3</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="IndProp.html#s<sub>2</sub>:117"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">≠</span></a> <a class="idref" href="Poly.html#2c60282cbb04e070c60ae01e76f3865a"><span class="id" title="notation">[]</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="IndProp.html#s<sub>1</sub>:116"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="Basics.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="IndProp.html#s<sub>2</sub>:117"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a<sub>3</sub>"><span class="id" title="notation">≤</span></a> <a class="idref" href="IndProp.html#Pumping.pumping_constant"><span class="id" title="definition">pumping_constant</span></a> <a class="idref" href="IndProp.html#re:114"><span class="id" title="variable">re</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="m:119" class="idref" href="#m:119"><span class="id" title="binder">m</span></a>, <a class="idref" href="IndProp.html#s<sub>1</sub>:116"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="Poly.html#f03f7a04ef75ff3ac66ca5c23554e52e"><span class="id" title="notation">++</span></a> <a class="idref" href="IndProp.html#Pumping.napp"><span class="id" title="definition">napp</span></a> <a class="idref" href="IndProp.html#m:119"><span class="id" title="variable">m</span></a> <a class="idref" href="IndProp.html#s<sub>2</sub>:117"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Poly.html#f03f7a04ef75ff3ac66ca5c23554e52e"><span class="id" title="notation">++</span></a> <a class="idref" href="IndProp.html#s<sub>3</sub>:118"><span class="id" title="variable">s<sub>3</sub></span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#re:114"><span class="id" title="variable">re</span></a>.<br/>
</div>

<div class="doc">
You may want to copy your proof of weak_pumping below. 
</div>
<div class="code">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">T</span> <span class="id" title="var">re</span> <span class="id" title="var">s</span> <span class="id" title="var">Hmatch</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Hmatch</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> [ | <span class="id" title="var">x</span> | <span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">re<sub>1</sub></span> <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">re<sub>2</sub></span> <span class="id" title="var">Hmatch1</span> <span class="id" title="var">IH<sub>1</sub></span> <span class="id" title="var">Hmatch2</span> <span class="id" title="var">IH<sub>2</sub></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">re<sub>1</sub></span> <span class="id" title="var">re<sub>2</sub></span> <span class="id" title="var">Hmatch</span> <span class="id" title="var">IH</span> | <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">re<sub>1</sub></span> <span class="id" title="var">re<sub>2</sub></span> <span class="id" title="var">Hmatch</span> <span class="id" title="var">IH</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">re</span> | <span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">re</span> <span class="id" title="var">Hmatch1</span> <span class="id" title="var">IH<sub>1</sub></span> <span class="id" title="var">Hmatch2</span> <span class="id" title="var">IH<sub>2</sub></span> ].<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;MEmpty&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">contra</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">contra</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">End</span> <a class="idref" href="IndProp.html#Pumping"><span class="id" title="module">Pumping</span></a>.<br/>
<font size=-2>&#9744;</font>
</div>


<div class="doc">
<a id="lab272"></a><h1 class="section">Case Study: Improving Reflection</h1>

<div class="paragraph"> </div>

 We've seen in the <a href="Logic.html"><span class="inlineref">Logic</span></a> chapter that we often need to
    relate boolean computations to statements in <span class="inlinecode"><span class="id" title="keyword">Prop</span></span>.  But
    performing this conversion as we did there can result in
    tedious proof scripts.  Consider the proof of the following
    theorem: 
</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <a id="filter_not_empty_In" class="idref" href="#filter_not_empty_In"><span class="id" title="lemma">filter_not_empty_In</span></a> : <span class="id" title="keyword">∀</span> <a id="n:120" class="idref" href="#n:120"><span class="id" title="binder">n</span></a> <a id="l:121" class="idref" href="#l:121"><span class="id" title="binder">l</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Poly.html#filter"><span class="id" title="definition">filter</span></a> (<span class="id" title="keyword">fun</span> <a id="x:122" class="idref" href="#x:122"><span class="id" title="binder">x</span></a> ⇒ <a class="idref" href="IndProp.html#n:120"><span class="id" title="variable">n</span></a> <a class="idref" href="Basics.html#ad2ec4e405f68c46c0a176e3e94ae2e<sub>3</sub>"><span class="id" title="notation">=?</span></a> <a class="idref" href="IndProp.html#x:122"><span class="id" title="variable">x</span></a>) <a class="idref" href="IndProp.html#l:121"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">≠</span></a> <a class="idref" href="Poly.html#2c60282cbb04e070c60ae01e76f3865a"><span class="id" title="notation">[]</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Logic.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="IndProp.html#n:120"><span class="id" title="variable">n</span></a> <a class="idref" href="IndProp.html#l:121"><span class="id" title="variable">l</span></a>.<br/>
<div class="togglescript" id="proofcontrol10" onclick="toggleDisplay('proof10');toggleDisplay('proofcontrol10')"><span class="show"></span></div>
<div class="proofscript" id="proof10" onclick="toggleDisplay('proof10');toggleDisplay('proofcontrol10')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">l</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">m</span> <span class="id" title="var">l'</span> <span class="id" title="var">IHl'</span>].<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;l&nbsp;=&nbsp;nil&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;l&nbsp;=&nbsp;m&nbsp;::&nbsp;l'&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="var">n</span> <a class="idref" href="Basics.html#ad2ec4e405f68c46c0a176e3e94ae2e<sub>3</sub>"><span class="id" title="notation">=?</span></a> <span class="id" title="var">m</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;n&nbsp;=?&nbsp;m&nbsp;=&nbsp;true&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">_</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="Logic.html#eqb_eq"><span class="id" title="lemma">eqb_eq</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">left</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;n&nbsp;=?&nbsp;m&nbsp;=&nbsp;false&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H'</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHl'</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H'</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>

<div class="doc">
In the first branch after <span class="inlinecode"><span class="id" title="tactic">destruct</span></span>, we explicitly apply
    the <span class="inlinecode"><span class="id" title="var">eqb_eq</span></span> lemma to the equation generated by
    destructing <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode">=?</span> <span class="inlinecode"><span class="id" title="var">m</span></span>, to convert the assumption <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode">=?</span> <span class="inlinecode"><span class="id" title="var">m</span></span>
    <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">true</span></span> into the assumption <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">m</span></span>; then we had to <span class="inlinecode"><span class="id" title="tactic">rewrite</span></span>
    using this assumption to complete the case. 
<div class="paragraph"> </div>

 We can streamline this sort of reasoning by defining an inductive
    proposition that yields a better case-analysis principle for <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode">=?</span>
    <span class="inlinecode"><span class="id" title="var">m</span></span>.  Instead of generating the assumption <span class="inlinecode">(<span class="id" title="var">n</span></span> <span class="inlinecode">=?</span> <span class="inlinecode"><span class="id" title="var">m</span>)</span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">true</span></span>, which
    usually requires some massaging before we can use it, this
    principle gives us right away the assumption we really need: <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode">=</span>
    <span class="inlinecode"><span class="id" title="var">m</span></span>.

<div class="paragraph"> </div>

    Following the terminology introduced in <a href="Logic.html"><span class="inlineref">Logic</span></a>, we call this
    the "reflection principle for equality on numbers," and we say
    that the boolean <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode">=?</span> <span class="inlinecode"><span class="id" title="var">m</span></span> is <i>reflected in</i> the proposition <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode">=</span>
    <span class="inlinecode"><span class="id" title="var">m</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Inductive</span> <a id="reflect" class="idref" href="#reflect"><span class="id" title="inductive">reflect</span></a> (<a id="P:123" class="idref" href="#P:123"><span class="id" title="binder">P</span></a> : <span class="id" title="keyword">Prop</span>) : <a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a id="ReflectT" class="idref" href="#ReflectT"><span class="id" title="constructor">ReflectT</span></a> (<a id="H:126" class="idref" href="#H:126"><span class="id" title="binder">H</span></a> :   <a class="idref" href="IndProp.html#P:123"><span class="id" title="variable">P</span></a>) : <a class="idref" href="IndProp.html#reflect:124"><span class="id" title="inductive">reflect</span></a> <a class="idref" href="IndProp.html#P:123"><span class="id" title="variable">P</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;| <a id="ReflectF" class="idref" href="#ReflectF"><span class="id" title="constructor">ReflectF</span></a> (<a id="H:127" class="idref" href="#H:127"><span class="id" title="binder">H</span></a> : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a> <a class="idref" href="IndProp.html#P:123"><span class="id" title="variable">P</span></a>) : <a class="idref" href="IndProp.html#reflect:124"><span class="id" title="inductive">reflect</span></a> <a class="idref" href="IndProp.html#P:123"><span class="id" title="variable">P</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a>.<br/>
</div>

<div class="doc">
The <span class="inlinecode"><span class="id" title="var">reflect</span></span> property takes two arguments: a proposition
    <span class="inlinecode"><span class="id" title="var">P</span></span> and a boolean <span class="inlinecode"><span class="id" title="var">b</span></span>.  It states that the property <span class="inlinecode"><span class="id" title="var">P</span></span>
    <i>reflects</i> (intuitively, is equivalent to) the boolean <span class="inlinecode"><span class="id" title="var">b</span></span>: that
    is, <span class="inlinecode"><span class="id" title="var">P</span></span> holds if and only if <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">true</span></span>.

<div class="paragraph"> </div>

    To see this, notice that, by definition, the only way we can
    produce evidence for <span class="inlinecode"><span class="id" title="var">reflect</span></span> <span class="inlinecode"><span class="id" title="var">P</span></span> <span class="inlinecode"><span class="id" title="var">true</span></span> is by showing <span class="inlinecode"><span class="id" title="var">P</span></span> and then
    using the <span class="inlinecode"><span class="id" title="var">ReflectT</span></span> constructor.  If we invert this statement,
    this means that we can extract evidence for <span class="inlinecode"><span class="id" title="var">P</span></span> from a proof of
    <span class="inlinecode"><span class="id" title="var">reflect</span></span> <span class="inlinecode"><span class="id" title="var">P</span></span> <span class="inlinecode"><span class="id" title="var">true</span></span>.

<div class="paragraph"> </div>

    Similarly, the only way to show <span class="inlinecode"><span class="id" title="var">reflect</span></span> <span class="inlinecode"><span class="id" title="var">P</span></span> <span class="inlinecode"><span class="id" title="var">false</span></span> is by tagging
    evidence for <span class="inlinecode">¬</span> <span class="inlinecode"><span class="id" title="var">P</span></span> with the <span class="inlinecode"><span class="id" title="var">ReflectF</span></span> constructor. 
<div class="paragraph"> </div>

 To put this observation to work, we first prove that the
    statements <span class="inlinecode"><span class="id" title="var">P</span></span> <span class="inlinecode">↔</span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">true</span></span> and <span class="inlinecode"><span class="id" title="var">reflect</span></span> <span class="inlinecode"><span class="id" title="var">P</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> are indeed
    equivalent.  First, the left-to-right implication: 
</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <a id="iff_reflect" class="idref" href="#iff_reflect"><span class="id" title="lemma">iff_reflect</span></a> : <span class="id" title="keyword">∀</span> <a id="P:128" class="idref" href="#P:128"><span class="id" title="binder">P</span></a> <a id="b:129" class="idref" href="#b:129"><span class="id" title="binder">b</span></a>, <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="IndProp.html#P:128"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">↔</span></a> <a class="idref" href="IndProp.html#b:129"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="IndProp.html#reflect"><span class="id" title="inductive">reflect</span></a> <a class="idref" href="IndProp.html#P:128"><span class="id" title="variable">P</span></a> <a class="idref" href="IndProp.html#b:129"><span class="id" title="variable">b</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;WORKED&nbsp;IN&nbsp;CLASS&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">b</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Eb</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="IndProp.html#ReflectT"><span class="id" title="constructor">ReflectT</span></a>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="IndProp.html#ReflectF"><span class="id" title="constructor">ReflectF</span></a>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">H'</span>. <span class="id" title="tactic">discriminate</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Now you prove the right-to-left implication: 
<div class="paragraph"> </div>

<a id="lab273"></a><h4 class="section">Exercise: 2 stars, standard, optional (reflect_iff)</h4>

</div>
<div class="code">
<span class="id" title="keyword">Theorem</span> <a id="reflect_iff" class="idref" href="#reflect_iff"><span class="id" title="lemma">reflect_iff</span></a> : <span class="id" title="keyword">∀</span> <a id="P:130" class="idref" href="#P:130"><span class="id" title="binder">P</span></a> <a id="b:131" class="idref" href="#b:131"><span class="id" title="binder">b</span></a>, <a class="idref" href="IndProp.html#reflect"><span class="id" title="inductive">reflect</span></a> <a class="idref" href="IndProp.html#P:130"><span class="id" title="variable">P</span></a> <a class="idref" href="IndProp.html#b:131"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="IndProp.html#P:130"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">↔</span></a> <a class="idref" href="IndProp.html#b:131"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

 We can think of <span class="inlinecode"><span class="id" title="var">reflect</span></span> as a kind of variant of the usual "if
    and only if" connective; the advantage of <span class="inlinecode"><span class="id" title="var">reflect</span></span> is that, by
    destructing a hypothesis or lemma of the form <span class="inlinecode"><span class="id" title="var">reflect</span></span> <span class="inlinecode"><span class="id" title="var">P</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span>, we
    can perform case analysis on <span class="inlinecode"><span class="id" title="var">b</span></span> while <i>at the same time</i>
    generating appropriate hypothesis in the two branches (<span class="inlinecode"><span class="id" title="var">P</span></span> in the
    first subgoal and <span class="inlinecode">¬</span> <span class="inlinecode"><span class="id" title="var">P</span></span> in the second). 
<div class="paragraph"> </div>

 Let's use <span class="inlinecode"><span class="id" title="var">reflect</span></span> to produce a smoother proof of
    <span class="inlinecode"><span class="id" title="var">filter_not_empty_In</span></span>.

<div class="paragraph"> </div>

    We begin by recasting the <span class="inlinecode"><span class="id" title="var">eqb_eq</span></span> lemma in terms of <span class="inlinecode"><span class="id" title="var">reflect</span></span>: 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="eqbP" class="idref" href="#eqbP"><span class="id" title="lemma">eqbP</span></a> : <span class="id" title="keyword">∀</span> <a id="n:132" class="idref" href="#n:132"><span class="id" title="binder">n</span></a> <a id="m:133" class="idref" href="#m:133"><span class="id" title="binder">m</span></a>, <a class="idref" href="IndProp.html#reflect"><span class="id" title="inductive">reflect</span></a> (<a class="idref" href="IndProp.html#n:132"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="IndProp.html#m:133"><span class="id" title="variable">m</span></a>) (<a class="idref" href="IndProp.html#n:132"><span class="id" title="variable">n</span></a> <a class="idref" href="Basics.html#ad2ec4e405f68c46c0a176e3e94ae2e<sub>3</sub>"><span class="id" title="notation">=?</span></a> <a class="idref" href="IndProp.html#m:133"><span class="id" title="variable">m</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="IndProp.html#iff_reflect"><span class="id" title="lemma">iff_reflect</span></a>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="Logic.html#eqb_eq"><span class="id" title="lemma">eqb_eq</span></a>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
The proof of <span class="inlinecode"><span class="id" title="var">filter_not_empty_In</span></span> now goes as follows.  Notice
    how the calls to <span class="inlinecode"><span class="id" title="tactic">destruct</span></span> and <span class="inlinecode"><span class="id" title="tactic">rewrite</span></span> in the earlier proof of
    this theorem are combined here into a single call to
    <span class="inlinecode"><span class="id" title="tactic">destruct</span></span>. 
<div class="paragraph"> </div>

 (To see this clearly, execute the two proofs of
    <span class="inlinecode"><span class="id" title="var">filter_not_empty_In</span></span> with Coq and observe the differences in
    proof state at the beginning of the first case of the
    <span class="inlinecode"><span class="id" title="tactic">destruct</span></span>.) 
</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <a id="filter_not_empty_In'" class="idref" href="#filter_not_empty_In'"><span class="id" title="lemma">filter_not_empty_In'</span></a> : <span class="id" title="keyword">∀</span> <a id="n:134" class="idref" href="#n:134"><span class="id" title="binder">n</span></a> <a id="l:135" class="idref" href="#l:135"><span class="id" title="binder">l</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Poly.html#filter"><span class="id" title="definition">filter</span></a> (<span class="id" title="keyword">fun</span> <a id="x:136" class="idref" href="#x:136"><span class="id" title="binder">x</span></a> ⇒ <a class="idref" href="IndProp.html#n:134"><span class="id" title="variable">n</span></a> <a class="idref" href="Basics.html#ad2ec4e405f68c46c0a176e3e94ae2e<sub>3</sub>"><span class="id" title="notation">=?</span></a> <a class="idref" href="IndProp.html#x:136"><span class="id" title="variable">x</span></a>) <a class="idref" href="IndProp.html#l:135"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">≠</span></a> <a class="idref" href="Poly.html#2c60282cbb04e070c60ae01e76f3865a"><span class="id" title="notation">[]</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Logic.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="IndProp.html#n:134"><span class="id" title="variable">n</span></a> <a class="idref" href="IndProp.html#l:135"><span class="id" title="variable">l</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">l</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">m</span> <span class="id" title="var">l'</span> <span class="id" title="var">IHl'</span>].<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;l&nbsp;=&nbsp;<span class="inlinecode"></span>&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;l&nbsp;=&nbsp;m&nbsp;::&nbsp;l'&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">destruct</span> (<a class="idref" href="IndProp.html#eqbP"><span class="id" title="lemma">eqbP</span></a> <span class="id" title="var">n</span> <span class="id" title="var">m</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">H</span> | <span class="id" title="var">H</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;n&nbsp;=&nbsp;m&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">_</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;n&nbsp;&lt;&gt;&nbsp;m&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H'</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHl'</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H'</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab274"></a><h4 class="section">Exercise: 3 stars, standard, optional (eqbP_practice)</h4>
 Use <span class="inlinecode"><span class="id" title="var">eqbP</span></span> as above to prove the following: 
</div>
<div class="code">

<span class="id" title="keyword">Fixpoint</span> <a id="count" class="idref" href="#count"><span class="id" title="definition">count</span></a> <a id="n:137" class="idref" href="#n:137"><span class="id" title="binder">n</span></a> <a id="l:138" class="idref" href="#l:138"><span class="id" title="binder">l</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="IndProp.html#l:138"><span class="id" title="variable">l</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Poly.html#2c60282cbb04e070c60ae01e76f3865a"><span class="id" title="notation">[]</span></a> ⇒ 0<br/>
&nbsp;&nbsp;| <span class="id" title="var">m</span> <a class="idref" href="Poly.html#:::x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">l'</span> ⇒ <a class="idref" href="Basics.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">(</span></a><span class="id" title="keyword">if</span> <a class="idref" href="IndProp.html#n:137"><span class="id" title="variable">n</span></a> <a class="idref" href="Basics.html#ad2ec4e405f68c46c0a176e3e94ae2e<sub>3</sub>"><span class="id" title="notation">=?</span></a> <span class="id" title="var">m</span> <span class="id" title="keyword">then</span> 1 <span class="id" title="keyword">else</span> 0<a class="idref" href="Basics.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">)</span></a> <a class="idref" href="Basics.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="IndProp.html#count:139"><span class="id" title="definition">count</span></a> <a class="idref" href="IndProp.html#n:137"><span class="id" title="variable">n</span></a> <span class="id" title="var">l'</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <a id="eqbP_practice" class="idref" href="#eqbP_practice"><span class="id" title="lemma">eqbP_practice</span></a> : <span class="id" title="keyword">∀</span> <a id="n:141" class="idref" href="#n:141"><span class="id" title="binder">n</span></a> <a id="l:142" class="idref" href="#l:142"><span class="id" title="binder">l</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="IndProp.html#count"><span class="id" title="definition">count</span></a> <a class="idref" href="IndProp.html#n:141"><span class="id" title="variable">n</span></a> <a class="idref" href="IndProp.html#l:142"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> 0 <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">~(</span></a><a class="idref" href="Logic.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="IndProp.html#n:141"><span class="id" title="variable">n</span></a> <a class="idref" href="IndProp.html#l:142"><span class="id" title="variable">l</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">l</span> <span class="id" title="var">Hcount</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">m</span> <span class="id" title="var">l'</span> <span class="id" title="var">IHl'</span>].<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

 This small example shows reflection giving us a small gain in
    convenience; in larger developments, using <span class="inlinecode"><span class="id" title="var">reflect</span></span> consistently
    can often lead to noticeably shorter and clearer proof scripts.
    We'll see many more examples in later chapters and in <i>Programming
    Language Foundations</i>.

<div class="paragraph"> </div>

    This use of <span class="inlinecode"><span class="id" title="var">reflect</span></span> was popularized by <i>SSReflect</i>, a Coq
    library that has been used to formalize important results in
    mathematics, including the 4-color theorem and the Feit-Thompson
    theorem.  The name SSReflect stands for <i>small-scale reflection</i>,
    i.e., the pervasive use of reflection to simplify small proof
    steps by turning them into boolean computations. 
</div>

<div class="doc">
<a id="lab275"></a><h1 class="section">Additional Exercises</h1>

<div class="paragraph"> </div>

<a id="lab276"></a><h4 class="section">Exercise: 3 stars, standard, optional (nostutter_defn)</h4>
 Formulating inductive definitions of properties is an important
    skill you'll need in this course.  Try to solve this exercise
    without any help.

<div class="paragraph"> </div>

    We say that a list "stutters" if it repeats the same element
    consecutively.  (This is different from not containing duplicates:
    the sequence <span class="inlinecode">[1;4;1]</span> has two occurrences of the element <span class="inlinecode">1</span> but
    does not stutter.)  The property "<span class="inlinecode"><span class="id" title="var">nostutter</span></span> <span class="inlinecode"><span class="id" title="var">mylist</span></span>" means that
    <span class="inlinecode"><span class="id" title="var">mylist</span></span> does not stutter.  Formulate an inductive definition for
    <span class="inlinecode"><span class="id" title="var">nostutter</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Inductive</span> <a id="nostutter" class="idref" href="#nostutter"><span class="id" title="inductive">nostutter</span></a> {<a id="X:143" class="idref" href="#X:143"><span class="id" title="binder">X</span></a>:<span class="id" title="keyword">Type</span>} : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <span class="id" title="var">X</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span><br/>
.<br/>
</div>

<div class="doc">
Make sure each of these tests succeeds, but feel free to change
    the suggested proof (in comments) if the given one doesn't work
    for you.  Your definition might be different from ours and still
    be correct, in which case the examples might need a different
    proof.  (You'll notice that the suggested proofs use a number of
    tactics we haven't talked about, to make them more robust to
    different possible ways of defining <span class="inlinecode"><span class="id" title="var">nostutter</span></span>.  You can probably
    just uncomment and use them as-is, but you can also prove each
    example with more basic tactics.)  
</div>
<div class="code">

<span class="id" title="keyword">Example</span> <a id="test_nostutter_1" class="idref" href="#test_nostutter_1"><span class="id" title="definition">test_nostutter_1</span></a>: <a class="idref" href="IndProp.html#nostutter"><span class="id" title="inductive">nostutter</span></a> <a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">[</span></a>3<a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">;</span></a>1<a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">;</span></a>4<a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">;</span></a>1<a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">;</span></a>5<a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">;</span></a>6<a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">]</span></a>.<br/>
<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<span class="comment">(*&nbsp;<br/>
&nbsp;&nbsp;Proof.&nbsp;repeat&nbsp;constructor;&nbsp;apply&nbsp;eqb_neq;&nbsp;auto.<br/>
&nbsp;&nbsp;Qed.<br/>
*)</span><br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Example</span> <a id="test_nostutter_2" class="idref" href="#test_nostutter_2"><span class="id" title="definition">test_nostutter_2</span></a>:  <a class="idref" href="IndProp.html#nostutter"><span class="id" title="inductive">nostutter</span></a> (@<a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>).<br/>
<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<span class="comment">(*&nbsp;<br/>
&nbsp;&nbsp;Proof.&nbsp;repeat&nbsp;constructor;&nbsp;apply&nbsp;eqb_neq;&nbsp;auto.<br/>
&nbsp;&nbsp;Qed.<br/>
*)</span><br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Example</span> <a id="test_nostutter_3" class="idref" href="#test_nostutter_3"><span class="id" title="definition">test_nostutter_3</span></a>:  <a class="idref" href="IndProp.html#nostutter"><span class="id" title="inductive">nostutter</span></a> <a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">[</span></a>5<a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">]</span></a>.<br/>
<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<span class="comment">(*&nbsp;<br/>
&nbsp;&nbsp;Proof.&nbsp;repeat&nbsp;constructor;&nbsp;auto.&nbsp;Qed.<br/>
*)</span><br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Example</span> <a id="test_nostutter_4" class="idref" href="#test_nostutter_4"><span class="id" title="definition">test_nostutter_4</span></a>:      <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#not"><span class="id" title="definition">not</span></a> (<a class="idref" href="IndProp.html#nostutter"><span class="id" title="inductive">nostutter</span></a> <a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">[</span></a>3<a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">;</span></a>1<a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">;</span></a>1<a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">;</span></a>4<a class="idref" href="Poly.html#fa57d319973f6d58544a8887d0d48ea<sub>6</sub>"><span class="id" title="notation">]</span></a>).<br/>
<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<span class="comment">(*&nbsp;<br/>
&nbsp;&nbsp;Proof.&nbsp;intro.<br/>
&nbsp;&nbsp;repeat&nbsp;match&nbsp;goal&nbsp;with<br/>
&nbsp;&nbsp;&nbsp;&nbsp;h:&nbsp;nostutter&nbsp;_&nbsp;&#x22A2;&nbsp;_&nbsp;=&gt;&nbsp;inversion&nbsp;h;&nbsp;clear&nbsp;h;&nbsp;subst<br/>
&nbsp;&nbsp;end.<br/>
&nbsp;&nbsp;contradiction;&nbsp;auto.&nbsp;Qed.<br/>
*)</span><br/><hr class='doublespaceincode'/>
<span class="comment">(*&nbsp;Do&nbsp;not&nbsp;modify&nbsp;the&nbsp;following&nbsp;line:&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a id="manual_grade_for_nostutter" class="idref" href="#manual_grade_for_nostutter"><span class="id" title="definition">manual_grade_for_nostutter</span></a> : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><a class="idref" href="Poly.html#11c698c8685bb8ab1cf725545c085ac<sub>4</sub>"><span class="id" title="notation">×</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) := <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a id="lab277"></a><h4 class="section">Exercise: 4 stars, advanced, optional (filter_challenge)</h4>
 Let's prove that our definition of <span class="inlinecode"><span class="id" title="var">filter</span></span> from the <span class="inlinecode"><span class="id" title="var">Poly</span></span>
    chapter matches an abstract specification.  Here is the
    specification, written out informally in English:

<div class="paragraph"> </div>

    A list <span class="inlinecode"><span class="id" title="var">l</span></span> is an "in-order merge" of <span class="inlinecode"><span class="id" title="var">l<sub>1</sub></span></span> and <span class="inlinecode"><span class="id" title="var">l<sub>2</sub></span></span> if it contains
    all the same elements as <span class="inlinecode"><span class="id" title="var">l<sub>1</sub></span></span> and <span class="inlinecode"><span class="id" title="var">l<sub>2</sub></span></span>, in the same order as <span class="inlinecode"><span class="id" title="var">l<sub>1</sub></span></span>
    and <span class="inlinecode"><span class="id" title="var">l<sub>2</sub></span></span>, but possibly interleaved.  For example,
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;[1;4;6;2;3]
</span>    is an in-order merge of
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;[1;6;2]
</span>    and
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;[4;3].
</span>    Now, suppose we have a set <span class="inlinecode"><span class="id" title="var">X</span></span>, a function <span class="inlinecode"><span class="id" title="var">test</span>:</span> <span class="inlinecode"><span class="id" title="var">X</span>→<span class="id" title="var">bool</span></span>, and a
    list <span class="inlinecode"><span class="id" title="var">l</span></span> of type <span class="inlinecode"><span class="id" title="var">list</span></span> <span class="inlinecode"><span class="id" title="var">X</span></span>.  Suppose further that <span class="inlinecode"><span class="id" title="var">l</span></span> is an
    in-order merge of two lists, <span class="inlinecode"><span class="id" title="var">l<sub>1</sub></span></span> and <span class="inlinecode"><span class="id" title="var">l<sub>2</sub></span></span>, such that every item
    in <span class="inlinecode"><span class="id" title="var">l<sub>1</sub></span></span> satisfies <span class="inlinecode"><span class="id" title="var">test</span></span> and no item in <span class="inlinecode"><span class="id" title="var">l<sub>2</sub></span></span> satisfies test.  Then
    <span class="inlinecode"><span class="id" title="var">filter</span></span> <span class="inlinecode"><span class="id" title="var">test</span></span> <span class="inlinecode"><span class="id" title="var">l</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">l<sub>1</sub></span></span>.

<div class="paragraph"> </div>

    First define what it means for one list to be a merge of two
    others.  Do this with an inductive relation, not a <span class="inlinecode"><span class="id" title="keyword">Fixpoint</span></span>.  
</div>
<div class="code">

<span class="id" title="keyword">Inductive</span> <a id="merge" class="idref" href="#merge"><span class="id" title="inductive">merge</span></a> {<a id="X:146" class="idref" href="#X:146"><span class="id" title="binder">X</span></a>:<span class="id" title="keyword">Type</span>} : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <span class="id" title="var">X</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <span class="id" title="var">X</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <span class="id" title="var">X</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span><br/>
.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <a id="merge_filter" class="idref" href="#merge_filter"><span class="id" title="lemma">merge_filter</span></a> : <span class="id" title="keyword">∀</span> (<a id="X:149" class="idref" href="#X:149"><span class="id" title="binder">X</span></a> : <span class="id" title="keyword">Set</span>) (<a id="test:150" class="idref" href="#test:150"><span class="id" title="binder">test</span></a>: <a class="idref" href="IndProp.html#X:149"><span class="id" title="variable">X</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a>) (<a id="l:151" class="idref" href="#l:151"><span class="id" title="binder">l</span></a> <a id="l<sub>1</sub>:152" class="idref" href="#l<sub>1</sub>:152"><span class="id" title="binder">l<sub>1</sub></span></a> <a id="l<sub>2</sub>:153" class="idref" href="#l<sub>2</sub>:153"><span class="id" title="binder">l<sub>2</sub></span></a> : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="IndProp.html#X:149"><span class="id" title="variable">X</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="IndProp.html#merge"><span class="id" title="inductive">merge</span></a> <a class="idref" href="IndProp.html#l<sub>1</sub>:152"><span class="id" title="variable">l<sub>1</sub></span></a> <a class="idref" href="IndProp.html#l<sub>2</sub>:153"><span class="id" title="variable">l<sub>2</sub></span></a> <a class="idref" href="IndProp.html#l:151"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Logic.html#All"><span class="id" title="axiom">All</span></a> (<span class="id" title="keyword">fun</span> <a id="n:154" class="idref" href="#n:154"><span class="id" title="binder">n</span></a> ⇒ <a class="idref" href="IndProp.html#test:150"><span class="id" title="variable">test</span></a> <a class="idref" href="IndProp.html#n:154"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a>) <a class="idref" href="IndProp.html#l<sub>1</sub>:152"><span class="id" title="variable">l<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Logic.html#All"><span class="id" title="axiom">All</span></a> (<span class="id" title="keyword">fun</span> <a id="n:155" class="idref" href="#n:155"><span class="id" title="binder">n</span></a> ⇒ <a class="idref" href="IndProp.html#test:150"><span class="id" title="variable">test</span></a> <a class="idref" href="IndProp.html#n:155"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a>) <a class="idref" href="IndProp.html#l<sub>2</sub>:153"><span class="id" title="variable">l<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Poly.html#filter"><span class="id" title="definition">filter</span></a> <a class="idref" href="IndProp.html#test:150"><span class="id" title="variable">test</span></a> <a class="idref" href="IndProp.html#l:151"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="IndProp.html#l<sub>1</sub>:152"><span class="id" title="variable">l<sub>1</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span><br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a id="lab278"></a><h4 class="section">Exercise: 5 stars, advanced, optional (filter_challenge_2)</h4>
 A different way to characterize the behavior of <span class="inlinecode"><span class="id" title="var">filter</span></span> goes like
    this: Among all subsequences of <span class="inlinecode"><span class="id" title="var">l</span></span> with the property that <span class="inlinecode"><span class="id" title="var">test</span></span>
    evaluates to <span class="inlinecode"><span class="id" title="var">true</span></span> on all their members, <span class="inlinecode"><span class="id" title="var">filter</span></span> <span class="inlinecode"><span class="id" title="var">test</span></span> <span class="inlinecode"><span class="id" title="var">l</span></span> is the
    longest.  Formalize this claim and prove it. 
</div>
<div class="code">

<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span><br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a id="lab279"></a><h4 class="section">Exercise: 4 stars, standard, optional (palindromes)</h4>
 A palindrome is a sequence that reads the same backwards as
    forwards.

<div class="paragraph"> </div>

<ul class="doclist">
<li> Define an inductive proposition <span class="inlinecode"><span class="id" title="var">pal</span></span> on <span class="inlinecode"><span class="id" title="var">list</span></span> <span class="inlinecode"><span class="id" title="var">X</span></span> that
      captures what it means to be a palindrome. (Hint: You'll need
      three cases.  Your definition should be based on the structure
      of the list; just having a single constructor like
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">c</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">l</span>, <span class="id" title="var">l</span> = <span class="id" title="var">rev</span> <span class="id" title="var">l</span> → <span class="id" title="var">pal</span> <span class="id" title="var">l</span>
</span>      may seem obvious, but will not work very well.)

<div class="paragraph"> </div>


</li>
<li> Prove (<span class="inlinecode"><span class="id" title="var">pal_app_rev</span></span>) that
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">l</span>, <span class="id" title="var">pal</span> (<span class="id" title="var">l</span> ++ <span class="id" title="var">rev</span> <span class="id" title="var">l</span>).
</span>
</li>
<li> Prove (<span class="inlinecode"><span class="id" title="var">pal_rev</span></span> that)
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">l</span>, <span class="id" title="var">pal</span> <span class="id" title="var">l</span> → <span class="id" title="var">l</span> = <span class="id" title="var">rev</span> <span class="id" title="var">l</span>.
</span>
</li>
</ul>

</div>
<div class="code">

<span class="id" title="keyword">Inductive</span> <a id="pal" class="idref" href="#pal"><span class="id" title="inductive">pal</span></a> {<a id="X:156" class="idref" href="#X:156"><span class="id" title="binder">X</span></a>:<span class="id" title="keyword">Type</span>} : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <span class="id" title="var">X</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span><br/>
.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <a id="pal_app_rev" class="idref" href="#pal_app_rev"><span class="id" title="lemma">pal_app_rev</span></a> : <span class="id" title="keyword">∀</span> (<a id="X:159" class="idref" href="#X:159"><span class="id" title="binder">X</span></a>:<span class="id" title="keyword">Type</span>) (<a id="l:160" class="idref" href="#l:160"><span class="id" title="binder">l</span></a> : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="IndProp.html#X:159"><span class="id" title="variable">X</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="IndProp.html#pal"><span class="id" title="inductive">pal</span></a> (<a class="idref" href="IndProp.html#l:160"><span class="id" title="variable">l</span></a> <a class="idref" href="Poly.html#f03f7a04ef75ff3ac66ca5c23554e52e"><span class="id" title="notation">++</span></a> <a class="idref" href="Poly.html#f03f7a04ef75ff3ac66ca5c23554e52e"><span class="id" title="notation">(</span></a><a class="idref" href="Poly.html#rev"><span class="id" title="definition">rev</span></a> <a class="idref" href="IndProp.html#l:160"><span class="id" title="variable">l</span></a><a class="idref" href="Poly.html#f03f7a04ef75ff3ac66ca5c23554e52e"><span class="id" title="notation">)</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <a id="pal_rev" class="idref" href="#pal_rev"><span class="id" title="lemma">pal_rev</span></a> : <span class="id" title="keyword">∀</span> (<a id="X:161" class="idref" href="#X:161"><span class="id" title="binder">X</span></a>:<span class="id" title="keyword">Type</span>) (<a id="l:162" class="idref" href="#l:162"><span class="id" title="binder">l</span></a>: <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="IndProp.html#X:161"><span class="id" title="variable">X</span></a>) , <a class="idref" href="IndProp.html#pal"><span class="id" title="inductive">pal</span></a> <a class="idref" href="IndProp.html#l:162"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="IndProp.html#l:162"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#rev"><span class="id" title="definition">rev</span></a> <a class="idref" href="IndProp.html#l:162"><span class="id" title="variable">l</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a id="lab280"></a><h4 class="section">Exercise: 5 stars, standard, optional (palindrome_converse)</h4>
 Again, the converse direction is significantly more difficult, due
    to the lack of evidence.  Using your definition of <span class="inlinecode"><span class="id" title="var">pal</span></span> from the
    previous exercise, prove that
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">l</span>, <span class="id" title="var">l</span> = <span class="id" title="var">rev</span> <span class="id" title="var">l</span> → <span class="id" title="var">pal</span> <span class="id" title="var">l</span>.
</span>
</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <a id="palindrome_converse" class="idref" href="#palindrome_converse"><span class="id" title="lemma">palindrome_converse</span></a>: <span class="id" title="keyword">∀</span> {<a id="X:163" class="idref" href="#X:163"><span class="id" title="binder">X</span></a>: <span class="id" title="keyword">Type</span>} (<a id="l:164" class="idref" href="#l:164"><span class="id" title="binder">l</span></a>: <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="IndProp.html#X:163"><span class="id" title="variable">X</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="IndProp.html#l:164"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#rev"><span class="id" title="definition">rev</span></a> <a class="idref" href="IndProp.html#l:164"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="IndProp.html#pal"><span class="id" title="inductive">pal</span></a> <a class="idref" href="IndProp.html#l:164"><span class="id" title="variable">l</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a id="lab281"></a><h4 class="section">Exercise: 4 stars, advanced, optional (NoDup)</h4>
 Recall the definition of the <span class="inlinecode"><span class="id" title="var">In</span></span> property from the <span class="inlinecode"><span class="id" title="var">Logic</span></span>
    chapter, which asserts that a value <span class="inlinecode"><span class="id" title="var">x</span></span> appears at least once in a
    list <span class="inlinecode"><span class="id" title="var">l</span></span>: 
</div>
<div class="code">

<span class="comment">(*&nbsp;Fixpoint&nbsp;In&nbsp;(A&nbsp;:&nbsp;Type)&nbsp;(x&nbsp;:&nbsp;A)&nbsp;(l&nbsp;:&nbsp;list&nbsp;A)&nbsp;:&nbsp;Prop&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;match&nbsp;l&nbsp;with<br/>
&nbsp;&nbsp;&nbsp;|&nbsp;<span class="inlinecode"></span>&nbsp;=&gt;&nbsp;False<br/>
&nbsp;&nbsp;&nbsp;|&nbsp;x'&nbsp;::&nbsp;l'&nbsp;=&gt;&nbsp;x'&nbsp;=&nbsp;x&nbsp;\/&nbsp;In&nbsp;A&nbsp;x&nbsp;l'<br/>
&nbsp;&nbsp;&nbsp;end&nbsp;*)</span><br/>
</div>

<div class="doc">
Your first task is to use <span class="inlinecode"><span class="id" title="var">In</span></span> to define a proposition <span class="inlinecode"><span class="id" title="var">disjoint</span></span> <span class="inlinecode"><span class="id" title="var">X</span></span>
    <span class="inlinecode"><span class="id" title="var">l<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">l<sub>2</sub></span></span>, which should be provable exactly when <span class="inlinecode"><span class="id" title="var">l<sub>1</sub></span></span> and <span class="inlinecode"><span class="id" title="var">l<sub>2</sub></span></span> are
    lists (with elements of type X) that have no elements in
    common. 
</div>
<div class="code">

<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span><br/>
</div>

<div class="doc">
Next, use <span class="inlinecode"><span class="id" title="var">In</span></span> to define an inductive proposition <span class="inlinecode"><span class="id" title="var">NoDup</span></span> <span class="inlinecode"><span class="id" title="var">X</span></span>
    <span class="inlinecode"><span class="id" title="var">l</span></span>, which should be provable exactly when <span class="inlinecode"><span class="id" title="var">l</span></span> is a list (with
    elements of type <span class="inlinecode"><span class="id" title="var">X</span></span>) where every member is different from every
    other.  For example, <span class="inlinecode"><span class="id" title="var">NoDup</span></span> <span class="inlinecode"><span class="id" title="var">nat</span></span> <span class="inlinecode">[1;2;3;4]</span> and <span class="inlinecode"><span class="id" title="var">NoDup</span></span>
    <span class="inlinecode"><span class="id" title="var">bool</span></span> <span class="inlinecode">[]</span> should be provable, while <span class="inlinecode"><span class="id" title="var">NoDup</span></span> <span class="inlinecode"><span class="id" title="var">nat</span></span> <span class="inlinecode">[1;2;1]</span> and
    <span class="inlinecode"><span class="id" title="var">NoDup</span></span> <span class="inlinecode"><span class="id" title="var">bool</span></span> <span class="inlinecode">[<span class="id" title="var">true</span>;<span class="id" title="var">true</span>]</span> should not be.  
</div>
<div class="code">

<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span><br/>
</div>

<div class="doc">
Finally, state and prove one or more interesting theorems relating
    <span class="inlinecode"><span class="id" title="var">disjoint</span></span>, <span class="inlinecode"><span class="id" title="var">NoDup</span></span> and <span class="inlinecode">++</span> (list append).  
</div>
<div class="code">

<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span><br/><hr class='doublespaceincode'/>
<span class="comment">(*&nbsp;Do&nbsp;not&nbsp;modify&nbsp;the&nbsp;following&nbsp;line:&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a id="manual_grade_for_NoDup_disjoint_etc" class="idref" href="#manual_grade_for_NoDup_disjoint_etc"><span class="id" title="definition">manual_grade_for_NoDup_disjoint_etc</span></a> : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><a class="idref" href="Poly.html#11c698c8685bb8ab1cf725545c085ac<sub>4</sub>"><span class="id" title="notation">×</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) := <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a id="lab282"></a><h4 class="section">Exercise: 4 stars, advanced, optional (pigeonhole_principle)</h4>
 The <i>pigeonhole principle</i> states a basic fact about counting: if
    we distribute more than <span class="inlinecode"><span class="id" title="var">n</span></span> items into <span class="inlinecode"><span class="id" title="var">n</span></span> pigeonholes, some
    pigeonhole must contain at least two items.  As often happens, this
    apparently trivial fact about numbers requires non-trivial
    machinery to prove, but we now have enough... 
<div class="paragraph"> </div>

 First prove an easy and useful lemma. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="in_split" class="idref" href="#in_split"><span class="id" title="lemma">in_split</span></a> : <span class="id" title="keyword">∀</span> (<a id="X:165" class="idref" href="#X:165"><span class="id" title="binder">X</span></a>:<span class="id" title="keyword">Type</span>) (<a id="x:166" class="idref" href="#x:166"><span class="id" title="binder">x</span></a>:<a class="idref" href="IndProp.html#X:165"><span class="id" title="variable">X</span></a>) (<a id="l:167" class="idref" href="#l:167"><span class="id" title="binder">l</span></a>:<a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="IndProp.html#X:165"><span class="id" title="variable">X</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Logic.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="IndProp.html#x:166"><span class="id" title="variable">x</span></a> <a class="idref" href="IndProp.html#l:167"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="l<sub>1</sub>:168" class="idref" href="#l<sub>1</sub>:168"><span class="id" title="binder">l<sub>1</sub></span></a> <a id="l<sub>2</sub>:169" class="idref" href="#l<sub>2</sub>:169"><span class="id" title="binder">l<sub>2</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="IndProp.html#l:167"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="IndProp.html#l<sub>1</sub>:168"><span class="id" title="variable">l<sub>1</sub></span></a> <a class="idref" href="Poly.html#f03f7a04ef75ff3ac66ca5c23554e52e"><span class="id" title="notation">++</span></a> <a class="idref" href="IndProp.html#x:166"><span class="id" title="variable">x</span></a> <a class="idref" href="Poly.html#:::x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="IndProp.html#l<sub>2</sub>:169"><span class="id" title="variable">l<sub>2</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
Now define a property <span class="inlinecode"><span class="id" title="var">repeats</span></span> such that <span class="inlinecode"><span class="id" title="var">repeats</span></span> <span class="inlinecode"><span class="id" title="var">X</span></span> <span class="inlinecode"><span class="id" title="var">l</span></span> asserts
    that <span class="inlinecode"><span class="id" title="var">l</span></span> contains at least one repeated element (of type <span class="inlinecode"><span class="id" title="var">X</span></span>).  
</div>
<div class="code">

<span class="id" title="keyword">Inductive</span> <a id="repeats" class="idref" href="#repeats"><span class="id" title="inductive">repeats</span></a> {<a id="X:170" class="idref" href="#X:170"><span class="id" title="binder">X</span></a>:<span class="id" title="keyword">Type</span>} : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <span class="id" title="var">X</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span><br/>
.<br/><hr class='doublespaceincode'/>
<span class="comment">(*&nbsp;Do&nbsp;not&nbsp;modify&nbsp;the&nbsp;following&nbsp;line:&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a id="manual_grade_for_check_repeats" class="idref" href="#manual_grade_for_check_repeats"><span class="id" title="definition">manual_grade_for_check_repeats</span></a> : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><a class="idref" href="Poly.html#11c698c8685bb8ab1cf725545c085ac<sub>4</sub>"><span class="id" title="notation">×</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) := <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
</div>

<div class="doc">
Now, here's a way to formalize the pigeonhole principle.  Suppose
    list <span class="inlinecode"><span class="id" title="var">l<sub>2</sub></span></span> represents a list of pigeonhole labels, and list <span class="inlinecode"><span class="id" title="var">l<sub>1</sub></span></span>
    represents the labels assigned to a list of items.  If there are
    more items than labels, at least two items must have the same
    label -- i.e., list <span class="inlinecode"><span class="id" title="var">l<sub>1</sub></span></span> must contain repeats.

<div class="paragraph"> </div>

    This proof is much easier if you use the <span class="inlinecode"><span class="id" title="var">excluded_middle</span></span>
    hypothesis to show that <span class="inlinecode"><span class="id" title="var">In</span></span> is decidable, i.e., <span class="inlinecode"><span class="id" title="keyword">∀</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">l</span>,</span> <span class="inlinecode">(<span class="id" title="var">In</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span>
    <span class="inlinecode"><span class="id" title="var">l</span>)</span> <span class="inlinecode">∨</span> <span class="inlinecode">¬</span> <span class="inlinecode">(<span class="id" title="var">In</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">l</span>)</span>.  However, it is also possible to make the proof
    go through <i>without</i> assuming that <span class="inlinecode"><span class="id" title="var">In</span></span> is decidable; if you
    manage to do this, you will not need the <span class="inlinecode"><span class="id" title="var">excluded_middle</span></span>
    hypothesis. 
</div>
<div class="code">
<span class="id" title="keyword">Theorem</span> <a id="pigeonhole_principle" class="idref" href="#pigeonhole_principle"><span class="id" title="lemma">pigeonhole_principle</span></a>: <a class="idref" href="Logic.html#excluded_middle"><span class="id" title="definition">excluded_middle</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="X:173" class="idref" href="#X:173"><span class="id" title="binder">X</span></a>:<span class="id" title="keyword">Type</span>) (<a id="l<sub>1</sub>:174" class="idref" href="#l<sub>1</sub>:174"><span class="id" title="binder">l<sub>1</sub></span></a>  <a id="l<sub>2</sub>:175" class="idref" href="#l<sub>2</sub>:175"><span class="id" title="binder">l<sub>2</sub></span></a>:<a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="IndProp.html#X:173"><span class="id" title="variable">X</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="x:176" class="idref" href="#x:176"><span class="id" title="binder">x</span></a>, <a class="idref" href="Logic.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="IndProp.html#x:176"><span class="id" title="variable">x</span></a> <a class="idref" href="IndProp.html#l<sub>1</sub>:174"><span class="id" title="variable">l<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Logic.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="IndProp.html#x:176"><span class="id" title="variable">x</span></a> <a class="idref" href="IndProp.html#l<sub>2</sub>:175"><span class="id" title="variable">l<sub>2</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="IndProp.html#l<sub>2</sub>:175"><span class="id" title="variable">l<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="IndProp.html#l<sub>1</sub>:174"><span class="id" title="variable">l<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="IndProp.html#repeats"><span class="id" title="inductive">repeats</span></a> <a class="idref" href="IndProp.html#l<sub>1</sub>:174"><span class="id" title="variable">l<sub>1</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">EM</span> <span class="id" title="var">X</span> <span class="id" title="var">l<sub>1</sub></span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">l<sub>1</sub></span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">x</span> <span class="id" title="var">l<sub>1</sub>'</span> <span class="id" title="var">IHl1'</span>].<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a id="lab283"></a><h2 class="section">Extended Exercise: A Verified Regular-Expression Matcher</h2>

<div class="paragraph"> </div>

 We have now defined a match relation over regular expressions and
    polymorphic lists. We can use such a definition to manually prove that
    a given regex matches a given string, but it does not give us a
    program that we can run to determine a match automatically.

<div class="paragraph"> </div>

    It would be reasonable to hope that we can translate the definitions
    of the inductive rules for constructing evidence of the match relation
    into cases of a recursive function that reflects the relation by recursing
    on a given regex. However, it does not seem straightforward to define
    such a function in which the given regex is a recursion variable
    recognized by Coq. As a result, Coq will not accept that the function
    always terminates.

<div class="paragraph"> </div>

    Heavily-optimized regex matchers match a regex by translating a given
    regex into a state machine and determining if the state machine
    accepts a given string. However, regex matching can also be
    implemented using an algorithm that operates purely on strings and
    regexes without defining and maintaining additional datatypes, such as
    state machines. We'll implement such an algorithm, and verify that
    its value reflects the match relation. 
<div class="paragraph"> </div>

 We will implement a regex matcher that matches strings represented
    as lists of ASCII characters: 
</div>
<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Strings.Ascii.html#"><span class="id" title="library">Coq.Strings.Ascii</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Definition</span> <a id="string" class="idref" href="#string"><span class="id" title="definition">string</span></a> := <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Strings.Ascii.html#ascii"><span class="id" title="inductive">ascii</span></a>.<br/>
</div>

<div class="doc">
The Coq standard library contains a distinct inductive definition
    of strings of ASCII characters. However, we will use the above
    definition of strings as lists as ASCII characters in order to apply
    the existing definition of the match relation.

<div class="paragraph"> </div>

    We could also define a regex matcher over polymorphic lists, not lists
    of ASCII characters specifically. The matching algorithm that we will
    implement needs to be able to test equality of elements in a given
    list, and thus needs to be given an equality-testing
    function. Generalizing the definitions, theorems, and proofs that we
    define for such a setting is a bit tedious, but workable. 
<div class="paragraph"> </div>

 The proof of correctness of the regex matcher will combine
    properties of the regex-matching function with properties of the
    <span class="inlinecode"><span class="id" title="keyword">match</span></span> relation that do not depend on the matching function. We'll go
    ahead and prove the latter class of properties now. Most of them have
    straightforward proofs, which have been given to you, although there
    are a few key lemmas that are left for you to prove. 
</div>

<div class="doc">
Each provable <span class="inlinecode"><span class="id" title="keyword">Prop</span></span> is equivalent to <span class="inlinecode"><span class="id" title="var">True</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="provable_equiv_true" class="idref" href="#provable_equiv_true"><span class="id" title="lemma">provable_equiv_true</span></a> : <span class="id" title="keyword">∀</span> (<a id="P:177" class="idref" href="#P:177"><span class="id" title="binder">P</span></a> : <span class="id" title="keyword">Prop</span>), <a class="idref" href="IndProp.html#P:177"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="IndProp.html#P:177"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">↔</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">_</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Each <span class="inlinecode"><span class="id" title="keyword">Prop</span></span> whose negation is provable is equivalent to <span class="inlinecode"><span class="id" title="var">False</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="not_equiv_false" class="idref" href="#not_equiv_false"><span class="id" title="lemma">not_equiv_false</span></a> : <span class="id" title="keyword">∀</span> (<a id="P:178" class="idref" href="#P:178"><span class="id" title="binder">P</span></a> : <span class="id" title="keyword">Prop</span>), <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a><a class="idref" href="IndProp.html#P:178"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="IndProp.html#P:178"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">↔</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#False"><span class="id" title="inductive">False</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H<sub>0</sub></span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">EmptySet</span></span> matches no string. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="null_matches_none" class="idref" href="#null_matches_none"><span class="id" title="lemma">null_matches_none</span></a> : <span class="id" title="keyword">∀</span> (<a id="s:179" class="idref" href="#s:179"><span class="id" title="binder">s</span></a> : <a class="idref" href="IndProp.html#string"><span class="id" title="definition">string</span></a>), <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="IndProp.html#s:179"><span class="id" title="variable">s</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#EmptySet"><span class="id" title="constructor">EmptySet</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">↔</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#False"><span class="id" title="inductive">False</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="IndProp.html#not_equiv_false"><span class="id" title="lemma">not_equiv_false</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#not"><span class="id" title="definition">not</span></a>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">EmptyStr</span></span> only matches the empty string. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="empty_matches_eps" class="idref" href="#empty_matches_eps"><span class="id" title="lemma">empty_matches_eps</span></a> : <span class="id" title="keyword">∀</span> (<a id="s:180" class="idref" href="#s:180"><span class="id" title="binder">s</span></a> : <a class="idref" href="IndProp.html#string"><span class="id" title="definition">string</span></a>), <a class="idref" href="IndProp.html#s:180"><span class="id" title="variable">s</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#EmptyStr"><span class="id" title="constructor">EmptyStr</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">↔</span></a> <a class="idref" href="IndProp.html#s:180"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#2c60282cbb04e070c60ae01e76f3865a"><span class="id" title="notation">[</span></a> <a class="idref" href="Poly.html#2c60282cbb04e070c60ae01e76f3865a"><span class="id" title="notation">]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="IndProp.html#MEmpty"><span class="id" title="constructor">MEmpty</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">EmptyStr</span></span> matches no non-empty string. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="empty_nomatch_ne" class="idref" href="#empty_nomatch_ne"><span class="id" title="lemma">empty_nomatch_ne</span></a> : <span class="id" title="keyword">∀</span> (<a id="a:181" class="idref" href="#a:181"><span class="id" title="binder">a</span></a> : <a class="idref" href="http://coq.inria.fr/library//Coq.Strings.Ascii.html#ascii"><span class="id" title="inductive">ascii</span></a>) <a id="s:182" class="idref" href="#s:182"><span class="id" title="binder">s</span></a>, <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="IndProp.html#a:181"><span class="id" title="variable">a</span></a> <a class="idref" href="Poly.html#:::x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="IndProp.html#s:182"><span class="id" title="variable">s</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#EmptyStr"><span class="id" title="constructor">EmptyStr</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">↔</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#False"><span class="id" title="inductive">False</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="IndProp.html#not_equiv_false"><span class="id" title="lemma">not_equiv_false</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#not"><span class="id" title="definition">not</span></a>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">Char</span></span> <span class="inlinecode"><span class="id" title="var">a</span></span> matches no string that starts with a non-<span class="inlinecode"><span class="id" title="var">a</span></span> character. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="char_nomatch_char" class="idref" href="#char_nomatch_char"><span class="id" title="lemma">char_nomatch_char</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="a:183" class="idref" href="#a:183"><span class="id" title="binder">a</span></a> <a id="b:184" class="idref" href="#b:184"><span class="id" title="binder">b</span></a> : <a class="idref" href="http://coq.inria.fr/library//Coq.Strings.Ascii.html#ascii"><span class="id" title="inductive">ascii</span></a>) <a id="s:185" class="idref" href="#s:185"><span class="id" title="binder">s</span></a>, <a class="idref" href="IndProp.html#b:184"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">≠</span></a> <a class="idref" href="IndProp.html#a:183"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="IndProp.html#b:184"><span class="id" title="variable">b</span></a> <a class="idref" href="Poly.html#:::x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="IndProp.html#s:185"><span class="id" title="variable">s</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#Char"><span class="id" title="constructor">Char</span></a> <a class="idref" href="IndProp.html#a:183"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">↔</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#False"><span class="id" title="inductive">False</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="IndProp.html#not_equiv_false"><span class="id" title="lemma">not_equiv_false</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#not"><span class="id" title="definition">not</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H<sub>0</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
If <span class="inlinecode"><span class="id" title="var">Char</span></span> <span class="inlinecode"><span class="id" title="var">a</span></span> matches a non-empty string, then the string's tail is empty. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="char_eps_suffix" class="idref" href="#char_eps_suffix"><span class="id" title="lemma">char_eps_suffix</span></a> : <span class="id" title="keyword">∀</span> (<a id="a:186" class="idref" href="#a:186"><span class="id" title="binder">a</span></a> : <a class="idref" href="http://coq.inria.fr/library//Coq.Strings.Ascii.html#ascii"><span class="id" title="inductive">ascii</span></a>) <a id="s:187" class="idref" href="#s:187"><span class="id" title="binder">s</span></a>, <a class="idref" href="IndProp.html#a:186"><span class="id" title="variable">a</span></a> <a class="idref" href="Poly.html#:::x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="IndProp.html#s:187"><span class="id" title="variable">s</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#Char"><span class="id" title="constructor">Char</span></a> <a class="idref" href="IndProp.html#a:186"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">↔</span></a> <a class="idref" href="IndProp.html#s:187"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#2c60282cbb04e070c60ae01e76f3865a"><span class="id" title="notation">[</span></a> <a class="idref" href="Poly.html#2c60282cbb04e070c60ae01e76f3865a"><span class="id" title="notation">]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="IndProp.html#MChar"><span class="id" title="constructor">MChar</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">App</span></span> <span class="inlinecode"><span class="id" title="var">re<sub>0</sub></span></span> <span class="inlinecode"><span class="id" title="var">re<sub>1</sub></span></span> matches string <span class="inlinecode"><span class="id" title="var">s</span></span> iff <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">s<sub>0</sub></span></span> <span class="inlinecode">++</span> <span class="inlinecode"><span class="id" title="var">s<sub>1</sub></span></span>, where <span class="inlinecode"><span class="id" title="var">s<sub>0</sub></span></span>
    matches <span class="inlinecode"><span class="id" title="var">re<sub>0</sub></span></span> and <span class="inlinecode"><span class="id" title="var">s<sub>1</sub></span></span> matches <span class="inlinecode"><span class="id" title="var">re<sub>1</sub></span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="app_exists" class="idref" href="#app_exists"><span class="id" title="lemma">app_exists</span></a> : <span class="id" title="keyword">∀</span> (<a id="s:188" class="idref" href="#s:188"><span class="id" title="binder">s</span></a> : <a class="idref" href="IndProp.html#string"><span class="id" title="definition">string</span></a>) <a id="re<sub>0</sub>:189" class="idref" href="#re<sub>0</sub>:189"><span class="id" title="binder">re<sub>0</sub></span></a> <a id="re<sub>1</sub>:190" class="idref" href="#re<sub>1</sub>:190"><span class="id" title="binder">re<sub>1</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="IndProp.html#s:188"><span class="id" title="variable">s</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#App"><span class="id" title="constructor">App</span></a> <a class="idref" href="IndProp.html#re<sub>0</sub>:189"><span class="id" title="variable">re<sub>0</sub></span></a> <a class="idref" href="IndProp.html#re<sub>1</sub>:190"><span class="id" title="variable">re<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">↔</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="s<sub>0</sub>:191" class="idref" href="#s<sub>0</sub>:191"><span class="id" title="binder">s<sub>0</sub></span></a> <a id="s<sub>1</sub>:192" class="idref" href="#s<sub>1</sub>:192"><span class="id" title="binder">s<sub>1</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="IndProp.html#s:188"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="IndProp.html#s<sub>0</sub>:191"><span class="id" title="variable">s<sub>0</sub></span></a> <a class="idref" href="Poly.html#f03f7a04ef75ff3ac66ca5c23554e52e"><span class="id" title="notation">++</span></a> <a class="idref" href="IndProp.html#s<sub>1</sub>:192"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="IndProp.html#s<sub>0</sub>:191"><span class="id" title="variable">s<sub>0</sub></span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#re<sub>0</sub>:189"><span class="id" title="variable">re<sub>0</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="IndProp.html#s<sub>1</sub>:192"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#re<sub>1</sub>:190"><span class="id" title="variable">re<sub>1</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">∃</span> <span class="id" title="var">s<sub>1</sub></span>, <span class="id" title="var">s<sub>2</sub></span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">split</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H<sub>3</sub></span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H<sub>4</sub></span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> [ <span class="id" title="var">s<sub>0</sub></span> [ <span class="id" title="var">s<sub>1</sub></span> [ <span class="id" title="var">Happ</span> [ <span class="id" title="var">Hmat0</span> <span class="id" title="var">Hmat1</span> ] ] ] ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Happ</span>. <span class="id" title="tactic">apply</span> (<a class="idref" href="IndProp.html#MApp"><span class="id" title="constructor">MApp</span></a> <span class="id" title="var">s<sub>0</sub></span> <span class="id" title="var">_</span> <span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">_</span> <span class="id" title="var">Hmat0</span> <span class="id" title="var">Hmat1</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab284"></a><h4 class="section">Exercise: 3 stars, standard, optional (app_ne)</h4>
 <span class="inlinecode"><span class="id" title="var">App</span></span> <span class="inlinecode"><span class="id" title="var">re<sub>0</sub></span></span> <span class="inlinecode"><span class="id" title="var">re<sub>1</sub></span></span> matches <span class="inlinecode"><span class="id" title="var">a</span>::<span class="id" title="var">s</span></span> iff <span class="inlinecode"><span class="id" title="var">re<sub>0</sub></span></span> matches the empty string
    and <span class="inlinecode"><span class="id" title="var">a</span>::<span class="id" title="var">s</span></span> matches <span class="inlinecode"><span class="id" title="var">re<sub>1</sub></span></span> or <span class="inlinecode"><span class="id" title="var">s</span>=<span class="id" title="var">s<sub>0</sub></span>++<span class="id" title="var">s<sub>1</sub></span></span>, where <span class="inlinecode"><span class="id" title="var">a</span>::<span class="id" title="var">s<sub>0</sub></span></span> matches <span class="inlinecode"><span class="id" title="var">re<sub>0</sub></span></span>
    and <span class="inlinecode"><span class="id" title="var">s<sub>1</sub></span></span> matches <span class="inlinecode"><span class="id" title="var">re<sub>1</sub></span></span>.

<div class="paragraph"> </div>

    Even though this is a property of purely the match relation, it is a
    critical observation behind the design of our regex matcher. So (1)
    take time to understand it, (2) prove it, and (3) look for how you'll
    use it later. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="app_ne" class="idref" href="#app_ne"><span class="id" title="lemma">app_ne</span></a> : <span class="id" title="keyword">∀</span> (<a id="a:193" class="idref" href="#a:193"><span class="id" title="binder">a</span></a> : <a class="idref" href="http://coq.inria.fr/library//Coq.Strings.Ascii.html#ascii"><span class="id" title="inductive">ascii</span></a>) <a id="s:194" class="idref" href="#s:194"><span class="id" title="binder">s</span></a> <a id="re<sub>0</sub>:195" class="idref" href="#re<sub>0</sub>:195"><span class="id" title="binder">re<sub>0</sub></span></a> <a id="re<sub>1</sub>:196" class="idref" href="#re<sub>1</sub>:196"><span class="id" title="binder">re<sub>1</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="IndProp.html#a:193"><span class="id" title="variable">a</span></a> <a class="idref" href="Poly.html#:::x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="IndProp.html#s:194"><span class="id" title="variable">s</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">(</span></a><a class="idref" href="IndProp.html#App"><span class="id" title="constructor">App</span></a> <a class="idref" href="IndProp.html#re<sub>0</sub>:195"><span class="id" title="variable">re<sub>0</sub></span></a> <a class="idref" href="IndProp.html#re<sub>1</sub>:196"><span class="id" title="variable">re<sub>1</sub></span></a><a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">↔</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e<sub>25</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Poly.html#2c60282cbb04e070c60ae01e76f3865a"><span class="id" title="notation">[</span></a> <a class="idref" href="Poly.html#2c60282cbb04e070c60ae01e76f3865a"><span class="id" title="notation">]</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#re<sub>0</sub>:195"><span class="id" title="variable">re<sub>0</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="IndProp.html#a:193"><span class="id" title="variable">a</span></a> <a class="idref" href="Poly.html#:::x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="IndProp.html#s:194"><span class="id" title="variable">s</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#re<sub>1</sub>:196"><span class="id" title="variable">re<sub>1</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e<sub>25</sub>"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e<sub>25</sub>"><span class="id" title="notation">∨</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="s<sub>0</sub>:197" class="idref" href="#s<sub>0</sub>:197"><span class="id" title="binder">s<sub>0</sub></span></a> <a id="s<sub>1</sub>:198" class="idref" href="#s<sub>1</sub>:198"><span class="id" title="binder">s<sub>1</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="IndProp.html#s:194"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="IndProp.html#s<sub>0</sub>:197"><span class="id" title="variable">s<sub>0</sub></span></a> <a class="idref" href="Poly.html#f03f7a04ef75ff3ac66ca5c23554e52e"><span class="id" title="notation">++</span></a> <a class="idref" href="IndProp.html#s<sub>1</sub>:198"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="IndProp.html#a:193"><span class="id" title="variable">a</span></a> <a class="idref" href="Poly.html#:::x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="IndProp.html#s<sub>0</sub>:197"><span class="id" title="variable">s<sub>0</sub></span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#re<sub>0</sub>:195"><span class="id" title="variable">re<sub>0</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="IndProp.html#s<sub>1</sub>:198"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#re<sub>1</sub>:196"><span class="id" title="variable">re<sub>1</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

 <span class="inlinecode"><span class="id" title="var">s</span></span> matches <span class="inlinecode"><span class="id" title="var">Union</span></span> <span class="inlinecode"><span class="id" title="var">re<sub>0</sub></span></span> <span class="inlinecode"><span class="id" title="var">re<sub>1</sub></span></span> iff <span class="inlinecode"><span class="id" title="var">s</span></span> matches <span class="inlinecode"><span class="id" title="var">re<sub>0</sub></span></span> or <span class="inlinecode"><span class="id" title="var">s</span></span> matches <span class="inlinecode"><span class="id" title="var">re<sub>1</sub></span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="union_disj" class="idref" href="#union_disj"><span class="id" title="lemma">union_disj</span></a> : <span class="id" title="keyword">∀</span> (<a id="s:199" class="idref" href="#s:199"><span class="id" title="binder">s</span></a> : <a class="idref" href="IndProp.html#string"><span class="id" title="definition">string</span></a>) <a id="re<sub>0</sub>:200" class="idref" href="#re<sub>0</sub>:200"><span class="id" title="binder">re<sub>0</sub></span></a> <a id="re<sub>1</sub>:201" class="idref" href="#re<sub>1</sub>:201"><span class="id" title="binder">re<sub>1</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="IndProp.html#s:199"><span class="id" title="variable">s</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#Union"><span class="id" title="constructor">Union</span></a> <a class="idref" href="IndProp.html#re<sub>0</sub>:200"><span class="id" title="variable">re<sub>0</sub></span></a> <a class="idref" href="IndProp.html#re<sub>1</sub>:201"><span class="id" title="variable">re<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">↔</span></a> <a class="idref" href="IndProp.html#s:199"><span class="id" title="variable">s</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#re<sub>0</sub>:200"><span class="id" title="variable">re<sub>0</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e<sub>25</sub>"><span class="id" title="notation">∨</span></a> <a class="idref" href="IndProp.html#s:199"><span class="id" title="variable">s</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#re<sub>1</sub>:201"><span class="id" title="variable">re<sub>1</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">left</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H<sub>2</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">right</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H<sub>1</sub></span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> [ <span class="id" title="var">H</span> | <span class="id" title="var">H</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="IndProp.html#MUnionL"><span class="id" title="constructor">MUnionL</span></a>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="IndProp.html#MUnionR"><span class="id" title="constructor">MUnionR</span></a>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab285"></a><h4 class="section">Exercise: 3 stars, standard, optional (star_ne)</h4>
 <span class="inlinecode"><span class="id" title="var">a</span>::<span class="id" title="var">s</span></span> matches <span class="inlinecode"><span class="id" title="var">Star</span></span> <span class="inlinecode"><span class="id" title="var">re</span></span> iff <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">s<sub>0</sub></span></span> <span class="inlinecode">++</span> <span class="inlinecode"><span class="id" title="var">s<sub>1</sub></span></span>, where <span class="inlinecode"><span class="id" title="var">a</span>::<span class="id" title="var">s<sub>0</sub></span></span> matches
    <span class="inlinecode"><span class="id" title="var">re</span></span> and <span class="inlinecode"><span class="id" title="var">s<sub>1</sub></span></span> matches <span class="inlinecode"><span class="id" title="var">Star</span></span> <span class="inlinecode"><span class="id" title="var">re</span></span>. Like <span class="inlinecode"><span class="id" title="var">app_ne</span></span>, this observation is
    critical, so understand it, prove it, and keep it in mind.

<div class="paragraph"> </div>

    Hint: you'll need to perform induction. There are quite a few
    reasonable candidates for <span class="inlinecode"><span class="id" title="keyword">Prop</span></span>'s to prove by induction. The only one
    that will work is splitting the <span class="inlinecode"><span class="id" title="var">iff</span></span> into two implications and
    proving one by induction on the evidence for <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode">::</span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode">=~</span> <span class="inlinecode"><span class="id" title="var">Star</span></span> <span class="inlinecode"><span class="id" title="var">re</span></span>. The
    other implication can be proved without induction.

<div class="paragraph"> </div>

    In order to prove the right property by induction, you'll need to
    rephrase <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode">::</span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode">=~</span> <span class="inlinecode"><span class="id" title="var">Star</span></span> <span class="inlinecode"><span class="id" title="var">re</span></span> to be a <span class="inlinecode"><span class="id" title="keyword">Prop</span></span> over general variables,
    using the <span class="inlinecode"><span class="id" title="var">remember</span></span> tactic.  
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="star_ne" class="idref" href="#star_ne"><span class="id" title="lemma">star_ne</span></a> : <span class="id" title="keyword">∀</span> (<a id="a:202" class="idref" href="#a:202"><span class="id" title="binder">a</span></a> : <a class="idref" href="http://coq.inria.fr/library//Coq.Strings.Ascii.html#ascii"><span class="id" title="inductive">ascii</span></a>) <a id="s:203" class="idref" href="#s:203"><span class="id" title="binder">s</span></a> <a id="re:204" class="idref" href="#re:204"><span class="id" title="binder">re</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="IndProp.html#a:202"><span class="id" title="variable">a</span></a> <a class="idref" href="Poly.html#:::x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="IndProp.html#s:203"><span class="id" title="variable">s</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#Star"><span class="id" title="constructor">Star</span></a> <a class="idref" href="IndProp.html#re:204"><span class="id" title="variable">re</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">↔</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="s<sub>0</sub>:205" class="idref" href="#s<sub>0</sub>:205"><span class="id" title="binder">s<sub>0</sub></span></a> <a id="s<sub>1</sub>:206" class="idref" href="#s<sub>1</sub>:206"><span class="id" title="binder">s<sub>1</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="IndProp.html#s:203"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="IndProp.html#s<sub>0</sub>:205"><span class="id" title="variable">s<sub>0</sub></span></a> <a class="idref" href="Poly.html#f03f7a04ef75ff3ac66ca5c23554e52e"><span class="id" title="notation">++</span></a> <a class="idref" href="IndProp.html#s<sub>1</sub>:206"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="IndProp.html#a:202"><span class="id" title="variable">a</span></a> <a class="idref" href="Poly.html#:::x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="IndProp.html#s<sub>0</sub>:205"><span class="id" title="variable">s<sub>0</sub></span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#re:204"><span class="id" title="variable">re</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="IndProp.html#s<sub>1</sub>:206"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#Star"><span class="id" title="constructor">Star</span></a> <a class="idref" href="IndProp.html#re:204"><span class="id" title="variable">re</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

 The definition of our regex matcher will include two fixpoint
    functions. The first function, given regex <span class="inlinecode"><span class="id" title="var">re</span></span>, will evaluate to a
    value that reflects whether <span class="inlinecode"><span class="id" title="var">re</span></span> matches the empty string. The
    function will satisfy the following property: 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a id="refl_matches_eps" class="idref" href="#refl_matches_eps"><span class="id" title="definition">refl_matches_eps</span></a> <a id="m:207" class="idref" href="#m:207"><span class="id" title="binder">m</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="re:208" class="idref" href="#re:208"><span class="id" title="binder">re</span></a> : <a class="idref" href="IndProp.html#reg_exp"><span class="id" title="inductive">reg_exp</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Strings.Ascii.html#ascii"><span class="id" title="inductive">ascii</span></a>, <a class="idref" href="IndProp.html#reflect"><span class="id" title="inductive">reflect</span></a> (<a class="idref" href="Poly.html#2c60282cbb04e070c60ae01e76f3865a"><span class="id" title="notation">[</span></a> <a class="idref" href="Poly.html#2c60282cbb04e070c60ae01e76f3865a"><span class="id" title="notation">]</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#re:208"><span class="id" title="variable">re</span></a>) (<a class="idref" href="IndProp.html#m:207"><span class="id" title="variable">m</span></a> <a class="idref" href="IndProp.html#re:208"><span class="id" title="variable">re</span></a>).<br/>
</div>

<div class="doc">
<a id="lab286"></a><h4 class="section">Exercise: 2 stars, standard, optional (match_eps)</h4>
 Complete the definition of <span class="inlinecode"><span class="id" title="var">match_eps</span></span> so that it tests if a given
    regex matches the empty string: 
</div>
<div class="code">
<span class="id" title="keyword">Fixpoint</span> <a id="match_eps" class="idref" href="#match_eps"><span class="id" title="definition">match_eps</span></a> (<a id="re:209" class="idref" href="#re:209"><span class="id" title="binder">re</span></a>: <a class="idref" href="IndProp.html#reg_exp"><span class="id" title="inductive">reg_exp</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Strings.Ascii.html#ascii"><span class="id" title="inductive">ascii</span></a>) : <a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;REPLACE&nbsp;THIS&nbsp;LINE&nbsp;WITH&nbsp;":=&nbsp;_your_definition_&nbsp;."&nbsp;*)</span>. <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a id="lab287"></a><h4 class="section">Exercise: 3 stars, standard, optional (match_eps_refl)</h4>
 Now, prove that <span class="inlinecode"><span class="id" title="var">match_eps</span></span> indeed tests if a given regex matches
    the empty string.  (Hint: You'll want to use the reflection lemmas
    <span class="inlinecode"><span class="id" title="var">ReflectT</span></span> and <span class="inlinecode"><span class="id" title="var">ReflectF</span></span>.) 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="match_eps_refl" class="idref" href="#match_eps_refl"><span class="id" title="lemma">match_eps_refl</span></a> : <a class="idref" href="IndProp.html#refl_matches_eps"><span class="id" title="definition">refl_matches_eps</span></a> <a class="idref" href="IndProp.html#match_eps"><span class="id" title="axiom">match_eps</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

 We'll define other functions that use <span class="inlinecode"><span class="id" title="var">match_eps</span></span>. However, the
    only property of <span class="inlinecode"><span class="id" title="var">match_eps</span></span> that you'll need to use in all proofs
    over these functions is <span class="inlinecode"><span class="id" title="var">match_eps_refl</span></span>. 
</div>

<div class="doc">
The key operation that will be performed by our regex matcher will
    be to iteratively construct a sequence of regex derivatives. For each
    character <span class="inlinecode"><span class="id" title="var">a</span></span> and regex <span class="inlinecode"><span class="id" title="var">re</span></span>, the derivative of <span class="inlinecode"><span class="id" title="var">re</span></span> on <span class="inlinecode"><span class="id" title="var">a</span></span> is a regex
    that matches all suffixes of strings matched by <span class="inlinecode"><span class="id" title="var">re</span></span> that start with
    <span class="inlinecode"><span class="id" title="var">a</span></span>. I.e., <span class="inlinecode"><span class="id" title="var">re'</span></span> is a derivative of <span class="inlinecode"><span class="id" title="var">re</span></span> on <span class="inlinecode"><span class="id" title="var">a</span></span> if they satisfy the
    following relation: 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="is_der" class="idref" href="#is_der"><span class="id" title="definition">is_der</span></a> <a id="re:211" class="idref" href="#re:211"><span class="id" title="binder">re</span></a> (<a id="a:212" class="idref" href="#a:212"><span class="id" title="binder">a</span></a> : <a class="idref" href="http://coq.inria.fr/library//Coq.Strings.Ascii.html#ascii"><span class="id" title="inductive">ascii</span></a>) <a id="re':213" class="idref" href="#re':213"><span class="id" title="binder">re'</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="s:214" class="idref" href="#s:214"><span class="id" title="binder">s</span></a>, <a class="idref" href="IndProp.html#a:212"><span class="id" title="variable">a</span></a> <a class="idref" href="Poly.html#:::x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="IndProp.html#s:214"><span class="id" title="variable">s</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#re:211"><span class="id" title="variable">re</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">↔</span></a> <a class="idref" href="IndProp.html#s:214"><span class="id" title="variable">s</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#re':213"><span class="id" title="variable">re'</span></a>.<br/>
</div>

<div class="doc">
A function <span class="inlinecode"><span class="id" title="var">d</span></span> derives strings if, given character <span class="inlinecode"><span class="id" title="var">a</span></span> and regex
    <span class="inlinecode"><span class="id" title="var">re</span></span>, it evaluates to the derivative of <span class="inlinecode"><span class="id" title="var">re</span></span> on <span class="inlinecode"><span class="id" title="var">a</span></span>. I.e., <span class="inlinecode"><span class="id" title="var">d</span></span>
    satisfies the following property: 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a id="derives" class="idref" href="#derives"><span class="id" title="definition">derives</span></a> <a id="d:215" class="idref" href="#d:215"><span class="id" title="binder">d</span></a> := <span class="id" title="keyword">∀</span> <a id="a:216" class="idref" href="#a:216"><span class="id" title="binder">a</span></a> <a id="re:217" class="idref" href="#re:217"><span class="id" title="binder">re</span></a>, <a class="idref" href="IndProp.html#is_der"><span class="id" title="definition">is_der</span></a> <a class="idref" href="IndProp.html#re:217"><span class="id" title="variable">re</span></a> <a class="idref" href="IndProp.html#a:216"><span class="id" title="variable">a</span></a> (<a class="idref" href="IndProp.html#d:215"><span class="id" title="variable">d</span></a> <a class="idref" href="IndProp.html#a:216"><span class="id" title="variable">a</span></a> <a class="idref" href="IndProp.html#re:217"><span class="id" title="variable">re</span></a>).<br/>
</div>

<div class="doc">
<a id="lab288"></a><h4 class="section">Exercise: 3 stars, standard, optional (derive)</h4>
 Define <span class="inlinecode"><span class="id" title="var">derive</span></span> so that it derives strings. One natural
    implementation uses <span class="inlinecode"><span class="id" title="var">match_eps</span></span> in some cases to determine if key
    regex's match the empty string. 
</div>
<div class="code">
<span class="id" title="keyword">Fixpoint</span> <a id="derive" class="idref" href="#derive"><span class="id" title="definition">derive</span></a> (<a id="a:218" class="idref" href="#a:218"><span class="id" title="binder">a</span></a> : <a class="idref" href="http://coq.inria.fr/library//Coq.Strings.Ascii.html#ascii"><span class="id" title="inductive">ascii</span></a>) (<a id="re:219" class="idref" href="#re:219"><span class="id" title="binder">re</span></a> : <a class="idref" href="IndProp.html#reg_exp"><span class="id" title="inductive">reg_exp</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Strings.Ascii.html#ascii"><span class="id" title="inductive">ascii</span></a>) : <a class="idref" href="IndProp.html#reg_exp"><span class="id" title="inductive">reg_exp</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Strings.Ascii.html#ascii"><span class="id" title="inductive">ascii</span></a><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;REPLACE&nbsp;THIS&nbsp;LINE&nbsp;WITH&nbsp;":=&nbsp;_your_definition_&nbsp;."&nbsp;*)</span>. <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

 The <span class="inlinecode"><span class="id" title="var">derive</span></span> function should pass the following tests. Each test
    establishes an equality between an expression that will be
    evaluated by our regex matcher and the final value that must be
    returned by the regex matcher. Each test is annotated with the
    match fact that it reflects. 
</div>
<div class="code">
<span class="id" title="keyword">Example</span> <a id="c" class="idref" href="#c"><span class="id" title="definition">c</span></a> := <a class="idref" href="http://coq.inria.fr/library//Coq.Strings.Ascii.html#ascii_of_nat"><span class="id" title="definition">ascii_of_nat</span></a> 99.<br/>
<span class="id" title="keyword">Example</span> <a id="d" class="idref" href="#d"><span class="id" title="definition">d</span></a> := <a class="idref" href="http://coq.inria.fr/library//Coq.Strings.Ascii.html#ascii_of_nat"><span class="id" title="definition">ascii_of_nat</span></a> 100.<br/>
</div>

<div class="doc">
"c" =~ EmptySet: 
</div>
<div class="code">
<span class="id" title="keyword">Example</span> <a id="test_der0" class="idref" href="#test_der0"><span class="id" title="definition">test_der0</span></a> : <a class="idref" href="IndProp.html#match_eps"><span class="id" title="axiom">match_eps</span></a> (<a class="idref" href="IndProp.html#derive"><span class="id" title="axiom">derive</span></a> <a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a> (<a class="idref" href="IndProp.html#EmptySet"><span class="id" title="constructor">EmptySet</span></a>)) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
"c" =~ Char c: 
</div>
<div class="code">
<span class="id" title="keyword">Example</span> <a id="test_der1" class="idref" href="#test_der1"><span class="id" title="definition">test_der1</span></a> : <a class="idref" href="IndProp.html#match_eps"><span class="id" title="axiom">match_eps</span></a> (<a class="idref" href="IndProp.html#derive"><span class="id" title="axiom">derive</span></a> <a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a> (<a class="idref" href="IndProp.html#Char"><span class="id" title="constructor">Char</span></a> <a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a>)) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
"c" =~ Char d: 
</div>
<div class="code">
<span class="id" title="keyword">Example</span> <a id="test_der2" class="idref" href="#test_der2"><span class="id" title="definition">test_der2</span></a> : <a class="idref" href="IndProp.html#match_eps"><span class="id" title="axiom">match_eps</span></a> (<a class="idref" href="IndProp.html#derive"><span class="id" title="axiom">derive</span></a> <a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a> (<a class="idref" href="IndProp.html#Char"><span class="id" title="constructor">Char</span></a> <a class="idref" href="IndProp.html#d"><span class="id" title="definition">d</span></a>)) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
"c" =~ App (Char c) EmptyStr: 
</div>
<div class="code">
<span class="id" title="keyword">Example</span> <a id="test_der3" class="idref" href="#test_der3"><span class="id" title="definition">test_der3</span></a> : <a class="idref" href="IndProp.html#match_eps"><span class="id" title="axiom">match_eps</span></a> (<a class="idref" href="IndProp.html#derive"><span class="id" title="axiom">derive</span></a> <a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a> (<a class="idref" href="IndProp.html#App"><span class="id" title="constructor">App</span></a> (<a class="idref" href="IndProp.html#Char"><span class="id" title="constructor">Char</span></a> <a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a>) <a class="idref" href="IndProp.html#EmptyStr"><span class="id" title="constructor">EmptyStr</span></a>)) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
"c" =~ App EmptyStr (Char c): 
</div>
<div class="code">
<span class="id" title="keyword">Example</span> <a id="test_der4" class="idref" href="#test_der4"><span class="id" title="definition">test_der4</span></a> : <a class="idref" href="IndProp.html#match_eps"><span class="id" title="axiom">match_eps</span></a> (<a class="idref" href="IndProp.html#derive"><span class="id" title="axiom">derive</span></a> <a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a> (<a class="idref" href="IndProp.html#App"><span class="id" title="constructor">App</span></a> <a class="idref" href="IndProp.html#EmptyStr"><span class="id" title="constructor">EmptyStr</span></a> (<a class="idref" href="IndProp.html#Char"><span class="id" title="constructor">Char</span></a> <a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a>))) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
"c" =~ Star c: 
</div>
<div class="code">
<span class="id" title="keyword">Example</span> <a id="test_der5" class="idref" href="#test_der5"><span class="id" title="definition">test_der5</span></a> : <a class="idref" href="IndProp.html#match_eps"><span class="id" title="axiom">match_eps</span></a> (<a class="idref" href="IndProp.html#derive"><span class="id" title="axiom">derive</span></a> <a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a> (<a class="idref" href="IndProp.html#Star"><span class="id" title="constructor">Star</span></a> (<a class="idref" href="IndProp.html#Char"><span class="id" title="constructor">Char</span></a> <a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a>))) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
"cd" =~ App (Char c) (Char d): 
</div>
<div class="code">
<span class="id" title="keyword">Example</span> <a id="test_der6" class="idref" href="#test_der6"><span class="id" title="definition">test_der6</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="IndProp.html#match_eps"><span class="id" title="axiom">match_eps</span></a> (<a class="idref" href="IndProp.html#derive"><span class="id" title="axiom">derive</span></a> <a class="idref" href="IndProp.html#d"><span class="id" title="definition">d</span></a> (<a class="idref" href="IndProp.html#derive"><span class="id" title="axiom">derive</span></a> <a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a> (<a class="idref" href="IndProp.html#App"><span class="id" title="constructor">App</span></a> (<a class="idref" href="IndProp.html#Char"><span class="id" title="constructor">Char</span></a> <a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a>) (<a class="idref" href="IndProp.html#Char"><span class="id" title="constructor">Char</span></a> <a class="idref" href="IndProp.html#d"><span class="id" title="definition">d</span></a>)))) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
"cd" =~ App (Char d) (Char c): 
</div>
<div class="code">
<span class="id" title="keyword">Example</span> <a id="test_der7" class="idref" href="#test_der7"><span class="id" title="definition">test_der7</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="IndProp.html#match_eps"><span class="id" title="axiom">match_eps</span></a> (<a class="idref" href="IndProp.html#derive"><span class="id" title="axiom">derive</span></a> <a class="idref" href="IndProp.html#d"><span class="id" title="definition">d</span></a> (<a class="idref" href="IndProp.html#derive"><span class="id" title="axiom">derive</span></a> <a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a> (<a class="idref" href="IndProp.html#App"><span class="id" title="constructor">App</span></a> (<a class="idref" href="IndProp.html#Char"><span class="id" title="constructor">Char</span></a> <a class="idref" href="IndProp.html#d"><span class="id" title="definition">d</span></a>) (<a class="idref" href="IndProp.html#Char"><span class="id" title="constructor">Char</span></a> <a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a>)))) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<a id="lab289"></a><h4 class="section">Exercise: 4 stars, standard, optional (derive_corr)</h4>
 Prove that <span class="inlinecode"><span class="id" title="var">derive</span></span> in fact always derives strings.

<div class="paragraph"> </div>

    Hint: one proof performs induction on <span class="inlinecode"><span class="id" title="var">re</span></span>, although you'll need
    to carefully choose the property that you prove by induction by
    generalizing the appropriate terms.

<div class="paragraph"> </div>

    Hint: if your definition of <span class="inlinecode"><span class="id" title="var">derive</span></span> applies <span class="inlinecode"><span class="id" title="var">match_eps</span></span> to a
    particular regex <span class="inlinecode"><span class="id" title="var">re</span></span>, then a natural proof will apply
    <span class="inlinecode"><span class="id" title="var">match_eps_refl</span></span> to <span class="inlinecode"><span class="id" title="var">re</span></span> and destruct the result to generate cases
    with assumptions that the <span class="inlinecode"><span class="id" title="var">re</span></span> does or does not match the empty
    string.

<div class="paragraph"> </div>

    Hint: You can save quite a bit of work by using lemmas proved
    above. In particular, to prove many cases of the induction, you
    can rewrite a <span class="inlinecode"><span class="id" title="keyword">Prop</span></span> over a complicated regex (e.g., <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode">=~</span> <span class="inlinecode"><span class="id" title="var">Union</span></span>
    <span class="inlinecode"><span class="id" title="var">re<sub>0</sub></span></span> <span class="inlinecode"><span class="id" title="var">re<sub>1</sub></span></span>) to a Boolean combination of <span class="inlinecode"><span class="id" title="keyword">Prop</span></span>'s over simple
    regex's (e.g., <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode">=~</span> <span class="inlinecode"><span class="id" title="var">re<sub>0</sub></span></span> <span class="inlinecode">∨</span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode">=~</span> <span class="inlinecode"><span class="id" title="var">re<sub>1</sub></span></span>) using lemmas given above
    that are logical equivalences. You can then reason about these
    <span class="inlinecode"><span class="id" title="keyword">Prop</span></span>'s naturally using <span class="inlinecode"><span class="id" title="tactic">intro</span></span> and <span class="inlinecode"><span class="id" title="tactic">destruct</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="derive_corr" class="idref" href="#derive_corr"><span class="id" title="lemma">derive_corr</span></a> : <a class="idref" href="IndProp.html#derives"><span class="id" title="definition">derives</span></a> <a class="idref" href="IndProp.html#derive"><span class="id" title="axiom">derive</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

 We'll define the regex matcher using <span class="inlinecode"><span class="id" title="var">derive</span></span>. However, the only
    property of <span class="inlinecode"><span class="id" title="var">derive</span></span> that you'll need to use in all proofs of
    properties of the matcher is <span class="inlinecode"><span class="id" title="var">derive_corr</span></span>. 
</div>

<div class="doc">
A function <span class="inlinecode"><span class="id" title="var">m</span></span> <i>matches regexes</i> if, given string <span class="inlinecode"><span class="id" title="var">s</span></span> and regex <span class="inlinecode"><span class="id" title="var">re</span></span>,
    it evaluates to a value that reflects whether <span class="inlinecode"><span class="id" title="var">s</span></span> is matched by
    <span class="inlinecode"><span class="id" title="var">re</span></span>. I.e., <span class="inlinecode"><span class="id" title="var">m</span></span> holds the following property: 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a id="matches_regex" class="idref" href="#matches_regex"><span class="id" title="definition">matches_regex</span></a> <a id="m:221" class="idref" href="#m:221"><span class="id" title="binder">m</span></a> : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="s:222" class="idref" href="#s:222"><span class="id" title="binder">s</span></a> : <a class="idref" href="IndProp.html#string"><span class="id" title="definition">string</span></a>) <a id="re:223" class="idref" href="#re:223"><span class="id" title="binder">re</span></a>, <a class="idref" href="IndProp.html#reflect"><span class="id" title="inductive">reflect</span></a> (<a class="idref" href="IndProp.html#s:222"><span class="id" title="variable">s</span></a> <a class="idref" href="IndProp.html#70ea788eca33f3ac1bb7ed2e8169c791"><span class="id" title="notation">=~</span></a> <a class="idref" href="IndProp.html#re:223"><span class="id" title="variable">re</span></a>) (<a class="idref" href="IndProp.html#m:221"><span class="id" title="variable">m</span></a> <a class="idref" href="IndProp.html#s:222"><span class="id" title="variable">s</span></a> <a class="idref" href="IndProp.html#re:223"><span class="id" title="variable">re</span></a>).<br/>
</div>

<div class="doc">
<a id="lab290"></a><h4 class="section">Exercise: 2 stars, standard, optional (regex_match)</h4>
 Complete the definition of <span class="inlinecode"><span class="id" title="var">regex_match</span></span> so that it matches
    regexes. 
</div>
<div class="code">
<span class="id" title="keyword">Fixpoint</span> <a id="regex_match" class="idref" href="#regex_match"><span class="id" title="definition">regex_match</span></a> (<a id="s:224" class="idref" href="#s:224"><span class="id" title="binder">s</span></a> : <a class="idref" href="IndProp.html#string"><span class="id" title="definition">string</span></a>) (<a id="re:225" class="idref" href="#re:225"><span class="id" title="binder">re</span></a> : <a class="idref" href="IndProp.html#reg_exp"><span class="id" title="inductive">reg_exp</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Strings.Ascii.html#ascii"><span class="id" title="inductive">ascii</span></a>) : <a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;REPLACE&nbsp;THIS&nbsp;LINE&nbsp;WITH&nbsp;":=&nbsp;_your_definition_&nbsp;."&nbsp;*)</span>. <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a id="lab291"></a><h4 class="section">Exercise: 3 stars, standard, optional (regex_match_correct)</h4>
 Finally, prove that <span class="inlinecode"><span class="id" title="var">regex_match</span></span> in fact matches regexes.

<div class="paragraph"> </div>

    Hint: if your definition of <span class="inlinecode"><span class="id" title="var">regex_match</span></span> applies <span class="inlinecode"><span class="id" title="var">match_eps</span></span> to
    regex <span class="inlinecode"><span class="id" title="var">re</span></span>, then a natural proof applies <span class="inlinecode"><span class="id" title="var">match_eps_refl</span></span> to <span class="inlinecode"><span class="id" title="var">re</span></span>
    and destructs the result to generate cases in which you may assume
    that <span class="inlinecode"><span class="id" title="var">re</span></span> does or does not match the empty string.

<div class="paragraph"> </div>

    Hint: if your definition of <span class="inlinecode"><span class="id" title="var">regex_match</span></span> applies <span class="inlinecode"><span class="id" title="var">derive</span></span> to
    character <span class="inlinecode"><span class="id" title="var">x</span></span> and regex <span class="inlinecode"><span class="id" title="var">re</span></span>, then a natural proof applies
    <span class="inlinecode"><span class="id" title="var">derive_corr</span></span> to <span class="inlinecode"><span class="id" title="var">x</span></span> and <span class="inlinecode"><span class="id" title="var">re</span></span> to prove that <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode">::</span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode">=~</span> <span class="inlinecode"><span class="id" title="var">re</span></span> given
    <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode">=~</span> <span class="inlinecode"><span class="id" title="var">derive</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">re</span></span>, and vice versa. 
</div>
<div class="code">
<span class="id" title="keyword">Theorem</span> <a id="regex_match_correct" class="idref" href="#regex_match_correct"><span class="id" title="lemma">regex_match_correct</span></a> : <a class="idref" href="IndProp.html#matches_regex"><span class="id" title="definition">matches_regex</span></a> <a class="idref" href="IndProp.html#regex_match"><span class="id" title="axiom">regex_match</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="code">

<span class="comment">(*&nbsp;2023-10-12&nbsp;09:23&nbsp;*)</span><br/>
</div>
</div>

<div id="footer">
<hr/><a href="coqindex.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>